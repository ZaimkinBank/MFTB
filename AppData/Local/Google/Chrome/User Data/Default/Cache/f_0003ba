!function(){return function e(t,r,i){function s(a,n){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!n&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return s(t[a][1][e]||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)s(i[a]);return s}}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OMVP_VERSION=void 0;r.OMVP_VERSION=1707},{}],2:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],3:[function(e,t,r){var i=e("./_wks")("unscopables"),s=Array.prototype;void 0==s[i]&&e("./_hide")(s,i,{}),t.exports=function(e){s[i][e]=!0}},{"./_hide":30,"./_wks":89}],4:[function(e,t,r){t.exports=function(e,t,r,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(r+": incorrect invocation!");return e}},{}],5:[function(e,t,r){var i=e("./_is-object");t.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":38}],6:[function(e,t,r){var i=e("./_to-iobject"),s=e("./_to-length"),o=e("./_to-absolute-index");t.exports=function(e){return function(t,r,a){var n,l=i(t),d=s(l.length),u=o(a,d);if(e&&r!=r){for(;d>u;)if((n=l[u++])!=n)return!0}else for(;d>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}}},{"./_to-absolute-index":78,"./_to-iobject":80,"./_to-length":81}],7:[function(e,t,r){var i=e("./_ctx"),s=e("./_iobject"),o=e("./_to-object"),a=e("./_to-length"),n=e("./_array-species-create");t.exports=function(e,t){var r=1==e,l=2==e,d=3==e,u=4==e,c=6==e,h=5==e||c,p=t||n;return function(t,n,_){for(var g,f,m=o(t),A=s(m),v=i(n,_,3),y=a(A.length),b=0,P=r?p(t,y):l?p(t,0):void 0;y>b;b++)if((h||b in A)&&(f=v(g=A[b],b,m),e))if(r)P[b]=f;else if(f)switch(e){case 3:return!0;case 5:return g;case 6:return b;case 2:P.push(g)}else if(u)return!1;return c?-1:d||u?u:P}}},{"./_array-species-create":9,"./_ctx":16,"./_iobject":35,"./_to-length":81,"./_to-object":82}],8:[function(e,t,r){var i=e("./_is-object"),s=e("./_is-array"),o=e("./_wks")("species");t.exports=function(e){var t;return s(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!s(t.prototype)||(t=void 0),i(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},{"./_is-array":37,"./_is-object":38,"./_wks":89}],9:[function(e,t,r){var i=e("./_array-species-constructor");t.exports=function(e,t){return new(i(e))(t)}},{"./_array-species-constructor":8}],10:[function(e,t,r){var i=e("./_cof"),s=e("./_wks")("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),s))?r:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},{"./_cof":11,"./_wks":89}],11:[function(e,t,r){var i={}.toString;t.exports=function(e){return i.call(e).slice(8,-1)}},{}],12:[function(e,t,r){"use strict";var i=e("./_redefine-all"),s=e("./_meta").getWeak,o=e("./_an-object"),a=e("./_is-object"),n=e("./_an-instance"),l=e("./_for-of"),d=e("./_array-methods"),u=e("./_has"),c=e("./_validate-collection"),h=d(5),p=d(6),_=0,g=function(e){return e._l||(e._l=new f)},f=function(){this.a=[]},m=function(e,t){return h(e.a,function(e){return e[0]===t})};f.prototype={get:function(e){var t=m(this,e);if(t)return t[1]},has:function(e){return!!m(this,e)},set:function(e,t){var r=m(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,r,o){var d=e(function(e,i){n(e,d,t,"_i"),e._t=t,e._i=_++,e._l=void 0,void 0!=i&&l(i,r,e[o],e)});return i(d.prototype,{delete:function(e){if(!a(e))return!1;var r=s(e);return!0===r?g(c(this,t)).delete(e):r&&u(r,this._i)&&delete r[this._i]},has:function(e){if(!a(e))return!1;var r=s(e);return!0===r?g(c(this,t)).has(e):r&&u(r,this._i)}}),d},def:function(e,t,r){var i=s(o(t),!0);return!0===i?g(e).set(t,r):i[e._i]=r,e},ufstore:g}},{"./_an-instance":4,"./_an-object":5,"./_array-methods":7,"./_for-of":27,"./_has":29,"./_is-object":38,"./_meta":47,"./_redefine-all":67,"./_validate-collection":86}],13:[function(e,t,r){"use strict";var i=e("./_global"),s=e("./_export"),o=e("./_redefine"),a=e("./_redefine-all"),n=e("./_meta"),l=e("./_for-of"),d=e("./_an-instance"),u=e("./_is-object"),c=e("./_fails"),h=e("./_iter-detect"),p=e("./_set-to-string-tag"),_=e("./_inherit-if-required");t.exports=function(e,t,r,g,f,m){var A=i[e],v=A,y=f?"set":"add",b=v&&v.prototype,P={},T=function(e){var t=b[e];o(b,e,"delete"==e?function(e){return!(m&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof v&&(m||b.forEach&&!c(function(){(new v).entries().next()}))){var w=new v,S=w[y](m?{}:-0,1)!=w,E=c(function(){w.has(1)}),O=h(function(e){new v(e)}),j=!m&&c(function(){for(var e=new v,t=5;t--;)e[y](t,t);return!e.has(-0)});O||((v=t(function(t,r){d(t,v,e);var i=_(new A,t,v);return void 0!=r&&l(r,f,i[y],i),i})).prototype=b,b.constructor=v),(E||j)&&(T("delete"),T("has"),f&&T("get")),(j||S)&&T(y),m&&b.clear&&delete b.clear}else v=g.getConstructor(t,e,f,y),a(v.prototype,r),n.NEED=!0;return p(v,e),P[e]=v,s(s.G+s.W+s.F*(v!=A),P),m||g.setStrong(v,e,f),v}},{"./_an-instance":4,"./_export":22,"./_fails":24,"./_for-of":27,"./_global":28,"./_inherit-if-required":33,"./_is-object":38,"./_iter-detect":43,"./_meta":47,"./_redefine":68,"./_redefine-all":67,"./_set-to-string-tag":71}],14:[function(e,t,r){var i=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=i)},{}],15:[function(e,t,r){"use strict";var i=e("./_object-dp"),s=e("./_property-desc");t.exports=function(e,t,r){t in e?i.f(e,t,s(0,r)):e[t]=r}},{"./_object-dp":52,"./_property-desc":66}],16:[function(e,t,r){var i=e("./_a-function");t.exports=function(e,t,r){if(i(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,s){return e.call(t,r,i,s)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":2}],17:[function(e,t,r){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],18:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":24}],19:[function(e,t,r){var i=e("./_is-object"),s=e("./_global").document,o=i(s)&&i(s.createElement);t.exports=function(e){return o?s.createElement(e):{}}},{"./_global":28,"./_is-object":38}],20:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],21:[function(e,t,r){var i=e("./_object-keys"),s=e("./_object-gops"),o=e("./_object-pie");t.exports=function(e){var t=i(e),r=s.f;if(r)for(var a,n=r(e),l=o.f,d=0;n.length>d;)l.call(e,a=n[d++])&&t.push(a);return t}},{"./_object-gops":57,"./_object-keys":60,"./_object-pie":61}],22:[function(e,t,r){var i=e("./_global"),s=e("./_core"),o=e("./_hide"),a=e("./_redefine"),n=e("./_ctx"),l=function(e,t,r){var d,u,c,h,p=e&l.F,_=e&l.G,g=e&l.S,f=e&l.P,m=e&l.B,A=_?i:g?i[t]||(i[t]={}):(i[t]||{}).prototype,v=_?s:s[t]||(s[t]={}),y=v.prototype||(v.prototype={});for(d in _&&(r=t),r)c=((u=!p&&A&&void 0!==A[d])?A:r)[d],h=m&&u?n(c,i):f&&"function"==typeof c?n(Function.call,c):c,A&&a(A,d,c,e&l.U),v[d]!=c&&o(v,d,h),f&&y[d]!=c&&(y[d]=c)};i.core=s,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{"./_core":14,"./_ctx":16,"./_global":28,"./_hide":30,"./_redefine":68}],23:[function(e,t,r){var i=e("./_wks")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},{"./_wks":89}],24:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],25:[function(e,t,r){"use strict";var i=e("./_hide"),s=e("./_redefine"),o=e("./_fails"),a=e("./_defined"),n=e("./_wks");t.exports=function(e,t,r){var l=n(e),d=r(a,l,""[e]),u=d[0],c=d[1];o(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(s(String.prototype,e,u),i(RegExp.prototype,l,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)}))}},{"./_defined":17,"./_fails":24,"./_hide":30,"./_redefine":68,"./_wks":89}],26:[function(e,t,r){"use strict";var i=e("./_an-object");t.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{"./_an-object":5}],27:[function(e,t,r){var i=e("./_ctx"),s=e("./_iter-call"),o=e("./_is-array-iter"),a=e("./_an-object"),n=e("./_to-length"),l=e("./core.get-iterator-method"),d={},u={};(r=t.exports=function(e,t,r,c,h){var p,_,g,f,m=h?function(){return e}:l(e),A=i(r,c,t?2:1),v=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(p=n(e.length);p>v;v++)if((f=t?A(a(_=e[v])[0],_[1]):A(e[v]))===d||f===u)return f}else for(g=m.call(e);!(_=g.next()).done;)if((f=s(g,A,_.value,t))===d||f===u)return f}).BREAK=d,r.RETURN=u},{"./_an-object":5,"./_ctx":16,"./_is-array-iter":36,"./_iter-call":40,"./_to-length":81,"./core.get-iterator-method":90}],28:[function(e,t,r){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},{}],29:[function(e,t,r){var i={}.hasOwnProperty;t.exports=function(e,t){return i.call(e,t)}},{}],30:[function(e,t,r){var i=e("./_object-dp"),s=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":18,"./_object-dp":52,"./_property-desc":66}],31:[function(e,t,r){var i=e("./_global").document;t.exports=i&&i.documentElement},{"./_global":28}],32:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":18,"./_dom-create":19,"./_fails":24}],33:[function(e,t,r){var i=e("./_is-object"),s=e("./_set-proto").set;t.exports=function(e,t,r){var o,a=t.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&i(o)&&s&&s(e,o),e}},{"./_is-object":38,"./_set-proto":69}],34:[function(e,t,r){t.exports=function(e,t,r){var i=void 0===r;switch(t.length){case 0:return i?e():e.call(r);case 1:return i?e(t[0]):e.call(r,t[0]);case 2:return i?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],35:[function(e,t,r){var i=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},{"./_cof":11}],36:[function(e,t,r){var i=e("./_iterators"),s=e("./_wks")("iterator"),o=Array.prototype;t.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},{"./_iterators":45,"./_wks":89}],37:[function(e,t,r){var i=e("./_cof");t.exports=Array.isArray||function(e){return"Array"==i(e)}},{"./_cof":11}],38:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],39:[function(e,t,r){var i=e("./_is-object"),s=e("./_cof"),o=e("./_wks")("match");t.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==s(e))}},{"./_cof":11,"./_is-object":38,"./_wks":89}],40:[function(e,t,r){var i=e("./_an-object");t.exports=function(e,t,r,s){try{return s?t(i(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},{"./_an-object":5}],41:[function(e,t,r){"use strict";var i=e("./_object-create"),s=e("./_property-desc"),o=e("./_set-to-string-tag"),a={};e("./_hide")(a,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=i(a,{next:s(1,r)}),o(e,t+" Iterator")}},{"./_hide":30,"./_object-create":51,"./_property-desc":66,"./_set-to-string-tag":71,"./_wks":89}],42:[function(e,t,r){"use strict";var i=e("./_library"),s=e("./_export"),o=e("./_redefine"),a=e("./_hide"),n=e("./_iterators"),l=e("./_iter-create"),d=e("./_set-to-string-tag"),u=e("./_object-gpo"),c=e("./_wks")("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(e,t,r,_,g,f,m){l(r,t,_);var A,v,y,b=function(e){if(!h&&e in S)return S[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},P=t+" Iterator",T="values"==g,w=!1,S=e.prototype,E=S[c]||S["@@iterator"]||g&&S[g],O=E||b(g),j=g?T?b("entries"):O:void 0,I="Array"==t&&S.entries||E;if(I&&(y=u(I.call(new e)))!==Object.prototype&&y.next&&(d(y,P,!0),i||"function"==typeof y[c]||a(y,c,p)),T&&E&&"values"!==E.name&&(w=!0,O=function(){return E.call(this)}),i&&!m||!h&&!w&&S[c]||a(S,c,O),n[t]=O,n[P]=p,g)if(A={values:T?O:b("values"),keys:f?O:b("keys"),entries:j},m)for(v in A)v in S||o(S,v,A[v]);else s(s.P+s.F*(h||w),t,A);return A}},{"./_export":22,"./_hide":30,"./_iter-create":41,"./_iterators":45,"./_library":46,"./_object-gpo":58,"./_redefine":68,"./_set-to-string-tag":71,"./_wks":89}],43:[function(e,t,r){var i=e("./_wks")("iterator"),s=!1;try{var o=[7][i]();o.return=function(){s=!0},Array.from(o,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!s)return!1;var r=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:r=!0}},o[i]=function(){return a},e(o)}catch(e){}return r}},{"./_wks":89}],44:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],45:[function(e,t,r){t.exports={}},{}],46:[function(e,t,r){t.exports=!1},{}],47:[function(e,t,r){var i=e("./_uid")("meta"),s=e("./_is-object"),o=e("./_has"),a=e("./_object-dp").f,n=0,l=Object.isExtensible||function(){return!0},d=!e("./_fails")(function(){return l(Object.preventExtensions({}))}),u=function(e){a(e,i,{value:{i:"O"+ ++n,w:{}}})},c=t.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,i)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[i].i},getWeak:function(e,t){if(!o(e,i)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[i].w},onFreeze:function(e){return d&&c.NEED&&l(e)&&!o(e,i)&&u(e),e}}},{"./_fails":24,"./_has":29,"./_is-object":38,"./_object-dp":52,"./_uid":84}],48:[function(e,t,r){var i=e("./_global"),s=e("./_task").set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,n=i.Promise,l="process"==e("./_cof")(a);t.exports=function(){var e,t,r,d=function(){var i,s;for(l&&(i=a.domain)&&i.exit();e;){s=e.fn,e=e.next;try{s()}catch(i){throw e?r():t=void 0,i}}t=void 0,i&&i.enter()};if(l)r=function(){a.nextTick(d)};else if(!o||i.navigator&&i.navigator.standalone)if(n&&n.resolve){var u=n.resolve(void 0);r=function(){u.then(d)}}else r=function(){s.call(i,d)};else{var c=!0,h=document.createTextNode("");new o(d).observe(h,{characterData:!0}),r=function(){h.data=c=!c}}return function(i){var s={fn:i,next:void 0};t&&(t.next=s),e||(e=s,r()),t=s}}},{"./_cof":11,"./_global":28,"./_task":77}],49:[function(e,t,r){"use strict";var i=e("./_a-function");t.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i}),this.resolve=i(t),this.reject=i(r)}(e)}},{"./_a-function":2}],50:[function(e,t,r){"use strict";var i=e("./_object-keys"),s=e("./_object-gops"),o=e("./_object-pie"),a=e("./_to-object"),n=e("./_iobject"),l=Object.assign;t.exports=!l||e("./_fails")(function(){var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach(function(e){t[e]=e}),7!=l({},e)[r]||Object.keys(l({},t)).join("")!=i})?function(e,t){for(var r=a(e),l=arguments.length,d=1,u=s.f,c=o.f;l>d;)for(var h,p=n(arguments[d++]),_=u?i(p).concat(u(p)):i(p),g=_.length,f=0;g>f;)c.call(p,h=_[f++])&&(r[h]=p[h]);return r}:l},{"./_fails":24,"./_iobject":35,"./_object-gops":57,"./_object-keys":60,"./_object-pie":61,"./_to-object":82}],51:[function(e,t,r){var i=e("./_an-object"),s=e("./_object-dps"),o=e("./_enum-bug-keys"),a=e("./_shared-key")("IE_PROTO"),n=function(){},l=function(){var t,r=e("./_dom-create")("iframe"),i=o.length;for(r.style.display="none",e("./_html").appendChild(r),r.src="javascript:",(t=r.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(e,t){var r;return null!==e?(n.prototype=i(e),r=new n,n.prototype=null,r[a]=e):r=l(),void 0===t?r:s(r,t)}},{"./_an-object":5,"./_dom-create":19,"./_enum-bug-keys":20,"./_html":31,"./_object-dps":53,"./_shared-key":72}],52:[function(e,t,r){var i=e("./_an-object"),s=e("./_ie8-dom-define"),o=e("./_to-primitive"),a=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(i(e),t=o(t,!0),i(r),s)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":5,"./_descriptors":18,"./_ie8-dom-define":32,"./_to-primitive":83}],53:[function(e,t,r){var i=e("./_object-dp"),s=e("./_an-object"),o=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){s(e);for(var r,a=o(t),n=a.length,l=0;n>l;)i.f(e,r=a[l++],t[r]);return e}},{"./_an-object":5,"./_descriptors":18,"./_object-dp":52,"./_object-keys":60}],54:[function(e,t,r){var i=e("./_object-pie"),s=e("./_property-desc"),o=e("./_to-iobject"),a=e("./_to-primitive"),n=e("./_has"),l=e("./_ie8-dom-define"),d=Object.getOwnPropertyDescriptor;r.f=e("./_descriptors")?d:function(e,t){if(e=o(e),t=a(t,!0),l)try{return d(e,t)}catch(e){}if(n(e,t))return s(!i.f.call(e,t),e[t])}},{"./_descriptors":18,"./_has":29,"./_ie8-dom-define":32,"./_object-pie":61,"./_property-desc":66,"./_to-iobject":80,"./_to-primitive":83}],55:[function(e,t,r){var i=e("./_to-iobject"),s=e("./_object-gopn").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return s(e)}catch(e){return a.slice()}}(e):s(i(e))}},{"./_object-gopn":56,"./_to-iobject":80}],56:[function(e,t,r){var i=e("./_object-keys-internal"),s=e("./_enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},{"./_enum-bug-keys":20,"./_object-keys-internal":59}],57:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],58:[function(e,t,r){var i=e("./_has"),s=e("./_to-object"),o=e("./_shared-key")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=s(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},{"./_has":29,"./_shared-key":72,"./_to-object":82}],59:[function(e,t,r){var i=e("./_has"),s=e("./_to-iobject"),o=e("./_array-includes")(!1),a=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var r,n=s(e),l=0,d=[];for(r in n)r!=a&&i(n,r)&&d.push(r);for(;t.length>l;)i(n,r=t[l++])&&(~o(d,r)||d.push(r));return d}},{"./_array-includes":6,"./_has":29,"./_shared-key":72,"./_to-iobject":80}],60:[function(e,t,r){var i=e("./_object-keys-internal"),s=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return i(e,s)}},{"./_enum-bug-keys":20,"./_object-keys-internal":59}],61:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],62:[function(e,t,r){var i=e("./_export"),s=e("./_core"),o=e("./_fails");t.exports=function(e,t){var r=(s.Object||{})[e]||Object[e],a={};a[e]=t(r),i(i.S+i.F*o(function(){r(1)}),"Object",a)}},{"./_core":14,"./_export":22,"./_fails":24}],63:[function(e,t,r){var i=e("./_object-keys"),s=e("./_to-iobject"),o=e("./_object-pie").f;t.exports=function(e){return function(t){for(var r,a=s(t),n=i(a),l=n.length,d=0,u=[];l>d;)o.call(a,r=n[d++])&&u.push(e?[r,a[r]]:a[r]);return u}}},{"./_object-keys":60,"./_object-pie":61,"./_to-iobject":80}],64:[function(e,t,r){t.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},{}],65:[function(e,t,r){var i=e("./_an-object"),s=e("./_is-object"),o=e("./_new-promise-capability");t.exports=function(e,t){if(i(e),s(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},{"./_an-object":5,"./_is-object":38,"./_new-promise-capability":49}],66:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],67:[function(e,t,r){var i=e("./_redefine");t.exports=function(e,t,r){for(var s in t)i(e,s,t[s],r);return e}},{"./_redefine":68}],68:[function(e,t,r){var i=e("./_global"),s=e("./_hide"),o=e("./_has"),a=e("./_uid")("src"),n=Function.toString,l=(""+n).split("toString");e("./_core").inspectSource=function(e){return n.call(e)},(t.exports=function(e,t,r,n){var d="function"==typeof r;d&&(o(r,"name")||s(r,"name",t)),e[t]!==r&&(d&&(o(r,a)||s(r,a,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=r:n?e[t]?e[t]=r:s(e,t,r):(delete e[t],s(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||n.call(this)})},{"./_core":14,"./_global":28,"./_has":29,"./_hide":30,"./_uid":84}],69:[function(e,t,r){var i=e("./_is-object"),s=e("./_an-object"),o=function(e,t){if(s(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{(i=e("./_ctx")(Function.call,e("./_object-gopd").f(Object.prototype,"__proto__").set,2))(t,[]),r=!(t instanceof Array)}catch(e){r=!0}return function(e,t){return o(e,t),r?e.__proto__=t:i(e,t),e}}({},!1):void 0),check:o}},{"./_an-object":5,"./_ctx":16,"./_is-object":38,"./_object-gopd":54}],70:[function(e,t,r){"use strict";var i=e("./_global"),s=e("./_object-dp"),o=e("./_descriptors"),a=e("./_wks")("species");t.exports=function(e){var t=i[e];o&&t&&!t[a]&&s.f(t,a,{configurable:!0,get:function(){return this}})}},{"./_descriptors":18,"./_global":28,"./_object-dp":52,"./_wks":89}],71:[function(e,t,r){var i=e("./_object-dp").f,s=e("./_has"),o=e("./_wks")("toStringTag");t.exports=function(e,t,r){e&&!s(e=r?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},{"./_has":29,"./_object-dp":52,"./_wks":89}],72:[function(e,t,r){var i=e("./_shared")("keys"),s=e("./_uid");t.exports=function(e){return i[e]||(i[e]=s(e))}},{"./_shared":73,"./_uid":84}],73:[function(e,t,r){var i=e("./_core"),s=e("./_global"),o=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(t.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:e("./_library")?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},{"./_core":14,"./_global":28,"./_library":46}],74:[function(e,t,r){var i=e("./_an-object"),s=e("./_a-function"),o=e("./_wks")("species");t.exports=function(e,t){var r,a=i(e).constructor;return void 0===a||void 0==(r=i(a)[o])?t:s(r)}},{"./_a-function":2,"./_an-object":5,"./_wks":89}],75:[function(e,t,r){"use strict";var i=e("./_fails");t.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},{"./_fails":24}],76:[function(e,t,r){var i=e("./_is-regexp"),s=e("./_defined");t.exports=function(e,t,r){if(i(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(s(e))}},{"./_defined":17,"./_is-regexp":39}],77:[function(e,t,r){var i,s,o,a=e("./_ctx"),n=e("./_invoke"),l=e("./_html"),d=e("./_dom-create"),u=e("./_global"),c=u.process,h=u.setImmediate,p=u.clearImmediate,_=u.MessageChannel,g=u.Dispatch,f=0,m={},A=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},v=function(e){A.call(e.data)};h&&p||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++f]=function(){n("function"==typeof e?e:Function(e),t)},i(f),f},p=function(e){delete m[e]},"process"==e("./_cof")(c)?i=function(e){c.nextTick(a(A,e,1))}:g&&g.now?i=function(e){g.now(a(A,e,1))}:_?(o=(s=new _).port2,s.port1.onmessage=v,i=a(o.postMessage,o,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",v,!1)):i="onreadystatechange"in d("script")?function(e){l.appendChild(d("script")).onreadystatechange=function(){l.removeChild(this),A.call(e)}}:function(e){setTimeout(a(A,e,1),0)}),t.exports={set:h,clear:p}},{"./_cof":11,"./_ctx":16,"./_dom-create":19,"./_global":28,"./_html":31,"./_invoke":34}],78:[function(e,t,r){var i=e("./_to-integer"),s=Math.max,o=Math.min;t.exports=function(e,t){return(e=i(e))<0?s(e+t,0):o(e,t)}},{"./_to-integer":79}],79:[function(e,t,r){var i=Math.ceil,s=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?s:i)(e)}},{}],80:[function(e,t,r){var i=e("./_iobject"),s=e("./_defined");t.exports=function(e){return i(s(e))}},{"./_defined":17,"./_iobject":35}],81:[function(e,t,r){var i=e("./_to-integer"),s=Math.min;t.exports=function(e){return e>0?s(i(e),9007199254740991):0}},{"./_to-integer":79}],82:[function(e,t,r){var i=e("./_defined");t.exports=function(e){return Object(i(e))}},{"./_defined":17}],83:[function(e,t,r){var i=e("./_is-object");t.exports=function(e,t){if(!i(e))return e;var r,s;if(t&&"function"==typeof(r=e.toString)&&!i(s=r.call(e)))return s;if("function"==typeof(r=e.valueOf)&&!i(s=r.call(e)))return s;if(!t&&"function"==typeof(r=e.toString)&&!i(s=r.call(e)))return s;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":38}],84:[function(e,t,r){var i=0,s=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+s).toString(36))}},{}],85:[function(e,t,r){var i=e("./_global").navigator;t.exports=i&&i.userAgent||""},{"./_global":28}],86:[function(e,t,r){var i=e("./_is-object");t.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{"./_is-object":38}],87:[function(e,t,r){var i=e("./_global"),s=e("./_core"),o=e("./_library"),a=e("./_wks-ext"),n=e("./_object-dp").f;t.exports=function(e){var t=s.Symbol||(s.Symbol=o?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||n(t,e,{value:a.f(e)})}},{"./_core":14,"./_global":28,"./_library":46,"./_object-dp":52,"./_wks-ext":88}],88:[function(e,t,r){r.f=e("./_wks")},{"./_wks":89}],89:[function(e,t,r){var i=e("./_shared")("wks"),s=e("./_uid"),o=e("./_global").Symbol,a="function"==typeof o;(t.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:s)("Symbol."+e))}).store=i},{"./_global":28,"./_shared":73,"./_uid":84}],90:[function(e,t,r){var i=e("./_classof"),s=e("./_wks")("iterator"),o=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(void 0!=e)return e[s]||e["@@iterator"]||o[i(e)]}},{"./_classof":10,"./_core":14,"./_iterators":45,"./_wks":89}],91:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_array-methods")(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),e("./_add-to-unscopables")("find")},{"./_add-to-unscopables":3,"./_array-methods":7,"./_export":22}],92:[function(e,t,r){"use strict";var i=e("./_ctx"),s=e("./_export"),o=e("./_to-object"),a=e("./_iter-call"),n=e("./_is-array-iter"),l=e("./_to-length"),d=e("./_create-property"),u=e("./core.get-iterator-method");s(s.S+s.F*!e("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,s,c,h=o(e),p="function"==typeof this?this:Array,_=arguments.length,g=_>1?arguments[1]:void 0,f=void 0!==g,m=0,A=u(h);if(f&&(g=i(g,_>2?arguments[2]:void 0,2)),void 0==A||p==Array&&n(A))for(r=new p(t=l(h.length));t>m;m++)d(r,m,f?g(h[m],m):h[m]);else for(c=A.call(h),r=new p;!(s=c.next()).done;m++)d(r,m,f?a(c,g,[s.value,m],!0):s.value);return r.length=m,r}})},{"./_create-property":15,"./_ctx":16,"./_export":22,"./_is-array-iter":36,"./_iter-call":40,"./_iter-detect":43,"./_to-length":81,"./_to-object":82,"./core.get-iterator-method":90}],93:[function(e,t,r){"use strict";var i=e("./_add-to-unscopables"),s=e("./_iter-step"),o=e("./_iterators"),a=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,s(1)):s(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},{"./_add-to-unscopables":3,"./_iter-define":42,"./_iter-step":44,"./_iterators":45,"./_to-iobject":80}],94:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_a-function"),o=e("./_to-object"),a=e("./_fails"),n=[].sort,l=[1,2,3];i(i.P+i.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!e("./_strict-method")(n)),"Array",{sort:function(e){return void 0===e?n.call(o(this)):n.call(o(this),s(e))}})},{"./_a-function":2,"./_export":22,"./_fails":24,"./_strict-method":75,"./_to-object":82}],95:[function(e,t,r){var i=e("./_export");i(i.S+i.F,"Object",{assign:e("./_object-assign")})},{"./_export":22,"./_object-assign":50}],96:[function(e,t,r){var i=e("./_to-object"),s=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return s(i(e))}})},{"./_object-keys":60,"./_object-sap":62,"./_to-object":82}],97:[function(e,t,r){"use strict";var i,s,o,a,n=e("./_library"),l=e("./_global"),d=e("./_ctx"),u=e("./_classof"),c=e("./_export"),h=e("./_is-object"),p=e("./_a-function"),_=e("./_an-instance"),g=e("./_for-of"),f=e("./_species-constructor"),m=e("./_task").set,A=e("./_microtask")(),v=e("./_new-promise-capability"),y=e("./_perform"),b=e("./_user-agent"),P=e("./_promise-resolve"),T=l.TypeError,w=l.process,S=w&&w.versions,E=S&&S.v8||"",O=l.Promise,j="process"==u(w),I=function(){},C=s=v.f,x=!!function(){try{var t=O.resolve(1),r=(t.constructor={})[e("./_wks")("species")]=function(e){e(I,I)};return(j||"function"==typeof PromiseRejectionEvent)&&t.then(I)instanceof r&&0!==E.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(e){}}(),M=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var r=e._c;A(function(){for(var i=e._v,s=1==e._s,o=0,a=function(t){var r,o,a,n=s?t.ok:t.fail,l=t.resolve,d=t.reject,u=t.domain;try{n?(s||(2==e._h&&D(e),e._h=1),!0===n?r=i:(u&&u.enter(),r=n(i),u&&(u.exit(),a=!0)),r===t.promise?d(T("Promise-chain cycle")):(o=M(r))?o.call(r,l,d):l(r)):d(i)}catch(e){u&&!a&&u.exit(),d(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){m.call(l,function(){var t,r,i,s=e._v,o=V(e);if(o&&(t=y(function(){j?w.emit("unhandledRejection",s,e):(r=l.onunhandledrejection)?r({promise:e,reason:s}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",s)}),e._h=j||V(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},V=function(e){return 1!==e._h&&0===(e._a||e._c).length},D=function(e){m.call(l,function(){var t;j?w.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},N=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=M(e))?A(function(){var i={_w:r,_d:!1};try{t.call(e,d(N,i,1),d(L,i,1))}catch(e){L.call(i,e)}}):(r._v=e,r._s=1,k(r,!1))}catch(e){L.call({_w:r,_d:!1},e)}}};x||(O=function(e){_(this,O,"Promise","_h"),p(e),i.call(this);try{e(d(N,this,1),d(L,this,1))}catch(e){L.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=e("./_redefine-all")(O.prototype,{then:function(e,t){var r=C(f(this,O));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=j?w.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&k(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new i;this.promise=e,this.resolve=d(N,e,1),this.reject=d(L,e,1)},v.f=C=function(e){return e===O||e===a?new o(e):s(e)}),c(c.G+c.W+c.F*!x,{Promise:O}),e("./_set-to-string-tag")(O,"Promise"),e("./_set-species")("Promise"),a=e("./_core").Promise,c(c.S+c.F*!x,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),c(c.S+c.F*(n||!x),"Promise",{resolve:function(e){return P(n&&this===a?O:this,e)}}),c(c.S+c.F*!(x&&e("./_iter-detect")(function(e){O.all(e).catch(I)})),"Promise",{all:function(e){var t=this,r=C(t),i=r.resolve,s=r.reject,o=y(function(){var r=[],o=0,a=1;g(e,!1,function(e){var n=o++,l=!1;r.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,r[n]=e,--a||i(r))},s)}),--a||i(r)});return o.e&&s(o.v),r.promise},race:function(e){var t=this,r=C(t),i=r.reject,s=y(function(){g(e,!1,function(e){t.resolve(e).then(r.resolve,i)})});return s.e&&i(s.v),r.promise}})},{"./_a-function":2,"./_an-instance":4,"./_classof":10,"./_core":14,"./_ctx":16,"./_export":22,"./_for-of":27,"./_global":28,"./_is-object":38,"./_iter-detect":43,"./_library":46,"./_microtask":48,"./_new-promise-capability":49,"./_perform":64,"./_promise-resolve":65,"./_redefine-all":67,"./_set-species":70,"./_set-to-string-tag":71,"./_species-constructor":74,"./_task":77,"./_user-agent":85,"./_wks":89}],98:[function(e,t,r){var i=e("./_export"),s=e("./_object-gopd").f,o=e("./_an-object");i(i.S,"Reflect",{deleteProperty:function(e,t){var r=s(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},{"./_an-object":5,"./_export":22,"./_object-gopd":54}],99:[function(e,t,r){var i=e("./_global"),s=e("./_inherit-if-required"),o=e("./_object-dp").f,a=e("./_object-gopn").f,n=e("./_is-regexp"),l=e("./_flags"),d=i.RegExp,u=d,c=d.prototype,h=/a/g,p=/a/g,_=new d(h)!==h;if(e("./_descriptors")&&(!_||e("./_fails")(function(){return p[e("./_wks")("match")]=!1,d(h)!=h||d(p)==p||"/a/i"!=d(h,"i")}))){d=function(e,t){var r=this instanceof d,i=n(e),o=void 0===t;return!r&&i&&e.constructor===d&&o?e:s(_?new u(i&&!o?e.source:e,t):u((i=e instanceof d)?e.source:e,i&&o?l.call(e):t),r?this:c,d)};for(var g=function(e){e in d||o(d,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},f=a(u),m=0;f.length>m;)g(f[m++]);c.constructor=d,d.prototype=c,e("./_redefine")(i,"RegExp",d)}e("./_set-species")("RegExp")},{"./_descriptors":18,"./_fails":24,"./_flags":26,"./_global":28,"./_inherit-if-required":33,"./_is-regexp":39,"./_object-dp":52,"./_object-gopn":56,"./_redefine":68,"./_set-species":70,"./_wks":89}],100:[function(e,t,r){e("./_descriptors")&&"g"!=/./g.flags&&e("./_object-dp").f(RegExp.prototype,"flags",{configurable:!0,get:e("./_flags")})},{"./_descriptors":18,"./_flags":26,"./_object-dp":52}],101:[function(e,t,r){e("./_fix-re-wks")("match",1,function(e,t,r){return[function(r){"use strict";var i=e(this),s=void 0==r?void 0:r[t];return void 0!==s?s.call(r,i):new RegExp(r)[t](String(i))},r]})},{"./_fix-re-wks":25}],102:[function(e,t,r){e("./_fix-re-wks")("replace",2,function(e,t,r){return[function(i,s){"use strict";var o=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,o,s):r.call(String(o),i,s)},r]})},{"./_fix-re-wks":25}],103:[function(e,t,r){e("./_fix-re-wks")("search",1,function(e,t,r){return[function(r){"use strict";var i=e(this),s=void 0==r?void 0:r[t];return void 0!==s?s.call(r,i):new RegExp(r)[t](String(i))},r]})},{"./_fix-re-wks":25}],104:[function(e,t,r){e("./_fix-re-wks")("split",2,function(t,r,i){"use strict";var s=e("./_is-regexp"),o=i,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var n=void 0===/()??/.exec("")[1];i=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!s(e))return o.call(r,e,t);var i,l,d,u,c,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),_=0,g=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,p+"g");for(n||(i=new RegExp("^"+f.source+"$(?!\\s)",p));(l=f.exec(r))&&!((d=l.index+l[0].length)>_&&(h.push(r.slice(_,l.index)),!n&&l.length>1&&l[0].replace(i,function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(l[c]=void 0)}),l.length>1&&l.index<r.length&&a.apply(h,l.slice(1)),u=l[0].length,_=d,h.length>=g));)f.lastIndex===l.index&&f.lastIndex++;return _===r.length?!u&&f.test("")||h.push(""):h.push(r.slice(_)),h.length>g?h.slice(0,g):h}}else"0".split(void 0,0).length&&(i=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(e,s){var o=t(this),a=void 0==e?void 0:e[r];return void 0!==a?a.call(e,o,s):i.call(String(o),e,s)},i]})},{"./_fix-re-wks":25,"./_is-regexp":39}],105:[function(e,t,r){"use strict";e("./es6.regexp.flags");var i=e("./_an-object"),s=e("./_flags"),o=e("./_descriptors"),a=/./.toString,n=function(t){e("./_redefine")(RegExp.prototype,"toString",t,!0)};e("./_fails")(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?n(function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?s.call(e):void 0)}):"toString"!=a.name&&n(function(){return a.call(this)})},{"./_an-object":5,"./_descriptors":18,"./_fails":24,"./_flags":26,"./_redefine":68,"./es6.regexp.flags":100}],106:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_to-length"),o=e("./_string-context"),a="".endsWith;i(i.P+i.F*e("./_fails-is-regexp")("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,i=s(t.length),n=void 0===r?i:Math.min(s(r),i),l=String(e);return a?a.call(t,l,n):t.slice(n-l.length,n)===l}})},{"./_export":22,"./_fails-is-regexp":23,"./_string-context":76,"./_to-length":81}],107:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_string-context");i(i.P+i.F*e("./_fails-is-regexp")("includes"),"String",{includes:function(e){return!!~s(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},{"./_export":22,"./_fails-is-regexp":23,"./_string-context":76}],108:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_to-length"),o=e("./_string-context"),a="".startsWith;i(i.P+i.F*e("./_fails-is-regexp")("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),r=s(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return a?a.call(t,i,r):t.slice(r,r+i.length)===i}})},{"./_export":22,"./_fails-is-regexp":23,"./_string-context":76,"./_to-length":81}],109:[function(e,t,r){"use strict";var i=e("./_global"),s=e("./_has"),o=e("./_descriptors"),a=e("./_export"),n=e("./_redefine"),l=e("./_meta").KEY,d=e("./_fails"),u=e("./_shared"),c=e("./_set-to-string-tag"),h=e("./_uid"),p=e("./_wks"),_=e("./_wks-ext"),g=e("./_wks-define"),f=e("./_enum-keys"),m=e("./_is-array"),A=e("./_an-object"),v=e("./_is-object"),y=e("./_to-iobject"),b=e("./_to-primitive"),P=e("./_property-desc"),T=e("./_object-create"),w=e("./_object-gopn-ext"),S=e("./_object-gopd"),E=e("./_object-dp"),O=e("./_object-keys"),j=S.f,I=E.f,C=w.f,x=i.Symbol,M=i.JSON,k=M&&M.stringify,R=p("_hidden"),V=p("toPrimitive"),D={}.propertyIsEnumerable,L=u("symbol-registry"),N=u("symbols"),$=u("op-symbols"),F=Object.prototype,B="function"==typeof x,W=i.QObject,U=!W||!W.prototype||!W.prototype.findChild,Y=o&&d(function(){return 7!=T(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(e,t,r){var i=j(F,t);i&&delete F[t],I(e,t,r),i&&e!==F&&I(F,t,i)}:I,Q=function(e){var t=N[e]=T(x.prototype);return t._k=e,t},G=B&&"symbol"==typeof x.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof x},H=function(e,t,r){return e===F&&H($,t,r),A(e),t=b(t,!0),A(r),s(N,t)?(r.enumerable?(s(e,R)&&e[R][t]&&(e[R][t]=!1),r=T(r,{enumerable:P(0,!1)})):(s(e,R)||I(e,R,P(1,{})),e[R][t]=!0),Y(e,t,r)):I(e,t,r)},z=function(e,t){A(e);for(var r,i=f(t=y(t)),s=0,o=i.length;o>s;)H(e,r=i[s++],t[r]);return e},J=function(e){var t=D.call(this,e=b(e,!0));return!(this===F&&s(N,e)&&!s($,e))&&(!(t||!s(this,e)||!s(N,e)||s(this,R)&&this[R][e])||t)},q=function(e,t){if(e=y(e),t=b(t,!0),e!==F||!s(N,t)||s($,t)){var r=j(e,t);return!r||!s(N,t)||s(e,R)&&e[R][t]||(r.enumerable=!0),r}},Z=function(e){for(var t,r=C(y(e)),i=[],o=0;r.length>o;)s(N,t=r[o++])||t==R||t==l||i.push(t);return i},K=function(e){for(var t,r=e===F,i=C(r?$:y(e)),o=[],a=0;i.length>a;)!s(N,t=i[a++])||r&&!s(F,t)||o.push(N[t]);return o};B||(n((x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===F&&t.call($,r),s(this,R)&&s(this[R],e)&&(this[R][e]=!1),Y(this,e,P(1,r))};return o&&U&&Y(F,e,{configurable:!0,set:t}),Q(e)}).prototype,"toString",function(){return this._k}),S.f=q,E.f=H,e("./_object-gopn").f=w.f=Z,e("./_object-pie").f=J,e("./_object-gops").f=K,o&&!e("./_library")&&n(F,"propertyIsEnumerable",J,!0),_.f=function(e){return Q(p(e))}),a(a.G+a.W+a.F*!B,{Symbol:x});for(var X="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;X.length>ee;)p(X[ee++]);for(var te=O(p.store),re=0;te.length>re;)g(te[re++]);a(a.S+a.F*!B,"Symbol",{for:function(e){return s(L,e+="")?L[e]:L[e]=x(e)},keyFor:function(e){if(!G(e))throw TypeError(e+" is not a symbol!");for(var t in L)if(L[t]===e)return t},useSetter:function(){U=!0},useSimple:function(){U=!1}}),a(a.S+a.F*!B,"Object",{create:function(e,t){return void 0===t?T(e):z(T(e),t)},defineProperty:H,defineProperties:z,getOwnPropertyDescriptor:q,getOwnPropertyNames:Z,getOwnPropertySymbols:K}),M&&a(a.S+a.F*(!B||d(function(){var e=x();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,r,i=[e],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=t=i[1],(v(t)||void 0!==e)&&!G(e))return m(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!G(t))return t}),i[1]=t,k.apply(M,i)}}),x.prototype[V]||e("./_hide")(x.prototype,V,x.prototype.valueOf),c(x,"Symbol"),c(Math,"Math",!0),c(i.JSON,"JSON",!0)},{"./_an-object":5,"./_descriptors":18,"./_enum-keys":21,"./_export":22,"./_fails":24,"./_global":28,"./_has":29,"./_hide":30,"./_is-array":37,"./_is-object":38,"./_library":46,"./_meta":47,"./_object-create":51,"./_object-dp":52,"./_object-gopd":54,"./_object-gopn":56,"./_object-gopn-ext":55,"./_object-gops":57,"./_object-keys":60,"./_object-pie":61,"./_property-desc":66,"./_redefine":68,"./_set-to-string-tag":71,"./_shared":73,"./_to-iobject":80,"./_to-primitive":83,"./_uid":84,"./_wks":89,"./_wks-define":87,"./_wks-ext":88}],110:[function(e,t,r){"use strict";var i,s=e("./_array-methods")(0),o=e("./_redefine"),a=e("./_meta"),n=e("./_object-assign"),l=e("./_collection-weak"),d=e("./_is-object"),u=e("./_fails"),c=e("./_validate-collection"),h=a.getWeak,p=Object.isExtensible,_=l.ufstore,g={},f=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(e){if(d(e)){var t=h(e);return!0===t?_(c(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(c(this,"WeakMap"),e,t)}},A=t.exports=e("./_collection")("WeakMap",f,m,l,!0,!0);u(function(){return 7!=(new A).set((Object.freeze||Object)(g),7).get(g)})&&(n((i=l.getConstructor(f,"WeakMap")).prototype,m),a.NEED=!0,s(["delete","has","get","set"],function(e){var t=A.prototype,r=t[e];o(t,e,function(t,s){if(d(t)&&!p(t)){this._f||(this._f=new i);var o=this._f[e](t,s);return"set"==e?this:o}return r.call(this,t,s)})}))},{"./_array-methods":7,"./_collection":13,"./_collection-weak":12,"./_fails":24,"./_is-object":38,"./_meta":47,"./_object-assign":50,"./_redefine":68,"./_validate-collection":86}],111:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_array-includes")(!0);i(i.P,"Array",{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),e("./_add-to-unscopables")("includes")},{"./_add-to-unscopables":3,"./_array-includes":6,"./_export":22}],112:[function(e,t,r){var i=e("./_export"),s=e("./_object-to-array")(!1);i(i.S,"Object",{values:function(e){return s(e)}})},{"./_export":22,"./_object-to-array":63}],113:[function(e,t,r){"use strict";var i=e("./_export"),s=e("./_core"),o=e("./_global"),a=e("./_species-constructor"),n=e("./_promise-resolve");i(i.P+i.R,"Promise",{finally:function(e){var t=a(this,s.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return n(t,e()).then(function(){return r})}:e,r?function(r){return n(t,e()).then(function(){throw r})}:e)}})},{"./_core":14,"./_export":22,"./_global":28,"./_promise-resolve":65,"./_species-constructor":74}],114:[function(e,t,r){e("./_wks-define")("asyncIterator")},{"./_wks-define":87}],115:[function(e,t,r){for(var i=e("./es6.array.iterator"),s=e("./_object-keys"),o=e("./_redefine"),a=e("./_global"),n=e("./_hide"),l=e("./_iterators"),d=e("./_wks"),u=d("iterator"),c=d("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},_=s(p),g=0;g<_.length;g++){var f,m=_[g],A=p[m],v=a[m],y=v&&v.prototype;if(y&&(y[u]||n(y,u,h),y[c]||n(y,c,m),l[m]=h,A))for(f in i)y[f]||o(y,f,i[f],!0)}},{"./_global":28,"./_hide":30,"./_iterators":45,"./_object-keys":60,"./_redefine":68,"./_wks":89,"./es6.array.iterator":93}],116:[function(e,t,r){!function(){"use strict";function e(t,r){var s;if(r=r||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=r.touchBoundary||10,this.layer=t,this.tapDelay=r.tapDelay||200,this.tapTimeout=r.tapTimeout||700,!e.notNeeded(t)){for(var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=0,n=o.length;a<n;a++)this[o[a]]=l(this[o[a]],this);i&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,r,i){var s=Node.prototype.removeEventListener;"click"===e?s.call(t,e,r.hijacked||r,i):s.call(t,e,r,i)},t.addEventListener=function(e,r,i){var s=Node.prototype.addEventListener;"click"===e?s.call(t,e,r.hijacked||(r.hijacked=function(e){e.propagationStopped||r(e)}),i):s.call(t,e,r,i)}),"function"==typeof t.onclick&&(s=t.onclick,t.addEventListener("click",function(e){s(e)},!1),t.onclick=null)}function l(e,t){return function(){return e.apply(t,arguments)}}}var r=navigator.userAgent.indexOf("Windows Phone")>=0,i=navigator.userAgent.indexOf("Android")>0&&!r,s=/iP(ad|hone|od)/.test(navigator.userAgent)&&!r,o=s&&/OS 4_\d(_\d)?/.test(navigator.userAgent),a=s&&/OS [6-7]_\d/.test(navigator.userAgent),n=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(s&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},e.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!i;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},e.prototype.sendClick=function(e,t){var r,i;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),i=t.changedTouches[0],(r=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(e),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),r.forwardedTouchEvent=!0,e.dispatchEvent(r)},e.prototype.determineEventType=function(e){return i&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},e.prototype.focus=function(e){var t;s&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},e.prototype.updateScrollParent=function(e){var t,r;if(!(t=e.fastClickScrollParent)||!t.contains(e)){r=e;do{if(r.scrollHeight>r.offsetHeight){t=r,e.fastClickScrollParent=r;break}r=r.parentElement}while(r)}t&&(t.fastClickLastScrollTop=t.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},e.prototype.onTouchStart=function(e){var t,r,i;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),r=e.targetTouches[0],s){if((i=window.getSelection()).rangeCount&&!i.isCollapsed)return!0;if(!o){if(r.identifier&&r.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=r.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=r.pageX,this.touchStartY=r.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},e.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],r=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>r||Math.abs(t.pageY-this.touchStartY)>r},e.prototype.onTouchMove=function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)},e.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(e){var t,r,n,l,d,u=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,r=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,a&&(d=e.changedTouches[0],(u=document.elementFromPoint(d.pageX-window.pageXOffset,d.pageY-window.pageYOffset)||u).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(n=u.tagName.toLowerCase())){if(t=this.findControl(u)){if(this.focus(u),i)return!1;u=t}}else if(this.needsFocus(u))return e.timeStamp-r>100||s&&window.top!==window&&"input"===n?(this.targetElement=null,!1):(this.focus(u),this.sendClick(u,e),s&&"select"===n||(this.targetElement=null,e.preventDefault()),!1);return!(!s||o||!(l=u.fastClickScrollParent)||l.fastClickLastScrollTop===l.scrollTop)||(this.needsClick(u)||(e.preventDefault(),this.sendClick(u,e)),!1)},e.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(e){return!this.targetElement||(!!e.forwardedTouchEvent||(!e.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))))},e.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail||((t=this.onMouse(e))||(this.targetElement=null),t)},e.prototype.destroy=function(){var e=this.layer;i&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(e){var t,r,s;if(void 0===window.ontouchstart)return!0;if(r=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!i)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(r>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(n&&(s=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&s[2]>=3&&(t=document.querySelector("meta[name=viewport]"))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(t=document.querySelector("meta[name=viewport]"))&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===e.style.touchAction||"manipulation"===e.style.touchAction))},e.attach=function(t,r){return new e(t,r)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):void 0!==t&&t.exports?(t.exports=e.attach,t.exports.FastClick=e):window.FastClick=e}()},{}],117:[function(e,t,r){!function(){"use strict";var e=["fullscreen","fullscreenEnabled","fullscreenElement","fullscreenchange","fullscreenerror","exitFullscreen","requestFullscreen"],t=["webkitIsFullScreen","webkitFullscreenEnabled","webkitFullscreenElement","webkitfullscreenchange","webkitfullscreenerror","webkitExitFullscreen","webkitRequestFullscreen"],r=["mozFullScreen","mozFullScreenEnabled","mozFullScreenElement","mozfullscreenchange","mozfullscreenerror","mozCancelFullScreen","mozRequestFullScreen"],i=["","msFullscreenEnabled","msFullscreenElement","MSFullscreenChange","MSFullscreenError","msExitFullscreen","msRequestFullscreen"];document||(document={});var s,o=(s=[e[1],t[1],r[1],i[1]].find(function(e){return document[e]}),[e,t,r,i].find(function(e){return e.find(function(e){return e===s})})||[]);function a(t,r){document[e[0]]=document[o[0]]||!!document[o[2]]||!1,document[e[1]]=document[o[1]]||!1,document[e[2]]=document[o[2]]||null,document.dispatchEvent(new Event(t),r.target)}document[e[1]]||(document[e[0]]=document[o[0]]||!!document[o[2]]||!1,document[e[1]]=document[o[1]]||!1,document[e[2]]=document[o[2]]||null,document.addEventListener(o[3],a.bind(document,e[3]),!1),document.addEventListener(o[4],a.bind(document,e[4]),!1),document[e[5]]=function(){return document[o[5]]()},Element.prototype[e[6]]=function(){return this[o[6]].apply(this,arguments)})}()},{}],118:[function(e,t,r){var i=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape).replace(/%20/g,"+")},s=function(e,t,r,o){return t=t||null,r=r||"&",o=o||null,e?function(e){for(var t=new Array,r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t}(Object.keys(e).map(function(a){var n,l,d=a;if(o&&(d=o+"["+d+"]"),"object"==typeof e[a]&&null!==e[a])n=s(e[a],null,r,d);else{t&&(l=d,d=!isNaN(parseFloat(l))&&isFinite(l)?t+Number(d):d);var u=e[a];u=(u=0===(u=!1===(u=!0===u?"1":u)?"0":u)?"0":u)||"",n=i(d)+"="+i(u)}return n})).join(r).replace(/[!'()*]/g,""):""};t.exports=s},{}],119:[function(e,t,r){r.endianness=function(){return"LE"},r.hostname=function(){return"undefined"!=typeof location?location.hostname:""},r.loadavg=function(){return[]},r.uptime=function(){return 0},r.freemem=function(){return Number.MAX_VALUE},r.totalmem=function(){return Number.MAX_VALUE},r.cpus=function(){return[]},r.type=function(){return"Browser"},r.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},r.networkInterfaces=r.getNetworkInterfaces=function(){return{}},r.arch=function(){return"javascript"},r.platform=function(){return"browser"},r.tmpdir=r.tmpDir=function(){return"/tmp"},r.EOL="\n",r.homedir=function(){return"/"}},{}],120:[function(e,t,r){var i,s,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function l(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(e){s=n}}();var d,u=[],c=!1,h=-1;function p(){c&&d&&(c=!1,d.length?u=d.concat(u):h=-1,u.length&&_())}function _(){if(!c){var e=l(p);c=!0;for(var t=u.length;t;){for(d=u,u=[];++h<t;)d&&d[h].run();h=-1,t=u.length}d=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new g(e,t)),1!==u.length||c||l(_)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],121:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Plugin",{enumerable:!0,get:function(){return b.default}}),r.AdvertPluginDefault=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.split"),e("core-js/modules/web.dom.iterable");var i=L(e("./provider/html5")),s=L(e("./provider/flv")),o=L(e("./provider/youtube")),a=L(e("./provider/vimeo")),n=L(e("./provider/mv_iframe")),l=L(e("./provider/iframe")),d=L(e("./provider/html5-audio")),u=L(e("./provider/metaprovider")),c=L(e("../integrations/providers/providers")),h=L(e("../../../../player/controls/controls")),p=L(e("./advert-layout")),_=L(e("./controls/adskip")),g=L(e("./controls/adclose")),f=L(e("./controls/adexpand")),m=L(e("./controls/adclickable")),A=L(e("./controls/adbutton")),v=L(e("./controls/adresume")),y=e("./controls/adphone"),b=L(e("./../../../../player/core/plugin")),P=e("./../../../../player/utils/extend"),T=e("../../../../player/utils/ajax"),w=L(e("../../../../player/core/console")),S=L(e("../../../../player/env/index")),E=L(e("../../../../player/utils/pixels")),O=L(e("./url/url")),j=L(e("./controls/adcountdown")),I=L(e("./controls/adinfo")),C=e("./lib/AdsConfigWorker"),x=L(e("./provider/default")),M=L(e("./manager/manager")),k=L(e("./controls/adcontrol")),R=L(e("../../../../player/utils/catchHandler")),V=e("./lib/rtbService"),D=L(e("../../../../player/core/storage/proxy/storage-global"));function L(e){return e&&e.__esModule?e:{default:e}}function N(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function $(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){N(o,i,s,a,n,"next",e)}function n(e){N(o,i,s,a,n,"throw",e)}a(void 0)})}}const F="DaupWs3qfp9ZNS5AttIO",B="//c.fqtag.com/tag/implement-r.js?";class W extends b.default{constructor(e,t){super(e,function(e){return"string"==typeof e&&(e=JSON.parse(atob(e))),e}(t)),this.TIME_PIXELS=0,this.options=t,this.player=e,this._initCount=W.stInitCount++;const r=this.getPlayer().volumeControl;r.addType("ad",.8,!0),r.addDetectTypeRule(e=>{if(e instanceof x.default||e instanceof i.default||e instanceof s.default||e instanceof o.default||e instanceof a.default||e instanceof n.default||e instanceof l.default||e instanceof d.default||e instanceof u.default||e instanceof M.default||e instanceof k.default||"function"==typeof e.getAdId)return"ad";let t=null;return c.default.forEach(r=>{if(e instanceof r)return t="ad",!1}),t}),r.on("typeChange",e=>{"player"===e.newType&&"ad"===e.oldType&&r.setMuted(!0,"ad",!1,this)})}_init(){var e=this;const t=this.getOption("advList"),r=this.getOption("slots");if(this._initJob)return this._initJob;let i=this.getPlayer();this._showedAds={},this._managers={},this._configWorker=new C.AdsConfigWorker(i,this,{controls:(0,P.clone)(this.getOption("controls")),slotIds:(0,P.clone)(this.getOption("slotIds"))}),this.listenTo(i,{inventory:this._onInventory}),i.isReady()?setTimeout(()=>{this._onPlayerReady()},0):this.listenTo(i,{ready:this._onPlayerReady});try{new V.RtbService(t,i,r)}catch(e){w.default.error(e)}return this._initJob=i.getStorage().ready().then($(function*(){try{e.adSlots=yield e._configWorker.prepare(t,r),e._requestTargets(),e._forensiqPixelRequest()}catch(e){w.default.warn(e)}}))}_onPlayerReady(){}getPixel(){const e=this._player._options.plugins.backend.userUids[0];return["https://moevideo-sync.rutarget.ru/sync","https://dm.hybrid.ai/match?id=117",`https://px.adhigh.net/p/cm/moevideo?u=${e}`,`https://sync.bumlam.com/?src=moe2&uid=${e}`,`https://mitdmp.whiteboxdigital.ru/pixel?source=moevideo&id=${e}&redirect=true&href=https%3A%2F%2Fcs-0.moevideo.biz%2Fssp%2Fcs%3Fd%3D51%26b%3D%7Buid%7D`,"https://ad.adriver.ru/cgi-bin/rle.cgi?sid=1&ad=719570&bt=21&bn=719570","https://exchange.buzzoola.com/cookiesync/redirect/moevideo?redirect_url=https%3A%2F%2Fcs-0.moevideo.biz%2Fssp%2Fcs%3Fd%3D81%26b%3D%24%7BUUID%7D","https://sync.upravel.com/moevideo/sync",`https://sm.rtb.mts.ru/p?ssp=moevideo&id=${e}`,"https://sync.dmp.otm-r.com/match/moevideo",`https://rtb.com.ru/myvideo-sync?uid=${e}`,"https://ads.betweendigital.com/match?bidder_id=42837&callback_url=https%3A%2F%2Fcs-0.moevideo.biz%2Fssp%2Fcs%3Fd%3D161%26b%3D%24%7BUSER_ID%7D",`https://dx.frontend.weborama.com/collect?touchpoint=0&url=${escape(document.location)}`]}_requestTargets(){var e=this;return $(function*(){if(!e.getCookiesObj(document.cookie).mvuid)return;const t=e.getMvuid(e.player);let r;try{r=yield e.hasStore("syncCookie")}catch(e){return(0,R.default)(e)}e.isSetCookie(r,t)||setTimeout($(function*(){let r=e.getOption("urlForRequestUserTargets"),i=e.getPixel();r&&(0,E.default)(r).then(()=>{w.default.info("Таргеты пользователя запрошены")}).catch(e=>(0,R.default)(e)),i&&i.length&&(0,E.default)(i).then(()=>{w.default.info("Пиксели rs установлены")}).catch(e=>(0,R.default)(e)),yield e.setCookie(t,"syncCookie")}),e.TIME_PIXELS)})()}getCookiesObj(e){return Object.fromEntries(e.split("; ").map(e=>e.split("=")))}getMvuid(e){return e._options.plugins.backend.userUids[0]}isSetCookie({time:e,uid:t},r){return t===r&&Date.now()<e+6048e5}hasStore(e){var t=this;return $(function*(){t.crossDomainStorage=new D.default(t.player,t.options);const r={mvtest:!0,MoeVideoStorage:!0,type:"request",data:{reqId:999,action:"get",data:e}};return new Promise(function(){var e=$(function*(e,i){try{yield t.crossDomainStorage._doReady(),window.addEventListener("message",function(){var t=$(function*(t){try{const r=JSON.parse(t.data);999===r.event.data.reqId&&(r.event.data.data||e(0),e(r.event.data.data))}catch(e){i(e)}});return function(e){return t.apply(this,arguments)}}()),t.crossDomainStorage._$iframe[0].contentWindow.postMessage(JSON.stringify(r),"*")}catch(e){i(e)}});return function(t,r){return e.apply(this,arguments)}}())})()}setCookie(e,t){var r=this;return $(function*(){r.crossDomainStorage||(r.crossDomainStorage=new D.default(r.player,r.options));const i=Date.now(),s={mvtest:!0,MoeVideoStorage:!0,type:"request",data:{reqId:111,action:"set",data:{key:t,value:{time:i,uid:e}}}};try{yield r.crossDomainStorage._doReady(),r.crossDomainStorage._$iframe[0].contentWindow.postMessage(JSON.stringify(s),"*")}catch(e){w.default.error("unsucssesful set cookie in store")}return i})()}load(){return new Promise((e,t)=>{this.getOption("src")?(0,T.get)(this.getOption("src")).then(t=>{this.setOptions(t),this._init(),e()}).catch(t):(this._init(),e())})}_slotIsEmpty(e){return!this.adSlots[e]}_registerManager(e){let t=e.slot,r=this.adSlots[t];this._managers[t]=e,e.setSlotId(this.getOption("slotIds",{})[t]),e.setSelectorConfig(r),e.init()}hasManager(e){return this._managers.hasOwnProperty(e)}getManager(e){return this._managers[e]}_enableSlot(e){this.hasManager(e)&&this.getManager(e).enable()}_disableSlot(e,t=!1){this.hasManager(e)&&this.getManager(e).disable(t)}_onInventory(e){let t=e.slot,r=this._getSlotId(t);r&&!this.getOption("testMode")&&this.getPlayer().trigger("inventoryLog",{slot:t,slotId:r})}_getSlotId(e){return this.getOption("slotIds",{})[e]}markAsShowedAd(e){this._forensiqFullRequest(e)}markAsSelectedAd(e,t){this._showedAds[`${e}-${t}`]=!0}alreadySelectedAd(e,t){return this._showedAds.hasOwnProperty(`${e}-${t}`)}_forensiqPixelRequest(){}_forensiqFullRequest(e){if(S.default.isBot)return;if(!1===!!e.getOption("useForensiq"))return;let t=this.getPlayer(),r=t.getOptions(),i=(0,P.clone)(this.getOption("variables",{})),s=B+["org=[fq_org]","p=[site_id]","a=[fq_a]","cmp=[fq_cmp]","rt=display","rd=[referer]","ctu=[fq_page]","fmt=video","sl=1","fq=1","s=[user_id]"].join("&"),o=document.createElement("script");i.fq_org=F,i.fq_a=r.deviceInfo.device.id,i.fq_page=location,i.fq_cmp=e.getOption("adId"),o.src=O.default.replace(s,i,t),document.body.appendChild(o),w.default.log(`forensiq full: ${o.src}`,this._initCount)}}r.AdvertPluginDefault=W,W.prototype._options={controls:{layout:p.default,rewrite:!0,items:{volume:{},mute:{},screenplay:{},progress:{drag:!1},adskip:{},adclose:{},adbutton:{},adclickable:{},fullscreen:{},adexpand:{},wantplay:{text:"Воспроизведение продолжится после показа рекламы"},wantunmute:{text:"Включить звук"},adcountdown:{},adinfo:{}}},slotIds:{pre:1,post:2,auto:3,pause:4,mid:5,content:6,native:6,black:7,vast:8,html:9,player:10}},W.stInitCount=0,h.default.register(_.default),h.default.register(f.default),h.default.register(g.default),h.default.register(A.default),h.default.register(m.default),h.default.register(y.AdPhoneControl),h.default.register(v.default),h.default.register(j.default),h.default.register(I.default)},{"../../../../player/controls/controls":256,"../../../../player/core/console":280,"../../../../player/core/storage/proxy/storage-global":292,"../../../../player/env/index":306,"../../../../player/utils/ajax":325,"../../../../player/utils/catchHandler":327,"../../../../player/utils/pixels":333,"../integrations/providers/providers":209,"./../../../../player/core/plugin":289,"./../../../../player/utils/extend":330,"./advert-layout":124,"./controls/adbutton":130,"./controls/adclickable":131,"./controls/adclose":132,"./controls/adcontrol":133,"./controls/adcountdown":134,"./controls/adexpand":135,"./controls/adinfo":136,"./controls/adphone":137,"./controls/adresume":138,"./controls/adskip":139,"./lib/AdsConfigWorker":148,"./lib/rtbService":150,"./manager/manager":162,"./provider/default":175,"./provider/flv":176,"./provider/html5":178,"./provider/html5-audio":177,"./provider/iframe":179,"./provider/metaprovider":180,"./provider/mv_iframe":181,"./provider/vimeo":183,"./provider/youtube":184,"./url/url":203,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104,"core-js/modules/web.dom.iterable":115}],122:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Plugin",{enumerable:!0,get:function(){return i.Plugin}}),r.AdvertPluginPlayer=void 0;var i=e("./AdvertPluginDefault"),s=y(e("./lib/slots")),o=e("./manager/manager"),a=y(e("./manager/auto/autoroll-manager")),n=y(e("./manager/pre/preroll-manager")),l=y(e("./manager/pause/pauseroll-manager")),d=y(e("./manager/mid/midroll-manager")),u=y(e("./manager/post/postroll-manager")),c=y(e("./manager/content/contentroll-manager-v1.0")),h=y(e("./manager/content/contentroll-manager-v2.0")),p=y(e("./manager/content/contentroll-manager-audio")),_=y(e("./manager/content/overroll-click-manager")),g=y(e("./manager/content/overroll-focus-manager")),f=y(e("./manager/content/video-banner-manager")),m=y(e("./manager/vpaid/vpaid-manager")),A=y(e("../../../../player/core/console")),v=y(e("../../../../player/utils/catchHandler"));function y(e){return e&&e.__esModule?e:{default:e}}class b extends i.AdvertPluginDefault{_onPlayerReady(){A.default.log("AdvertPluginPlayer _onPlayerReady call this._init()"),this._init().then(()=>{this._initAutoplayAndPreroll(),this._initMidrollSlot(),this._initPauserollSlot(),this._initPostrollSlot(),this._initContentrollSlot(),this._initOverrollClickSlot(),this._initOverrollFocusSlot(),this._initContentrollAudioSlot(),this._initVideoBannerSlot(),this._initVastSlot()}).catch(e=>{(0,v.default)(e)})}_initAutoplayAndPreroll(){let e,t,r=1e3*this.getOption("preAfterAutoTimeout",60),i=this.getOption("autoPlayOnlyIfVisible"),l=this.getPlayer();e=new n.default(this,{name:s.default.PRE}),t=new a.default(this,{name:s.default.AUTO,longIdleAfterFinishTimeout:r}),this._registerManager(e),this._registerManager(t),this.listenTo(e,{state:e=>{switch(e.state){case o.MANAGER_STATE.WAITING:case o.MANAGER_STATE.AD_START:this._disableSlot(s.default.AUTO,!0)}}});let d=!1;this.listenTo(t,{longIdleAfterFinish:()=>{this._enableSlot(s.default.PRE)},state:e=>{switch(e.state){case o.MANAGER_STATE.AD_ERROR:case o.MANAGER_STATE.EMPTY:d||this._enableSlot(s.default.PRE);break;case o.MANAGER_STATE.WAITING:this._disableSlot(s.default.PRE);break;case o.MANAGER_STATE.AD_START:this._disableSlot(s.default.PRE),d=!0}}}),t.exists?l.visible||!i?this._enableSlot(s.default.AUTO):(l.once("visible",()=>{if(e.exists)switch(e.state){case o.MANAGER_STATE.INIT:case o.MANAGER_STATE.READY:this._enableSlot(s.default.AUTO)}else this._enableSlot(s.default.AUTO)}),this._enableSlot(s.default.PRE)):e.exists&&this._enableSlot(s.default.PRE)}_initMidrollSlot(){this._registerManager(new d.default(this,{name:s.default.MID}))}_initPauserollSlot(){this._registerManager(new l.default(this,{name:s.default.PAUSE}))}_initPostrollSlot(){this._registerManager(new u.default(this,{name:s.default.POST}))}_initContentrollSlot(){if(this._slotIsEmpty(s.default.CONTENT))return;let e,t={name:s.default.CONTENT,maxAds:this.getOption("maxAds")};switch(this.getOption("contentrollApi","1.0")){case"2.0":e=new h.default(this,t);break;case"1.0":default:e=new c.default(this,t)}this._registerManager(e)}_initOverrollFocusSlot(){this._slotIsEmpty(s.default.OVER_FOCUS)||this._registerManager(new g.default(this,{name:s.default.OVER_FOCUS}))}_initVideoBannerSlot(){this._slotIsEmpty(s.default.VIDEO_BANNER)||this._registerManager(new f.default(this,{name:s.default.VIDEO_BANNER}))}_initOverrollClickSlot(){if(this._slotIsEmpty(s.default.OVER_CLICK))return;let e=new _.default(this,{name:s.default.OVER_CLICK});this._registerManager(e),e.enable()}_initContentrollAudioSlot(){this._slotIsEmpty(s.default.CONTENT_AUDIO)||this._registerManager(new p.default(this,{name:s.default.CONTENT_AUDIO}))}_initVastSlot(){this._slotIsEmpty(s.default.VAST)||this._registerManager(new m.default(this,{name:s.default.VAST,maxAds:this.getOption("maxAds")}))}getVpaidManager(){return this.getManager(s.default.VAST)}}r.AdvertPluginPlayer=b,i.Plugin.register("advert",b)},{"../../../../player/core/console":280,"../../../../player/utils/catchHandler":327,"./AdvertPluginDefault":121,"./lib/slots":151,"./manager/auto/autoroll-manager":152,"./manager/content/contentroll-manager-audio":154,"./manager/content/contentroll-manager-v1.0":155,"./manager/content/contentroll-manager-v2.0":156,"./manager/content/overroll-click-manager":157,"./manager/content/overroll-focus-manager":158,"./manager/content/video-banner-manager":159,"./manager/manager":162,"./manager/mid/midroll-manager":163,"./manager/pause/pauseroll-manager":164,"./manager/post/postroll-manager":167,"./manager/pre/preroll-manager":171,"./manager/vpaid/vpaid-manager":172}],123:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.promise");var i=u(e("./../../../../player/core/base-object")),s=u(e("./media-container")),o=e("../../../../player/providers/default"),a=u(e("./../../../../player/utils/error")),n=u(e("../../../../player/core/console")),l=u(e("../../../../player/utils/catchHandler")),d=u(e("../../../../common/js/utils/ad-block-cache"));function u(e){return e&&e.__esModule?e:{default:e}}const c="___MV_AD_BLOCK_DATA",h=864e5,p=-1;class _ extends i.default{constructor(e,t={}){super(e.getPlayer(),t),this._currentLoadedAd=null,this._viewedBlocks=[],this._adSelector=e,this._notSelectedList={},this._init().then(()=>{this._loadingJobs=[];for(let e=0;e<this._items.length;e++)this._loadingJobs.push(!1);this._index=-1}).catch(e=>(0,l.default)(e))}_init(){return this._initJob?this._initJob:this._initJob=this._filter(this._loadItems()).then(e=>{this._items=e})}get currentLoadedAd(){return this._currentLoadedAd}_loadItems(){return this.getOption("items")}_filter(e){let t=[],r=[],i=[];for(let o=0;o<e.length;o++){let a=e[o],n=a.ad;t.push(new Promise(e=>{this._adSelector.allowPlayingAdvert(n).then(()=>{r.push(a)}).catch(()=>{let e=n instanceof s.default?n.getAdId():n.adId;i.push(e)}).then(e).catch(e=>(0,l.default)(e))}))}return Promise.all(t).then(()=>(i.length&&this._log("Отфильтрованы объявления: "+i.join(", ")),r))}get slot(){return this.getOption("slot")}get slotId(){return this.getOption("slotId")}get length(){return this._items.length}_getItem(e){return this._init().then(()=>this._items[e])}_getAd(e=0){return n.default.info("_getAd",e),this._getItem(e).then(e=>{if(n.default.info("_getAd _getItem then",e),!e)return!1;let t=e.ad,r=e.uuid,i=t instanceof s.default,o=i?t.getAdId():t.adId,a=this._adSelector;if(!i){let s=t.video,n=t.controls,l=n&&n.items.adbutton,d=n&&n.items.adclickable;if(s&&s.src&&(s.src=a.replaceUrl(s.src,o,r),s.src=a.replaceUrl(s.src,o,r)),l&&l.href&&(l.href=a.replaceUrl(l.href,o,r)),d&&d.href&&(d.href=a.replaceUrl(d.href,o,r)),t.externalEvents){let e=t.externalEvents;for(let t in e){if(!e.hasOwnProperty(t))continue;let i=e[t];i instanceof Array||(e[t]=i=[i]);for(let e=0;e<i.length;e++)i[e]=a.replaceUrl(i[e],o,r)}}e.ad=t=a.createAd(t);let u=e=>{let i=this.getPlayer().getPlugin("backend"),s=null===i||void 0===i?void 0:i.getOption("ref");this._removeFromStorage(r,s),t.off("start error timeout",u)};t.on("start error timeout",u),i=!0}return t.blockIndex=a.blockIndex,t})}_getStorageKey(){return c}_getStorageMaxAge(){return h}_removeFromStorage(e,t,r=!1,i=!0){if(!i)return this._doRemovingFromStorage(e,t,r);const s=this.getPlayer().getStorage(),o=this._getStorageKey();return s.lockItem(o,1e4).then(()=>{let i=()=>s.unlockItem(o);return this._doRemovingFromStorage(e,t,r).then(e=>(i(),e),()=>(i(),Promise.reject()))}).catch(e=>{n.default.error(e)})}_doRemovingFromStorage(e,t,r=!1){const i=this.getPlayer(),s=i.getStorage(),o=this._getStorageKey();return s.getItem(o).then(a=>{a=a||[];let n=!1;const l=r?"Реклама удалена из хранилища, т.к. устарела":"Реклама удалена из хранилища";for(let s=a.length-1;s>=0;s--){var d;let o=a[s].uuid,u=null===(d=a[s])||void 0===d?void 0:d.ref;if(o===e&&(!u||u===t)){let e=a[s].ad,t=e.adId,o=e.campaign_id,d=e.adSlotId;this._log(l,t),i.trigger("adRemovedFromStorage",{adId:t,adCampaignId:o,adSlotId:this.slotId,adSlotIdSrc:d,outdated:r}),a.splice(s,1),n=!0}}return!!n&&s.setItem(o,a).then(()=>!0)})}_clearOldFromStorage(e=!0){if(!e)return this._doClearOldFromStorage();const t=this.getPlayer().getStorage(),r=this._getStorageKey();return t.lockItem(r,1e4).then(()=>{let e=()=>t.unlockItem(r);return this._doClearOldFromStorage().then(t=>(e(),t),()=>(e(),Promise.reject()))})}_doClearOldFromStorage(){const e=this.getPlayer(),t=e.getStorage(),r=this._getStorageKey();return t.getItem(r).then(i=>{i=i||[];const s=new Date-0,o=this._getStorageMaxAge();let a=!1;for(let t=i.length-1;t>=0;t--){const r=i[t],n=r.ad;if(s-r.dt>o){const r=n.adId,s=n.campaign_id,o=n.adSlotId;this._log("Реклама удалена из хранилища, т.к. устарела",r),e.trigger("adRemovedFromStorage",{adId:r,adCampaignId:s,adSlotId:this.slotId,adSlotIdSrc:o,outdated:!0}),i.splice(t,1),a=!0}}return!!a&&t.setItem(r,i).then(()=>!0)})}_saveToStorage(e){const t=this.getPlayer(),r=t.getStorage(),i=this._getStorageKey(),s=e.ad.adId,o=e.ad.campaign_id;return t.trigger("adTrySaveToStorage",{adId:s,adSlotId:this.slotId,adCampaignId:o}),r.lockItem(i).then(()=>r.getItem(i).then(a=>{if((a=a||[]).length||(a=[]),a.length>20&&a.splice(0,a.length-20),e.dt=new Date-0,e.ad&&void 0!==e.ad.controls){let t=e.ad.controls;"function"==typeof t.layout&&"string"==typeof t.layout._class_name&&(t.layout="[["+t.layout._class_name+"]]")}return a.push(e),r.setItem(i,a).then(()=>(t.trigger("adSavedToStorage",{adId:s,adSlotId:this.slotId,adCampaignId:o}),r.unlockItem(i).then(()=>{})))}))}selectAd(){let e=this._ad;if(n.default.info("block selectAd"),e)switch(e.loadState){case"destroy":case"error":return this.selectNextAd();default:switch(e.state){case o.PROVIDER_STATE.ERROR:return this.selectNextAd();default:return Promise.resolve(e)}}return this.selectNextAd()}_storageAvailable(){return this.getPlayer().getStorage().available}_multiLoadAllowed(){return!(this.length<=1)&&this._storageAvailable()}markAsSelected(e){if("number"==typeof e)delete this._notSelectedList[e];else{let t=this._notSelectedList;for(let r in t)if(t.hasOwnProperty(r)&&t[r]===e)return void delete this._notSelectedList[r]}}getNotSelectedAds(){let e=this._notSelectedList,t=[];for(let r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t}selectNextAd(){return n.default.info("block selectNextAd _init"),this._init().then(()=>{if(n.default.info("block selectNextAd _init then"),0===this.length)return n.default.info("block selectNextAd empty"),Promise.reject("Пустой блок");let e;return-1!==this._index&&(this._loadingJobs[this._index]=p,this._index=-1,this._ad=null),(e=this._multiLoadAllowed()?()=>(n.default.info("block selectNextAd _preLoad"),this._preLoad()):()=>(n.default.info("block selectNextAd _preLoadLinear"),this._preLoadLinear()))().then(e=>(n.default.info("block selectNextAd preLoad then"),this._getAd(e).then(t=>(this._ad=t,this._index=e,this.markAsSelected(e),t)))).catch(a.default.done())})}_preLoadLinear(){let e=0,t=()=>this._preLoadAd(e).then(()=>e).catch(r=>e===this.length?(e++,t()):Promise.reject("_preLoadLinear reject"));return t()}_preLoad(){this._currentLoadedAd=null;let e=this.length;const t=this._items.map(e=>e.ad instanceof s.default?e.ad.getAdId():e.ad.adId);this._log(`В блоке рекламных кампаний: ${e} (${t.join(", ")})`);for(let t=0;t<e;t++)this._preLoadAd(t);return this._preLoad=(()=>this._waitFirstSuccessLoad()),this._waitFirstSuccessLoad()}_preLoadAd(e){return this._loadingJobs[e]===p?Promise.reject():this._loadingJobs[e]?this._loadingJobs[e]:this._loadingJobs[e]=new Promise((t,r)=>{this._getAd(e).then(i=>{if(n.default.log(`Предзагрузка рекламы adId: ${i?i.getAdId():"noAd"} index: ${e}`),!i)return void r();this._adSelector.trigger("beforeAdPreloading",{ad:i});let s=i.getAdId();this._log("Попытка предварительной подгрузки",s),this._adSelector.stat.preLoadStart(s),i.getProvider().preLoadType===o.PROVIDER_PRELOAD_TYPE.DOM&&(this._adSelector.addChild(i),i.hide()),i.preLoad().then(()=>{if(this._log("Предварительная подгрузка выполнена успешно",s),this._adSelector.stat.preLoadStop(s,!0),!this._multiLoadAllowed())return this._notSelectedList[e]=i,void t(i);t(i)}).catch(e=>{this._log("Предварительная подгрузка выполнена с ошибкой",s,"error"),this._adSelector.stat.preLoadStop(s,!1),r(`Предварительная подгрузка выполнена с ошибкой, adId: ${s}`)})}).catch(a.default.done()).catch(()=>{r("reject: _getAd")})})}_waitFirstSuccessLoad(){if(this._viewedBlocks.includes(this))return Promise.reject("reject: _waitFirstSuccessLoad");this._viewedBlocks.push(this);let e=this._loadingJobs,t=[];for(let r=0;r<e.length;r++)t.push(r);function r(e){t.splice(t.indexOf(e),1)}return new Promise((i,o)=>{let a=[],u=[],c=e=>{this._getAd(e).then(t=>{this._currentLoadedAd=t,this._log("Выбрано рекламное объявление",t.getAdId()),i(e)}).catch(e=>{(0,l.default)(e)})},h=e=>{o(e),this._log("Не удалось загрузить ни одно из объявлений в блоке"),h=function(){}},_=()=>{g&&(clearTimeout(g),g=null);const e=d.default.getFirstAd();if(e){const t=e.getAdId();this._log("Закончили ожидать прогрузки других рекламных кампаний... Выбираем",t)}else n.default.log("WTF!!!");c(d.default.getFirstIndex())},g=null;for(let i=0;i<e.length;i++)(i=>{let o=e[i];o||(o=Promise.reject("reject: no job"));const l=e=>{const r=e.getAdId();if(a.push(i),n.default.log(`loaded ad index: ${i}, adId: ${r}`),this._currentLoadedAd)d.default.addLoaded(e,i),this._log("Сохраняем рекламу в кэш успешно загруженных реклам ["+d.default.getIds().join(", ")+"]",r);else if(i=i,0===t.indexOf(i))g&&(clearTimeout(g),g=null),this._log("Загрузилась первая реклама в блоке, выбираем её ["+d.default.getIds().join(", ")+"]",r),d.default.addLoaded(e,i),c(i);else if(d.default.addLoaded(e,i),this._log("Сохраняем рекламу в кэш успешно загруженных реклам ["+d.default.getIds().join(", ")+"]",r),1===a.length&&!g){const e=250;this._log(`Ожидание 0.${e} сек. на прогрузку других рекламных кампаний...`,r),g=setTimeout(_,e)}},f=t=>{u.push(i);const o=this._items[i]&&this._items[i].ad?this._items[i].ad:void 0,l=o?o instanceof s.default?o.getAdId():o.adId:void 0,c=o?this._items[i].index:void 0;n.default.warn(`rejected ad index: ${c}, adId: ${l}`),t instanceof Error&&this._log(`Ошибка при загрузке рекламы (${t.message})`,l),o&&c&&(o.getIsRtb()?this._log("RTB реклама, не надо сохранять в кэш отклоненных реклам",l):(d.default.addRejected(o,c),this._log("Сохраняем рекламу в кэш отклоненных реклам",l))),r(i);d.default;e.length===u.length?h():u.length+a.length===e.length&&null===this._currentLoadedAd&&_()};o===p?f():o.then(l).catch(f)})(i)});var i}_log(e,t,r){let i=this.getOption("index");t&&(e=`${e}, adId=${t}`),e=`${e}, block=${i}`,this.getPlayer().trigger("adSlotLog",{adId:t,slot:this.getOption("slot"),action:e,isError:"error"===r})}}_._class_name="AdvertBlock";var g=_;r.default=g},{"../../../../common/js/utils/ad-block-cache":230,"../../../../player/core/console":280,"../../../../player/providers/default":317,"../../../../player/utils/catchHandler":327,"./../../../../player/core/base-object":277,"./../../../../player/utils/error":329,"./media-container":173,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/es6.string.includes":107,"core-js/modules/es7.array.includes":111,"core-js/modules/web.dom.iterable":115}],124:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../../../../player/controls/AbstractLayout");class s extends i.AbstractLayout{_toString(e){return`\n<div class="${e}-controls-region-bottom ${e}-remove-when-empty ${e}-toolbar" data-layout-name="advert-layout"> \n    <div class="${e}-fullscreen-control ${e}-btn ${e}-control"></div>\n    <div class="${e}-sound-wrapper">\n        <div class="${e}-mute-control ${e}-btn ${e}-control"></div> \n        <div class="${e}-volume-control ${e}-control" data-hint="" data-hint-move="">\n            <div class="${e}-volume-wrapper">\n                <div class="${e}-volume">\n                    <div class="${e}-volume-drag"></div>\n                </div>\n                <div class="${e}-volume-back"></div>\n            </div>\n        </div>\n    </div>\n    <div class="${e}-progress-control ${e}-control">\n        <div class="${e}-progress-wrapper">\n            <div class="${e}-progress">\n                <div class="${e}-progress-drag"></div>\n            </div>\n            <div class="${e}-progress-loaded"></div>\n            <div class="${e}-progress-back"></div>\n        </div>\n    </div>\n    <div class="${e}-advert-countdown-control ${e}-control"></div>\n</div>\n<div class="${e}-wantplay-control ${e}-control">\n    <div class="${e}-wantplay-control-text"></div>\n</div>\n<div class="${e}-wantunmute-control ${e}-hidden ${e}-control">\n    <div class="${e}-wantunmute-control-icon"></div>\n</div>\n<div class="${e}-advert-clickable-control ${e}-control ${e}-btn"></div>\n<div class="${e}-screenplay-control ${e}-btn ${e}-control ${e}-state-pause"></div>\n<div class="${e}-advert-resume-control ${e}-btn ${e}-control"></div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__top-left ${e}-clearfix">\n    <div class="${e}-advert-expand-control ${e}-btn ${e}-control"></div>\n    <a class="${e}-advert-button-control ${e}-btn ${e}-control" target="_blank"></a>\n</div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__top-center ${e}-clearfix">\n    <div class="${e}-advert-info-control ${e}-btn ${e}-control"></div>\n</div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__top-right ${e}-clearfix">\n    <div class="${e}-advert-close-control ${e}-btn ${e}-control"></div>\n</div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__middle-left ${e}-clearfix"></div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__middle-right ${e}-clearfix">\n    <div class="${e}-advert-phone-control ${e}-control"></div>\n</div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__bottom-left ${e}-clearfix"></div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__bottom-center ${e}-clearfix"></div>\n<div class="${e}-advert-placeholder ${e}-advert-placeholder__bottom-right ${e}-clearfix">\n    <div class="${e}-advert-skip-control ${e}-btn ${e}-control"></div>\n</div>\n`}}s._class_name="AdvertLayout";var o=s;r.default=o},{"../../../../player/controls/AbstractLayout":254}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=d(e("./advert-selector")),s=e("./lib/slots"),o=d(e("../../../../common/js/utils/ad-block-cache")),a=d(e("../../../../player/utils/catchHandler")),n=(d(e("./media-container")),d(e("../../../../player/utils/pixels"))),l=e("../../../../player/providers/default");d(e("../../../../player/core/console"));function d(e){return e&&e.__esModule?e:{default:e}}const u=new Error("final_empty");var c=class extends i.default{constructor(e,t){super(e,t),this._mcList=[],this._currentLoadedAd=null,this._loadNextAdInBackground=!0}get loadNextAdInBackground(){return this._loadNextAdInBackground}set loadNextAdInBackground(e){this._loadNextAdInBackground=!!e}get currentLoadedAd(){return this._currentLoadedAd}resetState(e=null,t=!1){this._log(`Сбрасываем состояние advert selector'а (${e})`),t&&this._next(),this.state=s.POS_STATE.IDLE;try{!1!==this._mc&&delete this._listenAds[this._mc.getAdId()]}catch(e){this.destroy()}return this._startPromise=void 0,this._destroyAdJob=void 0,this._currentLoadedAd&&(o.default.removeAd(this._currentLoadedAd),this._log("Удаляем текеущую рекламу из кэша успешно загруженных реклам",this._currentLoadedAd.getAdId())),this._to&&(clearTimeout(this._to),this._to=!1),this._destroyAd()}_destroyAd(){return this._mc?this._destroyAdJob?this._destroyAdJob:(this._destroyAdJob=new Promise(e=>{this._mc.once("destroy",e),setTimeout(e,1e3)}),this._destroyAdJob.then(()=>{this._mc=!1}).catch(e=>{(0,a.default)(e)}),this._mc.destroy(),this.fixMcList(),this._mc=!1,this._destroyAdJob):Promise.resolve()}_prepareMediaContainer(e){let t=e.getAdId(),r=e.getAdSlotId(),i=0,a=!1,n=!1;this._currentLoadedAd=null;let d=()=>{this._stat.tryPlayingStop(t,!0),this._stat.stop(!0),this.sendStat(),this.trigger("adStartedSuccess",{ad:e}),d=function(){}},u=()=>{i=new Date,n||setTimeout(()=>{a||d()},200),this._adManager.markAsShowedAd(e,r),this._log("Старт рекламы",t),this._viewMode=e.viewMode,this.getEl().nsAddClass("advert-position-vm",this._viewMode),this.trigger("start",{mediaContainer:e}),this.state=s.POS_STATE.PLAY,this._currentLoadedAd&&(o.default.removeAd(this._currentLoadedAd),this._log("Удаляем текеущую рекламу из кэша успешно загруженных реклам",this._currentLoadedAd.getAdId())),this._currentLoadedAd=null,this.loadNextAdInBackground&&setTimeout(()=>{this._selectAd(!0,!0).then(e=>{}).catch(e=>{})},1e3)};this._listenAds.hasOwnProperty(t)||(this.listenTo(e,{adPayed:()=>{this._log('<span class="green mute">ad event adPayed</span>',t),this.trigger("adPayed"),this._updateAdvertPlayCount(e)},"timeout error":e=>{this._log('<span class="green mute">ad event timeout | error</span>',t),this._stat.tryPlayingStop(t,!1)},"click customClick":()=>{this._log('<span class="green mute">ad event click | customClick</span>',t)},needShow:()=>{this._log('<span class="green mute">ad event needShow</span>',t),this.getEl().removeClass(this.CLASS_WAITING),this.getEl().addClass(this.CLASS_STARTED)},wantplay:()=>{this._log('<span class="green mute">ad event wantplay</span>',t),n=!0,this.trigger("wantplay"),d()},start:()=>{this._log('<span class="green mute">ad event start</span>',t),u()},"close skip":()=>{this._log('<span class="green mute">ad event close | skip</span>',t),this.trigger("close")},state:e=>{switch(this._log('<span class="green mute">ad event state = '+e.state+"</span>",t),e.state){case"play":this.state=s.POS_STATE.PLAY;break;case"pause":this.state=s.POS_STATE.PAUSE;break;case"end":this.state=s.POS_STATE.END,this.trigger("finish"),this.resetState("state end");break;case"close":this.state=s.POS_STATE.CLOSE,this.trigger("close"),this.resetState("state close");break;case"waiting":this.state=s.POS_STATE.WAITING,this.trigger("waiting")}},viewmodechange:()=>{this._log('<span class="green mute">ad event viewmodechange</span>',t),this.getEl().nsRemoveClass("advert-position-vm",this._viewMode).nsAddClass("advert-position-vm",e.viewMode),this._viewMode=e.viewMode},error:()=>{this._log('<span class="green mute">ad event error</span>',t),a=!0,this._log("Ошибка при воспроизведении рекламы",t,"error"),this._log("Попытка запустить следующую рекламу"),e.destroy(),this._onPlayAdFail()},timeupdate:e=>{this.trigger(e)}}),this._listenAds[t]=t,e.state===l.PROVIDER_STATE.PLAY&&u());let c=e.getOption("volume");this._revertVolume=!1,void 0!==c&&c<this.getPlayer().volume&&c>=0&&(this._revertVolume=!0,this.volumeControl.setVolume(c,`ad:${r}-${t}`,!0,this)),this.volumeControl.once("volumeChange",e=>{"ad"===e.type&&(this._revertVolume=!1)})}load(e=!1,t=!1){return this._log('<b class="green">Попытка загрузки рекламы...</b> (next: '+(e?"true":"false")+")"),this.state===s.POS_STATE.TIMEOUT?(this._log("Попытка загрузки рекламы прервана, т.к. превышен глобальный таймаут"),Promise.reject("reject: превышен глобальный таймаут")):!e&&this._currentLoadedAd?Promise.resolve(this._currentLoadedAd):(t||(this._startLoading(),this._currentLoadedAd=null),this._selectAd(e).catch(()=>(this.trigger("error",{fatal:!0}),this.destroy(),Promise.reject(u))).then(e=>(this._mcList.push(e),this._loadAd(e))).then(e=>(t||(this._stopLoading(),this._currentLoadedAd=e),e)).catch(e=>{if(t||this._stopLoading(),e===u||this.state===s.POS_STATE.TIMEOUT)throw u;return this.load(!0,t)}))}_loadAd(e){if(this.state===s.POS_STATE.TIMEOUT)return this._log("Попытка загрузки рекламы прервана, т.к. превышен глобальный таймаут"),Promise.reject();if(!e)return this.trigger("empty"),Promise.reject();this.fixMcList(),this._mc=this._mcList[0];let t=e.getAdId();return this._stat.tryCount++,(0,n.default)(e.getOption("before_pixel")).then(()=>(this._adManager.markAsSelectedAd(t,this.slotId),this._loadMediaContainer(e))).then(()=>this.state===s.POS_STATE.TIMEOUT?(this._log("Реклама пропущена, т.к превышен таймаут",t),Promise.reject()):(this._log("Загрузка выполнена успешно",t),e))}fixMcList(){this._mcList=this._mcList.filter(e=>!e.destroyed&&e.state!==l.PROVIDER_STATE.ERROR)}};r.default=c},{"../../../../common/js/utils/ad-block-cache":230,"../../../../player/core/console":280,"../../../../player/providers/default":317,"../../../../player/utils/catchHandler":327,"../../../../player/utils/pixels":333,"./advert-selector":129,"./lib/slots":151,"./media-container":173,"core-js/modules/es6.promise":97}],126:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./advert-selector"))&&i.__esModule?i:{default:i};var o=class extends s.default{_startLoading(){}_stopLoading(){}};r.default=o},{"./advert-selector":129}],127:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator");var i=a(e("./../../../../player/core/base-object")),s=a(e("./../../../../player/utils/profiler")),o=e("./../../../../player/utils/extend");function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{constructor(e,t={}){super(e,t),this._data={success:!1,count:0,tryCount:0,timeout:0,minPreLoadTimeout:0,maxPreLoadTimeout:0,avgPreLoadTimeout:0,minPreLoadTimeoutValue:0,maxPreLoadTimeoutValue:0,avgPreLoadTimeoutValue:0,minLoadTimeout:0,maxLoadTimeout:0,avgLoadTimeout:0,minLoadTimeoutValue:0,maxLoadTimeoutValue:0,avgLoadTimeoutValue:0,minPlayTimeout:0,maxPlayTimeout:0,avgPlayTimeout:0,minPlayTimeoutValue:0,maxPlayTimeoutValue:0,avgPlayTimeoutValue:0,globalTimeout:!1,log:{},filtered:{}}}getAdLog(e){return this._data.log[e]||(this._data.log[e]={}),this._data.log[e]}start(){s.default.start("slot")}stop(e=!1){this._data.timeout=s.default.stop("slot"),e&&(this._data.success=e)}preLoadStart(e){s.default.start(`adPreLoad[${e}]`)}preLoadStop(e,t){this.getAdLog(e).preLoad=s.default.stop(`adPreLoad[${e}]`),this.getAdLog(e).preLoadSuccess=t}loadStart(e){s.default.start(`adLoad[${e}]`)}loadStop(e,t){this.getAdLog(e).load=s.default.stop(`adLoad[${e}]`),this.getAdLog(e).loadSuccess=t}tryPlayingStart(e){s.default.start(`adTryPlaying[${e}]`)}tryPlayingStop(e,t){this.getAdLog(e).tryPlaying=s.default.stop(`adTryPlaying[${e}]`),this.getAdLog(e).tryPlayingSuccess=t}set tryCount(e){this._data.tryCount=e}get tryCount(){return this._data.tryCount}set count(e){this._data.count=e}get count(){return this._data.count}set filtered(e){this._data.filtered=e}get globalTimeout(){return this._data.globalTimeout}set globalTimeout(e){this._data.globalTimeout=e}get globalTimeoutAdId(){return this._data.globalTimeoutAdId}set globalTimeoutAdId(e){this._data.globalTimeoutAdId=e}get globalTimeoutAdCID(){return this._data.globalTimeoutAdCID}set globalTimeoutAdCID(e){this._data.globalTimeoutAdCID=e}get filtered(){return this._data.filtered}get data(){return this._updateStat(),(0,o.clone)(this._data)}_updateStat(){let e=this._getStat("load"),t=this._getStat("preLoad"),r=this._getStat("tryPlaying"),i=this._data;i.minPreLoadTimeout=t.min,i.maxPreLoadTimeout=t.max,i.avgPreLoadTimeout=t.avg,i.minPreLoadTimeoutValue=t.values.min,i.maxPreLoadTimeoutValue=t.values.max,i.avgPreLoadTimeoutValue=t.values.avg,i.minLoadTimeout=e.min,i.maxLoadTimeout=e.max,i.avgLoadTimeout=e.avg,i.minLoadTimeoutValue=e.values.min,i.maxLoadTimeoutValue=e.values.max,i.avgLoadTimeoutValue=e.values.avg,i.minPlayTimeout=r.min,i.maxPlayTimeout=r.max,i.avgPlayTimeout=r.avg,i.minPlayTimeoutValue=r.values.min,i.maxPlayTimeoutValue=r.values.max,i.avgPlayTimeoutValue=r.values.avg}_getStat(e){let t=this._data.log,r=0,i=0,s=0,o=0;for(let a in t)if(t.hasOwnProperty(a)&&t[a].hasOwnProperty(e)){let n=t[a][e];n>i&&(i=n),(n<r||0===r)&&(r=n),s+=n,o++}return{min:this._getTimeoutValue(r),max:this._getTimeoutValue(i),avg:this._getTimeoutValue(o>0?s/o:0),values:{min:(100*r>>0)/100,max:(100*i>>0)/100,avg:(100*(o>0?s/o:0)>>0)/100}}}_getTimeoutValue(e){return e<1?"<1":e<2?"1-2":e<5?"2-5":e<8?"5-8":">8"}};r.default=n},{"./../../../../player/core/base-object":277,"./../../../../player/utils/extend":330,"./../../../../player/utils/profiler":334,"core-js/modules/es6.array.iterator":93,"core-js/modules/web.dom.iterable":115}],128:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./advert-selector-immortal"))&&i.__esModule?i:{default:i};var o=class extends s.default{_startAdvert(e){e.getOption("backPreload")?e.trigger("wantplay"):e.play()}get slot(){let e=this.getOption("player");return e?e.slot:this.getOption("slot")}get slotId(){let e=this.getOption("player");return e?e.slotId:this.getOption("slotId")}_prepareMediaContainer(e){super._prepareMediaContainer(e),this.trigger("adPrepareSuccess",{ad:e})}};r.default=o},{"./advert-selector-immortal":125}],129:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace");var i=A(e("./../../../../player/core/component")),s=e("../../../../player/providers/default"),o=A(e("./../../../../player/core/event")),a=A(e("./media-container")),n=A(e("./../../../../player/utils/pixels")),l=e("./lib/slots"),d=A(e("./url/url")),u=A(e("./advert-block")),c=A(e("../../../../common/js/utils/ad-block-cache")),h=A(e("./advert-selector-stat")),p=A(e("../vast/providers/vast")),_=A(e("./provider/html5")),g=A(e("./../../../../player/core/console")),f=A(e("../../../../player/utils/catchHandler")),m=e("./helpers");function A(e){return e&&e.__esModule?e:{default:e}}function v(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function y(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){v(o,i,s,a,n,"next",e)}function n(e){v(o,i,s,a,n,"throw",e)}a(void 0)})}}const b=new Error("final_empty");class P extends i.default{constructor(e,t){let r=e.getPlayer();super(r,t),this.VAST_INVENTORY_SENDING_PERCENTAGE=1,this.isSendInventory=this.isSendInventori(),this._adManager=e,this._currentBlockIndex=-1,this.state=l.POS_STATE.IDLE,this._mc=!1,this._to=!1,this._revertVolume=!1,this._viewMode="",this._logDisabled=!1,this._listenAds={},this._blockIndex=0;let i=this.getNs(),s=this.getEl();this.CLASS_WAITING=`${i}-advert-position__waiting`,this.CLASS_STARTED=`${i}-advert-position__started`,s.nsAddClass("advert-position",this.slot);let o=e.getOption("wantPlayPosition");o&&s.nsAddClass(`advert-position__wantPlay-${o.replace(" ","-")}`),this._stat=new h.default(r),this.volumeControl=r.volumeControl}get stat(){return this._stat}get slot(){return this.getOption("slot")}get slotId(){return this.getOption("slotId")}get blockIndex(){return this._blockIndex}set blockIndex(e){this._blockIndex=e}createAd(e){return new a.default(this.getPlayer(),e)}sendStat(){let e=this.getPlayer(),t=this._stat,r=this.slot,i=this.slotId;setTimeout(()=>{e.trigger("adSlotStat",{data:t.data,slot:r,slotId:i})},0),this.sendStat=function(){}}destroy(){let e=this.blocks;this._stat.stop(),this.sendStat(),this._stopLoading(!0);for(let t=0;t<e.length;t++){let r=e[t];r instanceof u.default&&r.destroy()}this.getEl().css({visibility:"hidden",position:"absolute",top:0,left:0,width:"10px",height:"10px",zIndex:-1e3,overflow:"hidden"}),this._to&&(clearTimeout(this._to),this._to=!1),!1!==this._revertVolume&&this.getPlayer().volumeControl.setVolume(this._revertVolume,"ad",!0,this);let t=!!this._mc&&this._mc.doNotRemoveAfterDestroy();this._destroyAd().then(()=>{t?(this.trigger("destroy"),setTimeout(()=>{this.stopListening().off()},0)):super.destroy()}).catch(e=>(0,f.default)(e)),this.destroy=function(){}}_destroyAd(){return this._mc?this._destroyAdJob?this._destroyAdJob:(this._destroyAdJob=new Promise(e=>{this._mc.once("destroy",e),setTimeout(e,1e3)}),this._destroyAdJob.then(()=>{this._mc=!1}).catch(e=>(0,f.default)(e)),this._mc.destroy(),this._destroyAdJob):Promise.resolve()}buildCSSClass(){let e=this.getNs();return`${e}-layer ${e}-advert-position ${e}-loader ${super.buildCSSClass()}`}replaceUrl(e,t,r){let i,s=this._adManager.getOption("variables",[]),o=this.getPlayer(),a=window.location;i={page:a,host:a.host,width:o.width,height:o.height,title:"",adid:t,ads_id:t,ad_slot:this.slot,ad_slot_id:this.slotId,click_id:t+"."+(s&&s.reqid?s.reqid:"none"),timestamp:Math.round(new Date/1e3),fullscreen:+o.fullScreen,ad_uid:r};for(let e in s)s.hasOwnProperty(e)&&(i[e]=s[e]);return d.default.replace(e,i,o)}_reset(){this._currentBlockIndex=-1}_next(){this._currentBlockIndex++}_getCurrentBlock(){let e=this._currentBlockIndex+1,t=this.blocks[e];return!!t&&(t instanceof u.default||(t=this.blocks[e]=new u.default(this,{items:t,slot:this.slot,slotId:this.slotId,index:e})),t)}_selectAd(e=!1,t=!1){var r=this;return y(function*(){if(r._log('<span class="blue">Загружаем следующую рекламу...</span> ('+(r._currentBlockIndex+1)+")"),r._log(`В кеше успешно загруженных реклам - ${c.default.count()}`),c.default.count()>0){const e=c.default.getFirstAd();return t?r._log("Следующая реклама из кеша успешных реклам",e.getAdId()):(r._log("Извлекаем первую рекламу из кеша успешных реклам и выбираем ее",e.getAdId()),c.default.removeAd(e)),e}let i=r._getCurrentBlock();if(!i)return Promise.reject();r._log("Текущий блок "+(r._currentBlockIndex+1)),r._stat.tryCount++;try{const s=yield e?i.selectNextAd():i.selectAd();return t?r._log("Следующая реклама",s.getAdId()):(s.selectedForShow(),r.trigger("adSelected",{ad:s}),c.default.removeAd(s),r._log("Удаляем рекламу из кэша успешно загруженных реклам",s.getAdId())),s}catch(e){return r._log("Не удалось загрузить рекламу в этом блоке, пробуем еще раз..."),e&&g.default.log("advert-selector catch ",e),r._next(),r._selectAd(!1,t)}})()}_getCountMomentKey(e){return`ad.countMoment[${e}][${this.getPlayer().getPlugin("backend").getOption("ref")}]`}allowPlayingAdvert(e){var t=this;return y(function*(){const r=e instanceof a.default?e.getAdId():e.adId;try{return yield(0,m.allowPlayingAdvert)(e,t.slot,t.getPlayer(),t._adManager,t.getOptions()),!0}catch(e){return t._stat.filtered[r]=e,!1}})()}_updateAdvertPlayCount(e){let t=this.getPlayer().getStorage(),r=e.getAdId(),i=e.getOption("limits");if(!i||!i.count)return;let s=`ad.count[${r}]`;t.getItem(s).then(e=>{e?t.setItem(s,e+1):t.setItem({key:s,value:1,expire:1e3*(i.expire||86400)})}).catch(e=>(0,f.default)(e));let o=this._getCountMomentKey(r);t.getItem(o).then(e=>{e?t.setItem(o,e+1):t.setItem({key:o,value:1,expire:1e4})}).catch(e=>(0,f.default)(e))}_prepareMediaContainer(e){let t=e.getAdId(),r=e.getAdSlotId(),i=0,o=!1,a=!1,n=()=>{this._stat.tryPlayingStop(t,!0),this._stat.stop(!0),this.sendStat(),this.trigger("adStartedSuccess",{ad:e}),n=function(){}},d=()=>{i=new Date,a||setTimeout(()=>{o||n()},200),this._adManager.markAsShowedAd(e,r),this._log("Старт рекламы",t),this._viewMode=e.viewMode,this.getEl().nsAddClass("advert-position-vm",this._viewMode),this.trigger("start",{mediaContainer:e}),this.state=l.POS_STATE.PLAY,d=function(){}};this._listenAds.hasOwnProperty(t)||(this.listenTo(e,{adPayed:()=>{this._log('<span class="green mute">ad event adPayed</span>',t),this._updateAdvertPlayCount(e)},"timeout error":()=>{this._log('<span class="green mute">ad event timeout | error</span>',t),this._stat.tryPlayingStop(t,!1)},"click customClick":()=>{this._log('<span class="green mute">ad event click | customClick</span>',t),this._adManager.getOption("clickClose")&&(this.trigger("close"),this.destroy())},needShow:()=>{this._log('<span class="green mute">ad event needShow</span>',t),this.getEl().removeClass(this.CLASS_WAITING),this.getEl().addClass(this.CLASS_STARTED)},wantplay:()=>{this._log('<span class="green mute">ad event wantplay</span>',t),a=!0,this.trigger("wantplay"),n()},start:()=>{this._log('<span class="green mute">ad event start</span>',t),d()},"close skip":()=>{this._log('<span class="green mute">ad event close | skip</span>',t),this.trigger("close"),this.destroy()},state:e=>{switch(this._log('<span class="green mute">ad event state = '+e.state+"</span>",t),"end"===e.state&&(this.trigger("finish"),this.destroy()),"close"===e.state&&(this.trigger("close"),this.destroy()),"waiting"===e.state&&this.trigger("waiting"),e.state){case"play":this.state=l.POS_STATE.PLAY;break;case"pause":this.state=l.POS_STATE.PAUSE;break;case"end":this.state=l.POS_STATE.END;break;case"close":this.state=l.POS_STATE.CLOSE;break;case"waiting":this.state=l.POS_STATE.WAITING}},viewmodechange:()=>{this._log('<span class="green mute">ad event viewmodechange</span>',t),this.getEl().nsRemoveClass("advert-position-vm",this._viewMode).nsAddClass("advert-position-vm",e.viewMode),this._viewMode=e.viewMode},error:()=>{this._log('<span class="green mute">ad event error</span>',t),o=!0,this._log("Ошибка при воспроизведении рекламы",t,"error"),0===i||!a&&new Date-i<200?(this._log("Попытка запустить следующую рекламу"),e.destroy(),this._onPlayAdFail()):(this.trigger("error"),this.destroy())},timeupdate:e=>{this.trigger(e)}}),this._listenAds[t]=t,e.state===s.PROVIDER_STATE.PLAY&&d());let u=e.getOption("volume");this._revertVolume=!1,void 0!==u&&u<this.getPlayer().volume&&u>=0&&(this._revertVolume=!0,this.volumeControl.setVolume(u,`ad:${r}-${t}`,!0,this)),this.volumeControl.once("volumeChange",e=>{"ad"===e.type&&(this._revertVolume=!1)})}_onPlayAdFail(){this._loadAndPlayNextAd(!0)}_onPlayAdTimeout(){setTimeout(()=>{this._loadAndPlayNextAd(!0)},0)}_prepareMedia(e,t){this._log("Подготовка контейнера рекламы",e.getAdId()),e.setOption("timeout",t);let r=e.getAdId();this._stat.tryPlayingStart(r),this._prepareMediaContainer(e)}_startMedia(e,t){this._prepareMedia(e,t),this._startAdvert(e)}_startAdvert(e){this._log("Попытка старта рекламы",e.getAdId()),this.getPlayer().trigger("adTryToPlay",{adId:e.getAdId(),adSlotId:e.getOption("adSlotId")}),e.play()}_loadMediaContainer(e,t=0){e.getProvider().preLoadType===s.PROVIDER_PRELOAD_TYPE.DOM?e.show():this.addChild(e);let r=e.getAdId();return this._log("Загрузка рекламы",r),new Promise((i,s)=>{this._stat.loadStart(r),e.load(t).then(()=>{this._stat.loadStop(r,!0),i(e)}).catch(t=>{this._stat.loadStop(r,!1),this._log("Ошибка при загрузке рекламы",r,"error"),t instanceof o.default||this.getPlayer().triggerError(0,"JS Error",{originalEvent:t}),e.destroy(),s(t)})})}_startLoading(){this.getPlayer().loading.start(`advert-selector-${this.id}`)}_stopLoading(e=!1){this.getPlayer().loading.end(`advert-selector-${this.id}`,e)}load(e=!1){if(this._log('<b class="green">Попытка загрузки рекламы...</b> (next: '+(e?"true":"false")+")"),this.state===l.POS_STATE.TIMEOUT)return this._log("Попытка загрузки рекламы прервана, т.к. превышен глобальный таймаут"),Promise.reject();if(!e&&this._currentLoadedAd)return Promise.resolve(this._currentLoadedAd);return this._startLoading(),this._currentLoadedAd=null,this._selectAd(e).catch(()=>(this.trigger("error"),this.destroy(),Promise.reject(b))).then(e=>this._loadAd(e)).then(e=>(this._stopLoading(),this._currentLoadedAd=e,e)).catch(e=>{if(this._stopLoading(),e===b)throw b;return this.load(!0)})}_loadAd(e){if(this.state===l.POS_STATE.TIMEOUT)return this._log("Попытка загрузки рекламы прервана, т.к. превышен глобальный таймаут"),Promise.reject();if(!e)return this.trigger("empty"),Promise.reject();this._mc=e;let t=e.getAdId();return this._stat.tryCount++,(0,n.default)(e.getOption("before_pixel")).then(()=>(this._adManager.markAsSelectedAd(t,this.slotId),this._loadMediaContainer(e))).then(()=>this.state===l.POS_STATE.TIMEOUT?(this._log("Реклама пропущена, т.к превышен таймаут",t),Promise.reject()):(this._log("Загрузка выполнена успешно",t),e))}_loadAndPlayNextAd(e=!1){return this.load(e).then(e=>{let t=1e3*e.getOption("adLoadTimeout",5);this._startMedia(e,t)}).catch(e=>{this._log("Не удалось загрузить рекламу",!1,"error")})}_loadAndPrepareNextAd(e=!1){return this._log("_loadAndPrepareNextAd -> run load again"),this.load(e).then(e=>{let t=1e3*e.getOption("adLoadTimeout",5);this._prepareMedia(e,t)}).catch(e=>{this._log("Не удалось загрузить рекламу",!1,"error")})}_loadAndPlayAd(e){this._loadAd(e).then(e=>{let t=1e3*e.getOption("adLoadTimeout",5);this._startMedia(e,t)}).catch(e=>{this._log("Не удалось загрузить рекламу",!1,"error")})}_loadAndPrepareAd(e){this._loadAd(e).then(e=>{let t=1e3*e.getOption("adLoadTimeout",5);this._prepareMedia(e,t)}).catch(e=>{this._log("Не удалось загрузить рекламу",!1,"error")})}startCurrent(){if(!this._mc)return!1;let e=1e3*this._mc.getOption("adLoadTimeout",5);this._startMedia(this._mc,e)}startCurrentAdvert(){return!!this._mc&&(this._startAdvert(this._mc),!0)}get currentAd(){return this._mc}isSendInventori(){return Math.floor(101*Math.random())<this.VAST_INVENTORY_SENDING_PERCENTAGE}sendInventory(){this.isSendInventory&&this.getPlayer().trigger("inventory",{slot:this.slot})}start(e=!0){if(this._startPromise)return this._startPromise;let t;return this._stat.count=this.adCount,this._stat.start(),this._startPromise=new Promise((e,r)=>{this.once("adStartedSuccess",r=>{let i=r.ad;e(i),this._log('<span class="green">Реклама успешно стартовала</span>',i.getAdId()),this._to&&(clearTimeout(this._to),this._to=!1),t&&(this._log("Реклама успела стартовать, глобальный таймаут отменен"),t=function(){})}),this.once("adPrepareSuccess",r=>{let i=r.ad;e(i),this._log("Реклама успешно подготовлена",i.getAdId()),this._to&&(clearTimeout(this._to),this._to=!1),t&&(this._log("Реклама успела подготовленна, глобальный таймаут отменен"),t=function(){})}),this.once("globalTimeout empty error",e=>{r(e),this._stat.stop(),this.sendStat()})}),this.getEl().addClass(this.CLASS_WAITING),this.state=l.POS_STATE.WAITING,this._to=setTimeout(()=>{this._to=!1;let r=this._mc;t=(r=>{let i=this._getCurrentBlock();if(i){let t=i.getNotSelectedAds();for(let r=0;r<t.length;r++){let s=t[r],o=s.getProvider();if(o instanceof p.default){let t=o.findProviderClass();if(t&&t.Provider===_.default)return i.markAsSelected(s),void(e?this._loadAndPlayAd(s):this._loadAndPrepareAd(s))}}}this.state=l.POS_STATE.TIMEOUT,this.trigger("globalTimeout"),this.getPlayer().trigger("AdStartGlobalTimeout",{slot:this.slot}),this._stat.globalTimeout=!0,this._stat.globalTimeoutAdId=r?r.getAdId():0,this._stat.globalTimeoutAdCID=r?r.getCampaignId():0,this.destroy(),t=function(){}}),r?(this.listenTo(r,"empty timeout error",()=>{t(r)}),this._log("Глобальный таймаут: даём рекламе ещё 2 с. на старт",r.getAdId()),r.forceTimeout(2e3),setTimeout(()=>{t(r)},2500)):t()},this.getOption("timeout")),e?this._loadAndPlayNextAd():this._loadAndPrepareNextAd(),this._startPromise}_log(e,t,r){this._logDisabled||(t&&(e=`${e}, adId=${t}`),this.getPlayer().trigger("adSlotLog",{adId:t,slot:this.slot,action:e,isError:"error"===r}))}_preloadNextAd(){return new Promise((e,t)=>{this.state===l.POS_STATE.LOADING?this._selectAd(!0).then(r=>{r.preLoad().then(()=>(this.state=l.POS_STATE.READY,r)).catch(e=>this._preloadNextAd()).then(()=>e()).catch(e=>t("reject: _preloadNextAd"))}).catch(()=>{t(),this._log("Предварительная подгрузка не удалась, т.к. не осталось подходящей рекламы",0,"error")}):e()})}preLoad(){return new Promise((e,t)=>{this.state===l.POS_STATE.IDLE&&(this.state=l.POS_STATE.LOADING,this._preloadNextAd().then(t=>e(t)).catch(e=>t("reject: preLoad")))})}set state(e){this._state!==e&&(this._state=e,this.trigger("state",{state:e}))}_restoreAdsSupported(){return!0}get blocks(){return this._blocks?this._blocks:this._blocks=this.getOption("items")}hide(){this.getEl().nsAddClass("advert-position","hidden")}show(){this.getEl().nsRemoveClass("advert-position","hidden")}get state(){return this._state}get empty(){return 0===this.blocks.length}get adCount(){let e=this.blocks,t=0;for(let r=0;r<e.length;r++)t+=e[r].length;return t}}P.prototype._options={timeout:1e4,concurrency:1};var T=P;r.default=T},{"../../../../common/js/utils/ad-block-cache":230,"../../../../player/providers/default":317,"../../../../player/utils/catchHandler":327,"../vast/providers/vast":223,"./../../../../player/core/component":279,"./../../../../player/core/console":280,"./../../../../player/core/event":282,"./../../../../player/utils/pixels":333,"./advert-block":123,"./advert-selector-stat":127,"./helpers":144,"./lib/slots":151,"./media-container":173,"./provider/html5":178,"./url/url":203,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],130:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./adcontrol"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"adbutton"}constructor(e,t,r){if(super(e,t,r),this.hide(),this.getOption("href")){this.listenTo(e,"state",e=>{"play"===e.state&&this.show()});let t=this.getOption("text"),r=this.getOption("href"),i=this.getEl();t?(i.html(t),i.attr("href",r)):i.remove()}this.listenTo(this.getEl(),"click",()=>{this.getProvider().pause(),this.getProvider().getMediaContainer().trigger("customClick")})}buildCSSClass(){let e=this.getNs();return`${e}-advert-button-control ${e}-btn ${super.buildCSSClass()}`}};r.default=o},{"./adcontrol":133}],131:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./../../../../../player/controls/default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"adclickable"}constructor(e,t,r){super(e,t,r),this.hide(),this.getOption("href")&&(this.listenTo(this.getEl(),"click",()=>{this.hide(),this.getProvider().getMediaContainer().adClickThru({playerHandles:!0,url:this.getOption("href")})}),this.listenTo(e,"state",e=>{"play"===e.state&&this.show()}))}buildCSSClass(){let e=this.getNs();return`${e}-advert-clickable-control ${e}-control ${e}-btn ${super.buildCSSClass()}`}};r.default=o},{"./../../../../../player/controls/default":257}],132:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../../../../../player/controls/default")),s=o(e("./../../../../../player/utils/time"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"adclose"}constructor(e,t,r){super(e,t,r),this.hide(),this._time=0,this.listenTo(this.getEl(),"click",()=>{this.getProvider().getMediaContainer().trigger("close",{closeTime:e.currentTime})}),this.listenTo(e,{start:this._onStart,timeupdate:this._onTick})}_onStart(){let e=this.getOption("time");"string"==typeof e&&(e.indexOf(":")>-1?e=s.default.fromString(e):e.indexOf("%")>-1&&(e=parseInt(this.getProvider().duration*parseInt(e)/100))),this._time=e}_onTick(){this.getProvider().currentTime>this._time&&this._time>0&&this.show()}buildCSSClass(){let e=this.getNs();return`${e}-advert-close-control ${e}-btn ${super.buildCSSClass()}`}}a.prototype._options={time:1e3};var n=a;r.default=n},{"./../../../../../player/controls/default":257,"./../../../../../player/utils/time":335}],133:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace");var i,s=(i=e("./../../../../../player/controls/default"))&&i.__esModule?i:{default:i};var o=class extends s.default{_setPosition(e){let t=this.getOption("position");if(t){let r=e.nsFind("advert-placeholder",t.replace(" ","-"));r.length>0&&r.append(this.getEl())}}createEl(e){super.createEl(e),this._setPosition(e)}};r.default=o},{"./../../../../../player/controls/default":257,"core-js/modules/es6.regexp.replace":102}],134:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.to-string");var i=a(e("./adcontrol")),s=a(e("./../../../../../player/utils/time")),o=e("../media-container");function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{static getName(){return"adcountdown"}constructor(e,t,r){super(e,t,r),this.listenTo(e,{start:this._onStart,"timeupdate durationchange":this._timeUpdate})}buildCSSClass(){return`${this.getNs()}-advert-countdown-control`}_timeUpdate(e){const t=this.getProvider().duration,r=this.getProvider().currentTime,i=`Осталось - ${s.default.toString(t-r)}`;this.disabled&&r>0&&this.show(),!1===this.disabled&&this.getEl().html(i)}_onStart(){this.getProvider().duration===o.UNKNOWN_DURATION&&this.hide()}};r.default=n},{"../media-container":173,"./../../../../../player/utils/time":335,"./adcontrol":133,"core-js/modules/es6.regexp.to-string":105}],135:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./../../../../../player/controls/default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"adexpand"}constructor(e,t,r){super(e,t,r),this.hide(),this.listenTo(this.getEl(),"click",()=>{"thumb"===this.getMediaContainer().viewMode?this.getMediaContainer().viewMode=this.getPlayer().fullScreen?"fullscreen":"normal":this.getMediaContainer().viewMode="thumb"}),this.listenTo(this.getMediaContainer(),{viewmodechange:()=>{"thumb"===this.getMediaContainer().viewMode&&this.show()}})}buildCSSClass(){let e=this.getNs();return`${e}-advert-expand-control ${e}-btn ${super.buildCSSClass()}`}};r.default=o},{"./../../../../../player/controls/default":257}],136:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./adcontrol")),s=o(e("../../../../../player/utils/dom"));function o(e){return e&&e.__esModule?e:{default:e}}let a=!0,n=0;class l extends i.default{static getName(){return"adinfo"}constructor(e,t,r){super(e,t,r),this.available=!!this.getPlayer().getOptions().plugins.log&&this.getPlayer().getOptions().plugins.log.availableForUser,this.available?(a?this.hide():this.show(),this.listenTo(e,"durationchange progress start state",this._updateInfo),(0,s.default)(window).on("keyup",e=>{18===(e=e.originalEvent).keyCode&&this._togglePanel()}),this.getEl().css({marginTop:85*n+++"px"})):this.hide()}_togglePanel(){a?this.show():this.hide()}hide(){super.hide(),a=!0}show(){this.available?(this._updateInfo(),super.show(),a=!1):this.hide()}_updateInfo(){const e=[],t=this.getProvider(),r=t.getMediaContainer(),i=this.getPlayer().volumeControl;e.push(["AdId",r.getAdId()]),e.push(["McId",r.id]),e.push(["Provider",t.getName()]),e.push(["State",t.state]),e.push(["Duration",r.duration]),e.push(["Volume",`${i.getVolume()} | ${i.getMuted()?"off":"on"} | ${i.currentType}`]);const s=`\n            <dl>${e.map(e=>`<dt>${e.join("</dt><dd>")}</dt>`).join("")}</dl>`;this.getEl().html(s)}destroy(){super.destroy()}buildCSSClass(){return`${this.getNs()}-advert-info-control ${super.buildCSSClass()}`}}l.prototype._options={};var d=l;r.default=d},{"../../../../../player/utils/dom":328,"./adcontrol":133}],137:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AdPhoneControl=void 0;var i,s=(i=e("./adcontrol"))&&i.__esModule?i:{default:i};r.AdPhoneControl=class extends s.default{static getName(){return"adphone"}constructor(e,t,r){super(e,t,r),this.getOption("phone")?this.getEl().html(`<a href="tel:${this.getOption("phone")}"></a>`):this.hide()}buildCSSClass(){return`mv-advert-phone-control ${super.buildCSSClass()}`}}},{"./adcontrol":133}],138:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../../../../../player/controls/default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"adresume"}constructor(e,t,r){super(e,t,r),this.listenTo(this.getEl(),"click",this._onClick),this.listenTo(e,"state",this._onStateChange),this.hide()}_onClick(){this.getProvider().play(),this.hide()}_onStateChange(e){"pause"===e.state?this.show():this.hide()}buildCSSClass(){let e=this.getNs();return`${e}-advert-resume-control ${e}-btn ${super.buildCSSClass()}`}};r.default=o},{"../../../../../player/controls/default":257}],139:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("./adcontrol")),s=a(e("./../../../../../player/utils/time")),o=e("../media-container");function a(e){return e&&e.__esModule?e:{default:e}}class n extends i.default{static getName(){return"adskip"}constructor(e,t,r){super(e,t,r),this.hide(),this._time=0,this.listenTo(this.getEl(),"click",()=>{const e=this.getProvider().currentTime,t=this._time;(!t||Math.ceil(t-e)<=0)&&this.getProvider().getMediaContainer().trigger("skip",{skipTime:e})}),this.listenTo(e,{start:this._onStart,timeupdate:this._onTick,durationchange:this._showSkipButtonIfNeed,skippableState:this._onSkippableState})}destroy(){super.destroy()}_onSkippableState(e){this._time=0,this._refreshButton(),e.state?this.show():this.hide()}_showSkipButtonIfNeed(){const e=this.getProvider().duration;let t=this.getOption("time");"string"==typeof t&&(t.indexOf(":")>-1?t=s.default.fromString(t):t.indexOf("%")>-1&&(t=parseInt(e*parseInt(t)/100))),this._time=+t,e!==o.UNKNOWN_DURATION&&t>0&&e>t?this.show():this.hide()}_onStart(){this._showSkipButtonIfNeed(),this._refreshButton()}_onTick(){this._refreshButton()}_refreshButton(){const e=this._time;let t=this.translate("Пропустить рекламу");if(e>0){const r=Math.ceil(e-this.getProvider().currentTime);r>0&&(t=this.translate("Пропустить через ")+r+this.translate(" с"))}this.getEl().html(t),this._showSkipButtonIfNeed()}buildCSSClass(){const e=this.getNs();return`${e}-advert-skip-control ${e}-btn ${super.buildCSSClass()}`}}n.prototype._options={time:10};var l=n;r.default=l},{"../media-container":173,"./../../../../../player/utils/time":335,"./adcontrol":133}],140:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if(e){let t=(e=(0,i.clone)(e)).items,r=[];if(t){for(let e=0;e<t.length;e++){let i=t[e],s=i.length,o=[];for(let e=0;e<s;e++){let t=i[e];!1==!!t.ad.backPreload&&o.push(t)}o.length&&r.push(o)}e.items=r}}return e};var i=e("./../../../../../player/utils/extend")},{"./../../../../../player/utils/extend":330}],141:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if(e){let t=(e=(0,i.clone)(e)).items,r=[];if(t){for(let e=0;e<t.length;e++){let i=t[e],s=i.length,o=[];for(let e=0;e<s;e++){let t=i[e];t.onPause&&o.push(t)}o.length&&r.push(o)}e.items=r}}return e};var i=e("./../../../../../player/utils/extend")},{"./../../../../../player/utils/extend":330}],142:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t=!1){if(e){let r=(e=(0,i.clone)(e)).items,s=[];if(r){for(let e=0;e<r.length;e++){let i=r[e],o=i.length;if(1===o&&!0===i[0].ad.backPreload&&(s.push(i),!1===t))break}e.items=s}}return e};var i=e("./../../../../../player/utils/extend")},{"./../../../../../player/utils/extend":330}],143:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if(e){let t=(e=(0,i.clone)(e)).items,r=[];if(t){for(let e=0;e<t.length;e++){let i=t[e],s=i.length,o=[];for(let e=0;e<s;e++){let t=i[e];t.onPause||o.push(t)}o.length&&r.push(o)}e.items=r}}return e};var i=e("./../../../../../player/utils/extend")},{"./../../../../../player/utils/extend":330}],144:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.allowPlayingAdvert=function(e,t,r){return l.apply(this,arguments)},e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.promise");var i=o(e("./media-container")),s=o(e("../../../../player/core/console"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function l(){var e;return e=function*(e,t,r,o,n={}){const l=e instanceof i.default,u=l?e.getAdId():e.adId,c=(l?e.getCampaignId():e.campaign_id,l?e.getAdSlotId():e.adSlotId),h=l?e.getOption("limits"):e.limits,p=l?e.getOption("backPreload"):e.backPreload,_=(l?e.getOption("maxIFrameDepth"):e.maxIFrameDepth)>>0,g=!!(l?e.getIsRtb():e.is_rtb),f=r.getStorage();let m=l?e.getOption("minWidth"):e.minWidth,A=l?e.getOption("minHeight"):e.minHeight,v=!0;!n&&o&&(n=o._positionConfig);const y=e=>{d(`Пропуск рекламы, т.к. ${e}`,u,t,r)};if(p&&o&&o.getOption("notYoutube"))return y("запрещена реклама youtube"),Promise.reject("ytDisallowed");if(_>1){let e=(location&&location.ancestorOrigins&&location.ancestorOrigins.length?location.ancestorOrigins.length:0)>>0;if(e>_)return y("запрещена реклама т.к. превышен лимит вложеных фреймов "+e+" > "+_),Promise.reject("iframeDepthDisallowed")}let b,P,T=function(e,t){const r=t.getPlugin("backend").getOption("ref");return`ad.countMoment[${e}][${r}]`}(u,r),w=`ad.count[${u}]`;try{var S=a(yield Promise.all([f.getItem(T),f.getItem(w)]),2);b=S[0],P=S[1]}catch(e){s.default.error(e)}const E=!!b;let O="other";if(d(`Просмотров рекламы: ${P=P||0}/${h.count||0}`,u,t,r),!g&&E&&(r.isDevVersion?y("реклама уже показывалась в течении 10 секунд (игнорируем т.к. dev версия)"):(y("реклама уже показывалась в течении 10 секунд"),O="limit",v=!1)),v&&(o&&o.alreadySelectedAd(u,c)&&(y("рекламу уже пытались показать"),O="showed",v=!1),h.count>0&&P>=h.count&&(y("превышено число просмотров"),O="limit",v=!1),v&&!n.disableSizeFilter)){if(!m||!A){let e=o&&o.getOption("defaultMinSize"),t=e||{minWidth:0,minHeight:0};m=t.minWidth,A=t.minHeight}let e=window.devicePixelRatio||1,t=r.width*e,i=r.height*e;m&&A&&(m>t||A>i)&&(y(`недостаточный размер плеера для её показа (необходимо ${m}x${A})`),O="size",v=!1)}return v?e:Promise.reject(!1)},(l=function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){n(o,i,s,a,l,"next",e)}function l(e){n(o,i,s,a,l,"throw",e)}a(void 0)})}).apply(this,arguments)}const d=(e,t,r,i,s)=>{t&&(e=`${e}, adId=${t}`),i.trigger("adSlotLog",{adId:t,slot:r,action:e,isError:"error"===s})}},{"../../../../player/core/console":280,"./media-container":173,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],145:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../../../../../../player/utils/extend")),s=o(e("../../../../../../player/core/base-object"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends s.default{constructor(e,t){super(e,t)}getSlotId(e){return this.getOption("slotIds",{})[e]}prepareOptions(e){let t={advert:1,video:{},controls:(0,i.default)({items:{}},this.getOption("controls")||{}),limits:{count:0,expire:86400}};return(0,i.default)(e,e.extendData),delete e.extendData,e.provider&&(t.video.provider=e.provider,delete e.provider),e.adId&&(t.adId=e.adId,delete e.adId),e.src&&(t.video.src=e.src,delete e.src),e.type&&(t.video.type=e.type,delete e.type),e.html&&(t.video.html=e.html,delete e.html),void 0!==e.skipTime&&(t.controls.items.adskip={time:e.skipTime},delete e.skipTime),e.timeout||(e.timeout=1e4),e.timeout&&(t.video.timeout=e.timeout),e.postMessage&&(t.video.postMessage=e.postMessage,delete e.postMessage),e.collapseTime&&(t.video.collapseTime=+e.collapseTime,delete e.collapseTime),void 0!==e.skipTime2&&(t.controls.items.adclose={time:e.skipTime2},delete e.skipTime2),e.customClick&&(t.controls.items.adbutton.href=e.customClick,e.linkTxt||(t.controls.items.adclickable.href=e.customClick),delete e.customClick),e.linkTxt&&(t.controls.items.adbutton.text=e.linkTxt,delete e.linkTxt),e.clickThrough&&(t.controls.items.adbutton.href=e.clickThrough,t.controls.items.adclickable.href=e.clickThrough,delete e.clickThrough),e.duration&&(t.video.duration=e.duration,delete e.duration),void 0!==e.volume&&(e.volume>=0&&(t.volume=e.volume),delete e.volume),"0"===e.controls&&(t.controls=!1,delete e.controls),e.skipPosition&&(t.controls.items.adskip||(t.controls.items.adskip={}),t.controls.items.adskip.position=e.skipPosition,delete e.skipPosition),e.linkPosition&&(t.controls.items.adbutton&&(t.controls.items.adbutton.position=e.linkPosition),delete e.skipPosition),e.nativeControls&&(t.video.nativeControls=!0),delete e.nativeControls,202591===t.adId&&(t.controls.items.adphone={phone:"88003010149"}),(0,i.default)(t,e),e.video&&"string"==typeof e.video.src&&(e.video.src=e.video.src.trim()),t}};r.default=a},{"../../../../../../player/core/base-object":277,"../../../../../../player/utils/extend":330}],146:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable");var i,s=e("../../../../../../player/utils/extend"),o=(i=e("./BaseInitSlots"))&&i.__esModule?i:{default:i};function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){n(e,t,r[t])})}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=class extends o.default{_initAds(e){return e.map(e=>this.prepareOptions(e))}_getDataFromArray(e,t){return e.map(e=>({ad:(0,s.clone)(t[e.index]),item:e}))}_getAllDataFromArray(e,t){return e.map(e=>this._getDataFromArray(Array.isArray(e)?e:[e],t))}_setChangesToPropertiesSlot(e,t){e.forEach(e=>{e.forEach(({ad:e,item:r})=>r.ad=a({},e,{adSlotId:this.getSlotId(t),adSlot:t,adUuid:r.uuid}))})}_setChangesSlots(e,t){return a({},e,{[t]:a({},e[t],{type:t,slot:t,slotId:this.getSlotId(t)})})}initSlots(e,t){const r=this._initAds(e);return Object.keys(t).reduce((e,i)=>(this._setChangesToPropertiesSlot(this._getAllDataFromArray(t[i].items,r),i),a({},e,this._setChangesSlots(t,i))),{})}};r.default=l},{"../../../../../../player/utils/extend":330,"./BaseInitSlots":145,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/web.dom.iterable":115}],147:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.promise");var i,s=e("../../../../../../player/utils/extend"),o=(i=e("./BaseInitSlots"))&&i.__esModule?i:{default:i},a=e("../../helpers");function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){l(e,t,r[t])})}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){d(o,i,s,a,n,"next",e)}function n(e){d(o,i,s,a,n,"throw",e)}a(void 0)})}}var c=class extends o.default{constructor(e,t,r){super(e,r),this.adManager=t}allowPlayingAdvert(e){var t=this;return u(function*(){try{return yield(0,a.allowPlayingAdvert)(e,void 0,t.getPlayer(),t.adManager,t.getOptions()),!0}catch(e){return!1}})()}_initAds(e){var t=this;return u(function*(){const r=[];for(const i of e){const e=t.prepareOptions(i);(yield t.allowPlayingAdvert(e))?r.push(e):r.push(!1)}return r})()}initSlots(e,t){var r=this;return u(function*(){let i={};const o=yield r._initAds(e);for(let e in t){if(!t.hasOwnProperty(e))continue;let a=t[e],l=a.items,d=r.getSlotId(e);const u=[];let c=[];const h=6,p=()=>{c.length>0&&(u.push(c),c=[])};for(let t of l){!1===Array.isArray(t)&&(t=[t]),t.length>1&&p();for(let r of t){const t=n({},r);o[r.index]&&(t.ad=n({},(0,s.clone)(o[r.index]),{adSlotId:d,adSlot:e,adUuid:r.uuid}),c.push(t),c.length>=h&&p())}}p(),a.items=u,a.type=e,a.slot=e,a.slotId=d,i[e]=a}return i})()}};r.default=c},{"../../../../../../player/utils/extend":330,"../../helpers":144,"./BaseInitSlots":145,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],148:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AdsConfigWorker=void 0,e("core-js/modules/es6.promise");var i=o(e("./InitSlotsDefault")),s=o(e("./InitSlotsWithGrouping"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}r.AdsConfigWorker=class{constructor(e,t,r){this.BUCKET_GROUPING=!0,this.getSlotsDefault=new i.default(e,r),this.getSlotsGroup=new s.default(e,t,r)}prepare(e,t){var r,i=this;return(r=function*(){return i.BUCKET_GROUPING?yield i.getSlotsGroup.initSlots(e,t):i.getSlotsDefault.initSlots(e,t)},function(){var e=this,t=arguments;return new Promise(function(i,s){var o=r.apply(e,t);function n(e){a(o,i,s,n,l,"next",e)}function l(e){a(o,i,s,n,l,"throw",e)}n(void 0)})})()}}},{"./InitSlotsDefault":146,"./InitSlotsWithGrouping":147,"core-js/modules/es6.promise":97}],149:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MANAGER_STATE=void 0;r.MANAGER_STATE={INIT:"init",READY:"ready",EMPTY:"empty",WAITING:"waiting",AD_WAITING:"advertWaiting",AD_PRELOAD_START:"advertPreloadStart",AD_PRELOAD_SUCCESS:"advertPreloadSuccess",AD_PRELOAD_FAIL:"advertPreloadFail",AD_VIEW:"advertView",AD_START:"advertStart",AD_END:"advertEnd",AD_ERROR:"advertError",DESTROY:"destroy"}},{}],150:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RtbService=void 0,e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.array.from"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/es6.promise"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es7.object.values"),e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.regexp.match"),e("core-js/modules/es6.array.find");var i,s=(i=e("../../url/label/rs/RedservizeCanplayLabel"))&&i.__esModule?i:{default:i};function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}class l{constructor(e,t,r){return this.URL_REQUEST="https://am-0.moevideo.biz/ssp/auction_multi",l.instance||(l.instance=this,this.slotsList=this._getFlatList(r),this.rtbAdList=this._getRtbAdFromAdList(e),this.dataRequest=this._createDataForRequest(t),this.store=this._createStore()),l.instance}getStore(){return this.store}_createStore(){var e,t=this;return(e=function*(){const e=yield t._sendRequest();return e?e.json():{}},function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){n(o,i,s,a,l,"next",e)}function l(e){n(o,i,s,a,l,"throw",e)}a(void 0)})})()}_sendRequest(){if(this.rtbAdList.length)return fetch(this.URL_REQUEST,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.dataRequest)})}_createDataForRequest(e){const t=new s.default;return{mv_uuid:new String(e._options.plugins.backend.userUids[0]),page:new String(this._getCurrentDomain()),duration:new String(200*Math.random()+160),width:new String(e.width),height:new String(e.height),formats:t.getValue(),ads:this.rtbAdList}}_getCurrentDomain(){return location.ancestorOrigins?location.ancestorOrigins[location.ancestorOrigins.length-1]:location.host}_getRtbAdFromAdList(e){return e.reduce((e,{src:t},r)=>/moevideo.biz\/ssp/i.test(t)?a(e).concat([function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){o(e,t,r[t])})}return e}({},this._getParamsFromUrl(t),{ad_uid:this.slotsList.find(e=>e.index===r).uuid})]):e,[])}_getParamsFromUrl(e){const t=e.match(/dids=([\d,]+)|did=(\d+)|vpt=(\d+)|dbg=(\d+)|page=([^[\]&]+)/gi),r=Object.fromEntries(t.reduce((e,t)=>a(e).concat([t.split("=")]),[]));return r.dbg=+r.dbg||0,r}_getFlatList(e){return Object.values(e).map(e=>e.items).flat(2)}}r.RtbService=l},{"../../url/label/rs/RedservizeCanplayLabel":202,"core-js/modules/es6.array.find":91,"core-js/modules/es6.array.from":92,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.split":104,"core-js/modules/es6.regexp.to-string":105,"core-js/modules/es6.symbol":109,"core-js/modules/es7.object.values":112,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],151:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.POS_STATE=r.default=void 0;r.default={AUTO:"auto",PRE:"pre",PAUSE:"pause",MID:"mid",POST:"post",VAST:"vast",VAST_AUDIO:"vast_audio",VAST_VIDEO:"vast_video",BLACK:"black",CONTENT:"content",CONTENT_AUDIO:"content_audio",OVER_CLICK:"over_click",OVER_FOCUS:"over_focus",VIDEO_BANNER:"video_banner"};r.POS_STATE={IDLE:"idle",PLAY:"play",PAUSE:"pause",END:"end",CLOSE:"close",WAITING:"waiting",TIMEOUT:"timeout",LOADING:"loading",READY:"ready"}},{}],152:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../manager")),s=a(e("../../../../../../player/env/index")),o=a(e("../../filter/notYoutube"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{get name(){return"AutorollManager"}setSelectorConfig(e){super.setSelectorConfig((0,o.default)(e))}init(){super.init()?(this._runCount=0,this._playContentAfterFinish=!1,this.disable()):this.disable(!0)}enable(){if(super.enable(),this.enable=function(){},!1===s.default.autoPlay&&!1===s.default.silentAutoplay)return void(this.state=i.MANAGER_STATE.EMPTY);let e=this.getPlayer();e.once("adAutoplayAllow",this._runAutoPlay,this),e.trigger("adRequestAutoplay")&&e.trigger("adAutoplayAllow")}_runAutoPlay(){if(this.disabled)return;this._destroySelector();let e=this.getPlayer(),t=this._play(),r=()=>{if(e.trigger("adAutoplayFinish"),this._playContentAfterFinish)e.play();else{let t=setTimeout(()=>{"idle"===e.getMediaContainer().state&&this.trigger("longIdleAfterFinish"),t=!1},this.getOption("longIdleAfterFinishTimeout",6e4));this.listenTo(e,"state",e=>{"play"===e.state&&t&&clearTimeout(t)})}},i=()=>!!this.blockAdAllowed&&(1===this._runCount&&e.visible?(this._runAutoPlay(),i=function(){return!0},!0):void 0);if(!t)return;this._runCount++,e.trigger("adAutoplayStart",{position:t});let s=!1;this.listenTo(t,{start:()=>{s=!0},"error timeout empty globalTimeout":()=>{s&&i()||r()},close:()=>{this._playContentAfterFinish=!0,i()||r()},finish:()=>{i()||(this._playContentAfterFinish=!0,r())}})}};r.default=n},{"../../../../../../player/env/index":306,"../../filter/notYoutube":140,"../manager":162}],153:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("../manager")),s=a(e("../../filter/notYoutube")),o=a(e("../../../../../../player/utils/catchHandler"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{get name(){return"AutorollSimpleManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}init(){if(!super.init())return;let e=this._preLoad(),t=this.getPlayer();e.then(()=>{t.trigger("adPreloadSuccess"),t.trigger("adLoaded")}).catch(e=>{t.trigger("adPreloadFail"),t.trigger("adEmpty")}),this.listenTo(t,"ready",()=>{e.then(()=>this._play()).catch(e=>(0,o.default)(e))})}};r.default=n},{"../../../../../../player/utils/catchHandler":327,"../../filter/notYoutube":140,"../manager":162}],154:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./contentroll-manager-v2.0"))&&i.__esModule?i:{default:i};var o=class extends s.default{get name(){return"ContentRollAudioManager"}get version(){return"2.0"}_sendInventory(){}_createSelector(e,t){return t.disableSizeFilter=!0,super._createSelector(e,t)}};r.default=o},{"./contentroll-manager-v2.0":156}],155:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("../auto/autoroll-simple-manager")),s=a(e("../../filter/notYoutube")),o=a(e("../../../../../../player/core/console"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{get name(){return"ContentRollManager"}get version(){return"1.0"}init(){return o.default.log(`ContentRoll Api: ${this.version}`),super.init()}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}_sendInventory(){}};r.default=n},{"../../../../../../player/core/console":280,"../../filter/notYoutube":140,"../auto/autoroll-simple-manager":153}],156:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../manager")),s=l(e("../../filter/notYoutube")),o=l(e("../../../../../../player/core/console")),a=l(e("../../../../../../player/utils/catchHandler")),n=l(e("../../../../../../tools/native/settings/config"));function l(e){return e&&e.__esModule?e:{default:e}}const d="CR: Manager: ",u=!0,c=20,h=30;var p=class extends i.default{constructor(...e){super(...e),this._adSelectorEvents=[{name:"start",callback(){this._runCount++,this._log2("_runPlay: pos: on start")}},{name:"error",callback(e){!0===e.fatal?(this.getPlayer().trigger("adContentRollManagerDestroy"),this.destroy()):this._adSelectorEventCb("error")}},{name:"timeout",callback(){this._adSelectorEventCb("timeout")}},{name:"empty",callback(){this._adSelectorEventCb("empty")}},{name:"globalTimeout",callback(){this.getPlayer().trigger("adContentRollManagerDestroy"),this.destroy()}},{name:"close",callback(){this._adSelectorEventCb("close")}},{name:"finish",callback(){this._adSelectorEventCb("finish")}},{name:"adPayed",callback(){this.getPlayer().trigger("adPayed")}}]}get name(){return"ContentRollManager"}get version(){return"2.0"}get maxAds(){return this.getOption("maxAds")?this.getOption("maxAds"):c}get isLastTry(){return this._runCount>=this.maxAds}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}_log2(){if(!1===u)return;let e=Array.prototype.slice.call(arguments);e.unshift(d),o.default.log.apply(o.default,e)}init(){this._log2(`ContentRoll Api: ${this.version}`);let e=this.getPlayer();if(e.trigger("adContentRollManagerInit"),!super.init())return;let t=this._load();this._tryCount=0,this._runCount=0,this._playerVisible=!1,this._waitPlayerVisibleForPlay=!1,e.trigger("adPreloadStart");let r=!1;t.then(()=>{e.trigger("adPreloadSuccess"),e.trigger("adLoaded"),r=!0}).catch(t=>{e.trigger("adPreloadFail"),e.trigger("adEmpty")}),e.on("playAd",e=>{this._log2("player on playAd"),e.slot===this.slot&&(r?this._runPlayOnVisible():t.then(()=>{this._log2("player on playAd preLoadingPromise.then"),this._runPlayOnVisible()}).catch(e=>(0,a.default)(e)))}),e.on("visibleRateChange",e=>{let t=e.visibleRate>=n.default.DEFAULT_VISIBILITY;t!==this._playerVisible&&(this._log2("visibleRateChange: "+t),this._waitPlayerVisibleForPlay&&(this._log2("...visibly!!"),this._waitPlayerVisibleForPlay=!1,this._runPlay()),this._playerVisible=t)})}_runPlayOnVisible(){this._playerVisible?this._runPlay():(this._log2("...wait player visibly..."),this._waitPlayerVisibleForPlay=!0)}_adSelectorEventCb(e){this._log2(`_runPlay: pos: on ${e}`),this._runPlayOnVisible()}_runPlay(){this._log2("_runPlay");let e=this.getPlayer();if(this._tryCount++,this._tryCount<=h&&this._runCount<this.maxAds){this._log2(`_runPlay: _runCount < ${h} && _tryCount <= ${c}`);let e=new Promise(e=>{e()});if(this._tryCount>1){this._log2("_runPlay: _tryCount > 1 -> destroyPosition");for(let e of this._adSelectorEvents)this._pos.off(e.name,e.callback,this);e=this._destroySelector()}e.then(()=>{let e=this._play();if(e){this._pos=e,this._pos.loadNextAdInBackground=!this.isLastTry,this._log2("_runPlay: pos not null");let t=this._adSelectorEvents.reduce((e,t)=>(e[t.name]=t.callback,e),{});this.listenTo(e,t)}}).catch(e=>(0,a.default)(e))}else this._log2(`_runPlay: _runCount: ${this._runCount}; _tryCount: ${this._tryCount} -> destroy`),e.trigger("adContentRollManagerDestroy"),this.destroy()}_triggerState(e){e===i.MANAGER_STATE.AD_END&&this._runCount<c||e===i.MANAGER_STATE.AD_ERROR&&this._tryCount<=h||super._triggerState(e)}_sendInventory(){this._log2("_sendInventory")}};r.default=p},{"../../../../../../player/core/console":280,"../../../../../../player/utils/catchHandler":327,"../../../../../../tools/native/settings/config":341,"../../filter/notYoutube":140,"../manager":162,"core-js/modules/es6.promise":97}],157:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../pre/preroll-manager"))&&i.__esModule?i:{default:i};var o=class extends s.default{};r.default=o},{"../pre/preroll-manager":171}],158:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./contentroll-manager-v2.0"))&&i.__esModule?i:{default:i};var o=class extends s.default{};r.default=o},{"./contentroll-manager-v2.0":156}],159:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../manager")),o=e("./video-banner/video-banner-auto-manager"),a=e("./video-banner/video-banner-yt-manager"),n=(i=e("../../../../../../tools/native/settings/config"))&&i.__esModule?i:{default:i};const l="VB: Manager: ",d=!0;var u=class extends s.default{get name(){return"VideoBannerManager"}init(){super.init()&&(this.defaultWaitYTPlayTimeout=5e3,this._onWaitYTPlayTimeout=this._onWaitYTPlayTimeout.bind(this),this._ytIsRun=!1,this._autoIsRun=!1,this._yt=new a.VideoBannerYtManager(this._adManager,{name:this.slot}),this._yt.setSelectorConfig(this._adManager.adSlots[this.slot]),this._yt.init(),this._yt.disable(),this._auto=new o.VideoBannerAutoManager(this._adManager,{name:this.slot}),this._auto.setSelectorConfig(this._adManager.adSlots[this.slot]),this._auto.init(),this._auto.disable(),this._waitYTPlayTimeout=null,this._runYTManager(),this._listenYTManager(),this._listenAutoManager(),this._playerVisible=!0,this._waitPlayerVisibleForAutoPlay=!1,this.getPlayer().on("visibleRateChange",e=>{let t=e.visibleRate>=n.default.DEFAULT_VISIBILITY;if(t!==this._playerVisible){if(this._log2("visibleRateChange: "+t),this._waitPlayerVisibleForAutoPlay)this._log2("...visibly!!"),this._waitPlayerVisibleForAutoPlay=!1,this._nextAuto();else{let e=this._ytIsRun?this._yt.selector:this._auto.selector;e&&e._mc&&("pause"===e._mc.state&&t&&!this._playerVisible?e._mc.play():"play"===e._mc.state&&!t&&this._playerVisible&&e._mc.pause())}this._playerVisible=t}}))}_log2(){if(!1===d)return;let e=Array.prototype.slice.call(arguments);e.unshift(l),console.log.apply(console.log,e)}_runYTManager(e=0){this._log2("_runYTManager"),this._ytIsRun=!0,this._yt.enable(),setTimeout(()=>{this._log2("_runYTManager _yt.play()"),this._yt.runPlay()},e)}_runAutoManager(e=0){this._log2("_runAutoManager"),this._autoIsRun=!0,this._auto.enable(),setTimeout(()=>{this._nextAutoOnVisible()},e),this._stopWaitYTPlayTimeout()}_stopYTManager(e=!0){this._log2("_stopYTManager"),this._ytIsRun=!1,this._yt.disable(e),e&&setTimeout(()=>{this._log2("_stopYTManager _yt.destroy()"),this._yt.destroy()},1e3),this._stopWaitYTPlayTimeout()}_stopAutoManager(e=!0){this._log2("_stopAutoManager"),this._autoIsRun=!1,this._auto.disable(e)}_nextAuto(){this._log2("_nextAuto"),this._autoIsRun&&(this._log2("_nextAuto _auto.play()"),this._auto.runPlay())}_nextAutoOnVisible(){this._log2("_nextAutoOnVisible"),this._playerVisible?this._nextAuto():(this._log2("...wait player visibly..."),this._waitPlayerVisibleForAutoPlay=!0)}_runWaitYTPlayTimeout(e=null){this._log2("_runWaitYTPlayTimeout"),!1!==this._ytIsRun?(null===e&&(e=this.defaultWaitYTPlayTimeout),this._log2("_runWaitYTPlayTimeout timeout:",e),this._stopWaitYTPlayTimeout(),!1===e?(this._log2("_runWaitYTPlayTimeout _onWaitYTPlayTimeout()"),this._onWaitYTPlayTimeout()):(this._log2("_runWaitYTPlayTimeout run timeout"),this._waitYTPlayTimeout=setTimeout(this._onWaitYTPlayTimeout,e))):this._log2("_runWaitYTPlayTimeout this._ytIsRun === false")}_stopWaitYTPlayTimeout(){this._waitYTPlayTimeout&&(this._log2("_stopWaitYTPlayTimeout"),clearTimeout(this._waitYTPlayTimeout),this._waitYTPlayTimeout=null)}_onWaitYTPlayTimeout(){this._log2("_onWaitYTPlayTimeout"),this._stopWaitYTPlayTimeout(),!0===this._ytIsRun&&this._stopYTManager(),!1===this._autoIsRun&&this._runAutoManager()}_listenYTManager(){this._log2("_listenYTManager"),this.listenTo(this._yt,{play:()=>{this._log2(this._yt.name+" fire play"),this._stopWaitYTPlayTimeout()},pause:()=>{this._log2(this._yt.name+" fire pause"),this._runWaitYTPlayTimeout()},error:()=>{this._runWaitYTPlayTimeout(!1)},empty:()=>{this._runWaitYTPlayTimeout(!1)},state:e=>{switch(this._log2(this._yt.name+" fire",e.state),e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:case s.MANAGER_STATE.AD_END:this._runWaitYTPlayTimeout(!1);break;case s.MANAGER_STATE.AD_WAITING:case s.MANAGER_STATE.AD_VIEW:!1===this._yt.isPlaying&&this._runWaitYTPlayTimeout();break;case s.MANAGER_STATE.AD_START:}}})}_listenAutoManager(){this._log2("_listenAutoManager"),this.listenTo(this._auto,{"muted-error":()=>{this._log2(this._auto.name+" fire muted-error"),this.state=s.MANAGER_STATE.AD_WAITING,this._nextAutoOnVisible()},state:e=>{switch(this._log2(this._auto.name+" fire state:",e.state," this.state:",this.state),e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:case s.MANAGER_STATE.AD_END:this.state=s.MANAGER_STATE.AD_WAITING,this._nextAutoOnVisible();break;case s.MANAGER_STATE.AD_VIEW:case s.MANAGER_STATE.AD_WAITING:this.state=e.state}}})}};r.default=u},{"../../../../../../tools/native/settings/config":341,"../manager":162,"./video-banner/video-banner-auto-manager":160,"./video-banner/video-banner-yt-manager":161}],160:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VideoBannerAutoManager=void 0;var i,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../manager")),o=(i=e("../../../filter/notYoutube"))&&i.__esModule?i:{default:i};const a=2;r.VideoBannerAutoManager=class extends s.default{get name(){return"VideoBannerAutoManager"}setSelectorConfig(e){super.setSelectorConfig((0,o.default)(e))}init(){super.init()&&(this._errorCount=0,this.dontDestroyAfterPosError=!0,this._runCount=0)}runPlay(){let e=!0,t=this.getPlayer();this._runCount++,this._runCount>1&&this._destroySelector(),this._errorCount>=a&&(e=!1,this.state=s.MANAGER_STATE.AD_ERROR,t.trigger("adError")),e&&this._play()}_listenSelector(e){super._listenSelector(e);let t=this.getPlayer();this.listenTo(e,{"error timeout empty":()=>{this._errorCount++,this._errorCount>=a?(this.state=s.MANAGER_STATE.AD_ERROR,t.trigger("adError")):this.trigger("muted-error")}})}_logSelector(){}}},{"../../../filter/notYoutube":140,"../../manager":162}],161:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VideoBannerYtManager=void 0;var i=o(e("../../manager")),s=o(e("../../../filter/onlyYoutube"));function o(e){return e&&e.__esModule?e:{default:e}}r.VideoBannerYtManager=class extends i.default{get name(){return"VideoBannerYtManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e,!0))}init(){super.init()&&(this.dontDestroyAfterPosError=!0,this._isPlaying=!1,this.tryNextAd())}get blockAdAllowed(){return!1}get isPlaying(){return this._isPlaying}tryNextAd(){let e=this.getPlayer();e.visibility.visible||(this._log("Плеер не в фокусе, ждём фокуса перед стартом рекламы..."),e.once("visible",()=>{this._log("Плеер в фокусе, пробуем показать рекламу"),this._play()}))}runPlay(){this._play()}_listenSelector(e){super._listenSelector(e),this.listenTo(e,{state:e=>{switch(console.log("### state",e.state),e.state){case"play":this._isPlaying=!0,this.trigger("play");break;case"pause":this._isPlaying=!1,this.trigger("pause");break;case"error timeout empty globalTimeout":case"close":case"finish":this._isPlaying=!1}},error:()=>{this.trigger("error"),this._isPlaying=!1}})}_logSelector(){}}},{"../../../filter/onlyYoutube":142,"../../manager":162}],162:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"MANAGER_STATE",{enumerable:!0,get:function(){return u.MANAGER_STATE}}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es7.object.values"),e("core-js/modules/es7.promise.finally"),e("core-js/modules/es6.promise");var i=h(e("./../../../../../player/core/base-object")),s=e("../lib/slots"),o=h(e("../../../../../player/utils/extend")),a=h(e("./../../../../../player/env/index")),n=h(e("../../../../../player/core/console")),l=h(e("../advert-selector")),d=h(e("../advert-selector-immortal")),u=e("../lib/managerState"),c=h(e("../../../../../common/js/utils/ad-block-cache"));h(e("../media-container"));function h(e){return e&&e.__esModule?e:{default:e}}let p=0,_={},g={};var f=class extends i.default{static get lastAdPlayingTime(){return p}get name(){throw new Error("AbstractSlotManager.get name не реализован")}constructor(e,t={}){super(e.getPlayer(),t),this._selector=null,this.volumeControl=this.getPlayer().volumeControl,this._slotName=this.getOption("name"),this._adManager=e,this._preparedSelectors={},this._enabled=!0,this._position_block_index=0}setSlotId(e){this._slotId=e}destroy(){this.state=u.MANAGER_STATE.DESTROY,this._destroySelector(),super.destroy()}_destroySelector(){if(this._selector){if(this._selector instanceof d.default)return this._selector.resetState("_destroySelector",!1);this._selector.destroy(),this._selector=null}return Promise.resolve(!0)}reset(){}setSelectorConfig(e){if(e=(0,o.default)(e)){let t=e.items,r=this._slotName;for(let e=0;e<t.length;e++){let i=t[e];for(let e=0;e<i.length;e++)i[e].ad.adSlot=r}e.slot=r}this._selectorConfig=e}get exists(){return!!this._selectorConfig}_log(e,t=!1,r=!1){this._logDisabled||(t&&(e=`${e}, adId=${t}`),this.getPlayer().trigger("adSlotLog",{adId:t,adSlotId:this._slotId,slot:this.slot,action:e,isError:r}))}init(){return!!this.exists&&(this.state=u.MANAGER_STATE.INIT,this._logSelector(),this.dontDestroyAfterPosError=!1,!0)}_load(){if(this._loadPromise)return this._loadPromise;let e=this.selector.load();return this.state=u.MANAGER_STATE.AD_PRELOAD_START,e.then(()=>{this.state=u.MANAGER_STATE.AD_PRELOAD_SUCCESS}).catch(e=>{this.state=u.MANAGER_STATE.AD_PRELOAD_FAIL}),this._loadPromise=e,e}_preLoad(){if(this._preLoadPromise)return this._preLoadPromise;let e=this.selector.preLoad();return this.state=u.MANAGER_STATE.AD_PRELOAD_START,e.then(()=>{this.state=u.MANAGER_STATE.AD_PRELOAD_SUCCESS}).catch(e=>{this.state=u.MANAGER_STATE.AD_PRELOAD_FAIL}),this._preLoadPromise=e,e}get selector(){if(!this._selector){let e=(0,o.default)(this._selectorConfig);this._selector=this._createSelector(this._adManager,e),this._appendSelector(this._selector),this._selector.blockIndex=this._position_block_index,this.blockAdAllowed&&this._position_block_index++}return this._selector}_createSelector(e,t){switch(t.type){case"content":case"video_banner":return new d.default(e,t);default:return new l.default(e,t)}}play(){this._play()}_updateLastAdTryPlayTime(){g[this.slot]=new Date}_getLastAdTryPlayTime(){return g[this.slot]||0}_updateLastAdPlayTime(){let e=this.slot,t=new Date,r=p,i=0;return _.hasOwnProperty(e)&&(i=_[e]),this._updateLastAdTryPlayTime(),_[e]=t,p=t,{revert(){_[e]=i,p=r}}}_allowNewAdvertAfterPreviousAdvert(){return this._getTimeToAllowingNextAdvert()<0}_getTimeToAllowingNextAdvert(){return 1e3*this._adManager.getOption("preAfterAutoTimeout",60)-this._getDeltaAfterPreviousAdvert()}_getDeltaAfterPreviousAdvert(){return new Date-p}_sendInventory(){this.selector.sendInventory()}_startLoading(){this.getPlayer().loading.start("advert-manager")}_stopLoading(e=!1){this.getPlayer().loading.end("advert-manager",e)}_play(){let e=this.selector.state;if(e===s.POS_STATE.IDLE||e===s.POS_STATE.LOADING||e===s.POS_STATE.READY)return this._startLoading(),Promise.resolve(this.selector).then(e=>e||(this.state=u.MANAGER_STATE.EMPTY,Promise.reject({state:u.MANAGER_STATE.EMPTY}))).then(e=>(this._sendInventory(),this._prepareSelector(e),this.state=u.MANAGER_STATE.WAITING,n.default.log("Попытка показать рекламу..."),this._log("Попытка показать рекламу..."),e)).then(e=>e.start()).catch(e=>{let t=e.target.currentLoadedAd;t&&(c.default.removeAd(t),t.getIsRtb()?this._log("RTB реклама, не надо сохранять в кэш отклоненных реклам",t.getAdId()):(c.default.addRejected(t),this._log("Сохраняем рекламу в кэш отклоненных реклам",t.getAdId()))),n.default.error("Ошибка при показе рекламы, либо нет рекламы",e)}).finally(()=>{let e=this.state===u.MANAGER_STATE.AD_START;this._stopLoading(e),n.default.log("VVVVVVVVVV",this.getPlayer().loading._loadings),Object.values(this.getPlayer().loading._loadings).map(e=>0+e)}),this.selector}_appendSelector(e){this.getPlayer().addChild(e)}_prepareSelector(e){this._preparedSelectors.hasOwnProperty(e.id)||(this._listenSelector(e),this._preparedSelectors[e.id]=!0)}_listenSelector(e){let t,r=this.getPlayer();this.listenTo(e,{"start wantplay":()=>{this._updateLastAdPlayTime(),t=setInterval(()=>{this._updateLastAdPlayTime()},500)},start:()=>{this.state=u.MANAGER_STATE.AD_VIEW,this.state=u.MANAGER_STATE.AD_START,r.trigger("adShown")},wantplay:()=>{this.state=u.MANAGER_STATE.AD_VIEW},globalTimeout:()=>{this.state=u.MANAGER_STATE.AD_ERROR,r.trigger("adError")},"error timeout empty":()=>{this.dontDestroyAfterPosError||(this.state=u.MANAGER_STATE.AD_ERROR,r.trigger("adError"))},"close finish":()=>{this.state=u.MANAGER_STATE.AD_END},state:e=>{switch(e.state){case s.POS_STATE.WAITING:this.state=u.MANAGER_STATE.AD_WAITING;break;case s.POS_STATE.PLAY:this.state===u.MANAGER_STATE.AD_WAITING&&(this.state=u.MANAGER_STATE.AD_START)}},"empty finish close timeout error globalTimeout":e=>{"close"===e.type&&r.trigger("adClose"),r.trigger("adClosed")},destroy:()=>{this._selector===e&&(this._selector=null)},"empty finish close timeout error globalTimeout destroy":e=>{t&&clearInterval(t)},"finish close":()=>{this._updateLastAdPlayTime()}})}_logSelector(){const e=[];for(const t of this._selectorConfig.items)e.push(t.map(e=>e.ad.adId));this.getPlayer().trigger("adPositionCount",{adSlotId:this._slotId,position:this._slotName,count:this.adCount,blocks:e})}get adCount(){let e=this._selectorConfig.items||[],t=0;for(let r=0;r<e.length;r++)t+=e[r].length;return t}set state(e){this._state!==e&&(e===u.MANAGER_STATE.AD_START&&this._state!==u.MANAGER_STATE.AD_WAITING?(this.state=u.MANAGER_STATE.AD_WAITING,this.state=u.MANAGER_STATE.AD_START):(this._state=e,this.trigger("state",{state:e}),this._triggerState(e)))}_triggerState(e){this.getPlayer().trigger(`ad${this.name}State`,{state:e,slot:this._slotName}),this.getPlayer().trigger("adManagerState",{state:e,slot:this._slotName}),n.default.log(`adManagerState[${this._slotName}] ${e}`)}get enabled(){return this._enabled}get disabled(){return!this._enabled}disable(e=!1){this._enabled=!1,this.trigger("disable"),e&&(this.enable=function(){})}enable(){this._enabled=!0,this.trigger("enable")}get slot(){return this._slotName}get state(){return this._state}get blockAdAllowed(){return!!a.default.autoPlay&&this._adManager.getOption("blockAdAllowed",!0)}};r.default=f},{"../../../../../common/js/utils/ad-block-cache":230,"../../../../../player/core/console":280,"../../../../../player/utils/extend":330,"../advert-selector":129,"../advert-selector-immortal":125,"../lib/managerState":149,"../lib/slots":151,"../media-container":173,"./../../../../../player/core/base-object":277,"./../../../../../player/env/index":306,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/es7.object.values":112,"core-js/modules/es7.promise.finally":113,"core-js/modules/web.dom.iterable":115}],163:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("../manager")),s=n(e("../../advert-selector-mid")),o=n(e("../../filter/notYoutube")),a=n(e("../../../../../../player/utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}var l=class extends i.default{get name(){return"MidrollManager"}setSelectorConfig(e){super.setSelectorConfig((0,o.default)(e))}init(){if(!super.init())return;this._showCount=0;let e=this.getPlayer().getMediaContainer();this.listenTo(this.getPlayer(),{change:this._onVideoChange}),e&&this._setVideo(e)}_createSelector(e,t){return new s.default(e,t)}_onVideoChange(e){this._setVideo(e.mc)}_setVideo(e){this._currentVideo&&this.stopListening(this._currentVideo),this._currentVideo=e;let t=this.getPlayer(),r=this._selectorConfig.settings||{},s=1e3*(r.DelayFromVideoStart||600),o=1e3*(r.DelayFromAd||600),n=1e3*(r.DelayToVideoEnd||300),l=o;this.listenTo(e,{timeupdate:e=>{if(!t.visible)return;let r=e.target;function d(){let e=1e3*r.currentTime,t=1e3*r.duration,a=i.default.lastAdPlayingTime;if(!(new Date-a<o||e<s||t-e<n))return!0}new Date-this._getLastAdTryPlayTime()<l||d()&&(this._updateLastAdTryPlayTime(),this._preLoad().then(()=>{d()&&this._tryToPlayMidRoll()}).catch(e=>(0,a.default)(e)))}})}_tryToPlayMidRoll(e=!0){let t=this._play(),r=this.getPlayer(),i=!1,s=!1,o=!1;t&&(e&&t.hide(),this.listenTo(t,{"start wantplay":()=>{if(s)return;s=!0,e&&(r.pause(),t.show()),this._showCount++;let i=this._adManager.getManager("pause");i&&i.disable()},"close finish":()=>{i||(i=!0,this.stopListening(t),this._destroySelector(),this.blockAdAllowed&&1===this._showCount?this._tryToPlayMidRoll(!1):(this._showCount=0,r.play()))},"error timeout empty globalTimeout":()=>{o||(o=!0,this._showCount=0,this.stopListening(t),this._destroySelector(),r.play())}}))}_startLoading(){}_stopLoading(){}};r.default=l},{"../../../../../../player/utils/catchHandler":327,"../../advert-selector-mid":126,"../../filter/notYoutube":140,"../manager":162}],164:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("../../../../../../player/core/console")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../manager")),o=n(e("./pauseroll-unpause-manager")),a=n(e("./pauseroll-onpause-manager"));function n(e){return e&&e.__esModule?e:{default:e}}const l="unpause",d="onpause";var u=class extends s.default{constructor(...e){super(...e),this._disableStateEvent=!1}get name(){return"PauseManager"}set disableStateEvent(e){this._disableStateEvent=e}init(){if(!super.init())return void this.disable(!0);let e=this.getPlayer(),t=()=>{this.enable(),this._allowNewAdvertAfterPreviousAdvert()?this.switchToOnPause():this.switchToUnPause()};return this.listenTo(e,"state",e=>{if(!this._disableStateEvent)switch(e.state){case"pause":t()}}),this.disable(),!0}switchToOnPause(){return this._setMethod(d)}switchToUnPause(){return this._setMethod(l)}_setMethod(e){let t;switch(this._log(`Кликовая реклама. Выбран метод показа: ${e}`),i.default.log(`${this._slotName} ${e}`),this._destroyCurrentManager(),this._method=e,e){case l:t=o.default;break;case d:t=a.default;break;default:return}switch(this._manager=new t(this._adManager,{name:this.slot}),e){case l:this._listenUnPause();break;case d:this._listenOnPause();break;default:return}return this._manager.setSelectorConfig(this._adManager.adSlots[this.slot]),this._manager.init(),this._manager.enable(),this._manager}_listenOnPause(){this.listenTo(this._manager,{state:e=>{switch(e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:this.switchToUnPause();break;case s.MANAGER_STATE.AD_WAITING:case s.MANAGER_STATE.AD_START:case s.MANAGER_STATE.AD_VIEW:this.disable(),this.state=e.state;break;case s.MANAGER_STATE.AD_END:this.state=e.state,this.switchToUnPause()}},disable:()=>{this.disable()}})}_listenUnPause(){this.listenTo(this._manager,{state:e=>{switch(e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:case s.MANAGER_STATE.AD_END:this.disable(),this._destroyCurrentManager();break;case s.MANAGER_STATE.AD_VIEW:case s.MANAGER_STATE.AD_WAITING:case s.MANAGER_STATE.AD_START:this.disable()}this.state=e.state},disable:()=>{this.disable()}})}_destroyCurrentManager(){this._manager&&(this._manager.destroy(),this.stopListening(this._manager),delete this._manager),delete this._method}destroy(){this._destroyCurrentManager(),super.destroy()}};r.default=u},{"../../../../../../player/core/console":280,"../manager":162,"./pauseroll-onpause-manager":165,"./pauseroll-unpause-manager":166}],165:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../manager")),s=o(e("../../filter/onPause"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{get name(){return"OnPauseManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}constructor(e,t={}){super(e,t),this._slotName=this.getOption("name")+"_banner"}init(){super.init()&&this._play()}};r.default=a},{"../../filter/onPause":141,"../manager":162}],166:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../pre/preroll-manager")),s=o(e("../../filter/unPause"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{get name(){return"UnPauseManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}init(){if(!super.init())return;let e=this.getPlayer(),t=()=>{if(this._stopWaiting(),this._allowNewAdvertAfterPreviousAdvert())this.enable(),this._switchToDefaultMethod();else{let r=e.getMediaContainer();this._waitingMc=r,this._waitingTimeout=setTimeout(()=>{this._stopWaiting(),"pause"===r.state&&t()},this._getTimeToAllowingNextAdvert()),this.listenTo(r,"state",e=>{"play"===e.state&&this._stopWaiting()})}};return t(),!0}_stopWaiting(){this._waitingTimeout&&(clearTimeout(this._waitingTimeout),delete this._waitingTimeout),this._waitingMc&&(this.stopListening(this._waitingMc),delete this._waitingMc)}_initStartegy(){}disable(e=!1){return this._stopWaiting(),super.disable(e)}};r.default=a},{"../../filter/unPause":143,"../pre/preroll-manager":171}],167:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("../manager")),s=a(e("../../filter/notYoutube")),o=a(e("../../../../../../player/utils/catchHandler"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{get name(){return"PostrollManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}init(){if(!super.init())return;let e=this.selector,t=this.getPlayer();this.listenTo(t,{timeupdate:r=>{r.target.duration-r.target.currentTime<10&&"idle"===e.state&&(this.stopListening(t,"timeupdate"),this._preLoad())},state:e=>{"end"===e.state&&(t.visible?this.playPostRoll():t.once("visible",()=>{this.playPostRoll()}))}})}playPostRoll(){this._preLoad().then(()=>{this._play()}).catch(e=>(0,o.default)(e))}};r.default=n},{"../../../../../../player/utils/catchHandler":327,"../../filter/notYoutube":140,"../manager":162}],168:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../preroll-layout")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../manager"));o(e("../../../../../../../player/core/console"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends s.default{constructor(...e){super(...e),this._youtubeHackStage=0,this._youtubeHackPlayerMuted=!1,this._baseManager=null}get name(){return"PrerollDefaultManager"}destroy(){this._prerollLayout&&this._prerollLayout.destroy(),super.destroy()}init(){if(!super.init())return void this.disable(!0);const e=this.getPlayer();if(this._prerollLayout=new i.default(e,{slot:this.slot}),e.addChild(this._prerollLayout),this._isYoutubeHackNeeded()){const t=e.getMediaContainer().getProvider();0===this._youtubeHackStage&&(this._logMethod("Ожидание клика по youtube..."),this._youtubeHackPlayerMuted=this.volumeControl.getMuted("player",this),this.volumeControl.setMuted(!0,"player",!1,this),t.updateVolume(),this._prerollLayout.getEl().hide());let r=e=>{if(1===e.data){if(!t.launchedManual)return t.pause(),t.currentTime=0,!1;this._adManager.getManager("pause").disableStateEvent=!1,this.volumeControl.setCurrentType("player")}},i=e=>{switch(e.state){case"waiting":this._play(),this.disable(),this._prerollLayout.getEl().show();break;case"play":this._logMethod("Клик пользователя по youtube, грузим рекламу..."),this._adManager.getManager("pause").disableStateEvent=!0,t.pause(),t.currentTime=0,this.volumeControl.setCurrentType("ad"),this.volumeControl.setMuted(this._youtubeHackPlayerMuted,"player",!1,this),this.disable(),setTimeout(()=>{t._video.addEventListener("onStateChange",r)},0),t.off("state",i),this._youtubeHackStage++}};t.on("state",i),this.once("destroy",()=>{t.off("state",i)})}else this._logMethod("Ожидание клика..."),this.listenTo(this._prerollLayout,"click",()=>{this._logMethod("Клик пользователя, грузим рекламу..."),this._play(),this.disable()});return this.state=s.MANAGER_STATE.READY,!0}_logMethod(e,t=!1,r=!1){this._log(`[default] ${e}`,t,r)}_logSelector(){}_triggerState(){}_isYoutubeHackNeeded(){if(this._baseManager&&"UnPauseManager"===this._baseManager.name)return!1;const e=this.getPlayer(),t=e.getMediaContainer();if(!t)return!1;const r=t.getProvider();return!!r&&((()=>"youtube"===r.getName())()&&(()=>!1===e.env.autoPlay)())}_destroySelector(){return this._selector.destroy()}};r.default=a},{"../../../../../../../player/core/console":280,"../../manager":162,"../preroll-layout":170}],169:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../../manager")),s=o(e("../../../filter/notYoutube"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{get name(){return"PrerollSecondManager"}setSelectorConfig(e){super.setSelectorConfig((0,s.default)(e))}init(){super.init()&&(this._logMethod("Попытка старта следующей рекламы..."),this._play())}_logMethod(e,t=!1,r=!1){this._log(`[second] ${e}`,t,r)}};r.default=a},{"../../../filter/notYoutube":140,"../../manager":162}],170:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../../../../../../player/core/component"))&&i.__esModule?i:{default:i};var o=class extends s.default{constructor(e,t){super(e,t);let r=this.getEl();r.nsAddClass("advert-layout",this.getOption("slot")),this.listenTo(r,"click",()=>{this.trigger("click")})}buildCSSClass(){return`${this.getNs()}-advert-layout ${super.buildCSSClass()}`}};r.default=o},{"../../../../../../player/core/component":279}],171:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("../../../../../../player/core/console")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../manager")),o=n(e("./method/preroll-default")),a=n(e("./method/preroll-second"));function n(e){return e&&e.__esModule?e:{default:e}}const l="default",d="second";var u=class extends s.default{get name(){return"PrerollManager"}init(){let e=this.getPlayer().ns;if(this.CLASS_ENABLE=`${e}-player__ad-${this.slot}-startEnabled`,super.init())return this.disable(),this.once("enable",this._initStartegy),!0;this.disable(!0)}_initStartegy(){this.enable(),this._switchToDefaultMethod()}_setMethod(e){let t;switch(this._log(`Кликовая реклама. Выбран метод показа: ${e}`),i.default.log(`${this._slotName} ${e}`),this._destroyCurrentManager(),this._method=e,e){case l:t=o.default;break;case d:t=a.default;break;default:return}switch(this._manager=new t(this._adManager,{name:this.slot}),this._manager._baseManager=this,e){case l:this._listenDefault();break;case d:this._listenSecond();break;default:return}return this._manager.setSelectorConfig(this._adManager.adSlots[this.slot]),this._manager.init(),this._manager.enable(),this._manager}_listenDefault(){this.listenTo(this._manager,{state:e=>{switch(e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:this._startContent();break;case s.MANAGER_STATE.AD_END:case s.MANAGER_STATE.DESTROY:if(this.blockAdAllowed)return this.state=s.MANAGER_STATE.AD_WAITING,void this._switchToSecondMethod();this._startContent();break;case s.MANAGER_STATE.AD_VIEW:case s.MANAGER_STATE.AD_WAITING:case s.MANAGER_STATE.AD_START:this.disable();break;case s.MANAGER_STATE.READY:this.state=e.state}this.state=e.state},disable:()=>{this.disable()}})}_listenSecond(){this.listenTo(this._manager,{state:e=>{switch(e.state){case s.MANAGER_STATE.AD_ERROR:case s.MANAGER_STATE.EMPTY:case s.MANAGER_STATE.AD_END:this._startContent();break;case s.MANAGER_STATE.AD_VIEW:case s.MANAGER_STATE.AD_WAITING:case s.MANAGER_STATE.AD_START:this.disable();break;case s.MANAGER_STATE.READY:this.state=e.state}this.state=e.state},disable:()=>{this.disable()}})}_startContent(){this.disable(),this._destroyCurrentManager(),this.getPlayer().play()}_destroyCurrentManager(){this._manager&&(this._manager.destroy(),this.stopListening(this._manager),delete this._manager),delete this._method}destroy(){this._destroyCurrentManager(),super.destroy()}_switchToDefaultMethod(){return this._setMethod(l)}_switchToSecondMethod(){return this._setMethod(d)}disable(e=!1){super.disable(e),this.getPlayer().getEl().removeClass(this.CLASS_ENABLE)}enable(){super.enable(),this.getPlayer().getEl().addClass(this.CLASS_ENABLE)}};r.default=u},{"../../../../../../player/core/console":280,"../manager":162,"./method/preroll-default":168,"./method/preroll-second":169}],172:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.promise");var i=u(e("../manager")),s=e("../../../../../../player/providers/default"),o=u(e("../../../../../../player/utils/dom")),a=u(e("../../../../../../player/core/console")),n=u(e("../../advert-selector-vpaid")),l=u(e("../../../../../../player/utils/catchHandler")),d=e("../../lib/managerState");function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function h(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){c(o,i,s,a,n,"next",e)}function n(e){c(o,i,s,a,n,"throw",e)}a(void 0)})}}const p="VPAID: Manager: ",_=!0,g=1,f=30;var m=class extends i.default{get name(){return"VpaidManager"}constructor(e,t={}){super(e,t),this._tryCount=0,this._runCount=0,this._adLoadedSended=!1,this._adStartedSended=!1,this._adSelectorEvents={start:()=>{this._skipped=!1,this._closed=!1,this._runCount++,this._log2("_runPlay: pos: on start")},"click customClick":()=>{this._trigger("AdClickThru",{playerHandles:!1})},close:()=>{this.canNextTry?(this._closed=!0,this._runPlay()):(this._trigger("AdUserClose"),this.destroy())},skip:()=>{this.canNextTry?(this._trigger("AdVideoComplete"),this._skipped=!0,this._runPlay()):(this._trigger("AdSkipped"),this.destroy())},state:e=>{switch(e.state){case"play":this._skipped=!1,this._closed=!1,this._trigger("AdPlaying");break;case"pause":this._trigger("AdPaused")}},finish:()=>{this._trigger("AdVideoComplete"),this.canNextTry?this._runPlay():this.end()},viewmodechange:()=>{},error:e=>{e&&!0===e.fatal||!this.canNextTry?this._runCount>0?this.end():this._triggerError("no active campaigns"):this._runPlay()},"timeout empty":()=>{this.canNextTry?this._runPlay():this._runCount>0?this.end():this._triggerError("no active campaigns")},globalTimeout:()=>{this._runCount>0?this.end():this.destroy()},timeupdate:()=>{const e=this._mc.getProvider();let t=e.duration;if(!1===t||t<0)return;let r=e.currentTime;r>=.25*t&&this._sendPlayEvent("AdVideoFirstQuartile"),r>=.5*t&&this._sendPlayEvent("AdVideoMidpoint"),r>=.75*t&&this._sendPlayEvent("AdVideoThirdQuartile")}},window.parent!==window&&(this._logVpaid("postmessage init..."),(0,o.default)(window).on("message",this._onMessage,this)),this._initGettersSync(),this._send({event:"iframeLoaded"}),this._skipped=!1,this._closed=!1}_logVpaid(e,t=!1){const r=`MV Vpaid [Manager] ${e}`;t?a.default.warn(r):a.default.log(r),this._logDisabled||this.getPlayer().trigger("adSlotLog",{adId:!1,slot:"vpaid",action:e,isError:t})}_createSelector(e,t){return new n.default(e,t)}_initGettersSync(){setInterval(()=>{this._send(null)},200)}_getGettersData(){const e=["adLinear","adWidth","adHeight","adSkippableState","adRemainingTime","adDuration","adVolume","adCompanions","adIcons"];let t={};for(let r=0;r<e.length;r++)t[e[r]]=this[e[r]];return t}_send(e){window.parent.postMessage(JSON.stringify({MoeVideoVpaid:!0,getters:this._getGettersData(),data:e}),"*")}_onMessage(e){if((e=e.originalEvent).source!==window.parent)return;let t=e.data;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}if(!t||!t.MoeVideoVpaid||!t.data)return;let r=(t=t.data).method,i=t.params;if(r&&"function"==typeof this[r]){switch(r){case"initAd":case"resizeAd":case"startAd":case"stopAd":case"pauseAd":case"resumeAd":case"skipAd":this._logVpaid(`call: ${r}`)}this[r].apply(this,i)}}initAd(e,t,r,i,s="",o=""){let a=this.getPlayer(),n=a.getPlugin("backend");a.refInfo=s.refInfo,n&&n.setOption("postbackData",s.pd),this._isFlash=o.isFlash,this.viewMode=r,this.volumeControl.on("volumeChange",e=>{"ad"===e.type&&this._mc&&this._trigger("AdVolumeChange")}),this._runPlay()}set viewMode(e){this._viewMode=e}get vpaidType(){return this._isFlash?"flash":"js"}_triggerError(e){this._logVpaid(`AdError [${e}]`,!0),this._trigger("AdError",e),this.destroy()}resizeAd(e,t,r){this.viewMode=r}_sendInventory(){}startAd(){var e=this;return h(function*(){if(!e.selector.currentAd)return e._triggerError("no active campaigns"),e.selector;let t=!1;if(e.selector.currentAd.once("start wantplay",()=>{t||(t=!0,!1===e._adStartedSended&&(e._trigger("AdStarted"),e._adStartedSended=!0))}),!e._selectorConfig.muteVisibleCheck){e._selectorConfig.sendStartedBeforeVisible&&!1===e._adStartedSended&&(e._trigger("AdStarted"),e._adStartedSended=!0);try{yield e.getPlayer().waitVisible()}catch(e){a.default.error(e)}}setTimeout(()=>{if(!e.selector.startCurrentAdvert())return e._triggerError("no active campaigns"),e.selector},0)})()}get maxAds(){return this.getOption("maxAds")?this.getOption("maxAds"):g}get isLastTry(){return this._runCount+1>=this.maxAds}get canNextTry(){return this._runCount<this.maxAds}_runPlay(){var e=this;return h(function*(){if(e._log2("_runPlay"),e._tryCount++,e._tryCount<=f&&e._runCount<e.maxAds){e._log2(`_runPlay: _runCount < ${f} && _tryCount <= ${g}`);let t=new Promise(e=>{e()});e._tryCount>1&&(e._log2("_runPlay: _tryCount > 1 -> destroyPosition"),t=e._destroySelector());try{yield t,e._play(),e.selector&&(e.selector.loadNextAdInBackground=!e.isLastTry,e._log2("_runPlay: pos not null"))}catch(e){(0,l.default)(e)}}else e._log2(`_runPlay: _runCount: ${e._runCount}; _tryCount: ${e._tryCount} -> end`),e.end()})()}_play(){var e,t=this;if(this.getPlayer().visible&&this.selector.sendInventory(),super._play(),!this.selector)return this._triggerError("no active campaigns"),this.selector;this.selector.once("beforeAdPreloading",()=>{this.selector.sendInventory()}),this.selector.start(!1).then((e=h(function*(e){!1===t._adLoadedSended&&setTimeout(()=>{t._trigger("AdLoaded"),t._adLoadedSended=!0}),t._setMc(e),t._startRemainingTimeChecker();const r=t._selectorConfig.impressionAfterPaid;let i=!1;const s=()=>{!1===t._adStartedSended&&(t._trigger("AdStarted"),t._adStartedSended=!0)},o=()=>{r||i||!t.getPlayer().firstSendEvent()||(t._trigger("AdImpression"),i=!0)};r&&t._mc.once("adPayed",()=>{i||(t._trigger("AdImpression"),i=!0)}),"play"===e.state?(s(),o(),t._trigger("AdVideoStart")):(e.once("start",()=>{s(),t._trigger("AdVideoStart"),o()}),e.once("wantplay",()=>{s(),o()}),t._runCount>0&&e.play())}),function(t){return e.apply(this,arguments)})).catch(()=>{this._runCount>0?this.end():this._triggerError("no active campaigns")})}_startRemainingTimeChecker(){}_waitMc(){return this._waitMcJob?this._waitMcJob:this._mc?Promise.resolve(this._mc):(this._waitMcJob=new Promise(e=>{this.once("_mcStarted",t=>{e(t.mc)})}),this._waitMcJob)}destroy(){this._rtTimer&&clearInterval(this._rtTimer);let e=this._mc;e&&e.state===s.PROVIDER_STATE.PLAY&&(e.pause(),e.hide()),this._skipped&&(this._trigger("AdSkipped"),this._skipped=!1),this._closed&&(this._trigger("AdUserClose"),this._closed=!1),setTimeout(()=>{this._trigger("AdStopped"),super.destroy()},1e3),this.destroy=function(){}}_sendPlayEvent(e){this._playEvents[e]||(this._trigger(e),this._playEvents[e]=!0)}_setMc(e){if(e.controls){let t=e.controls.getControl("fullscreen");t&&t.destroy()}if(this.trigger("_mcStarted",{mc:e}),this._mc)for(let e of Object.keys(this._adSelectorEvents))this._mc.off(e,this._adSelectorEvents[e],this);this._mc=e,this._trigger("AdDurationChange"),this._playEvents={AdVideoFirstQuartile:!1,AdVideoMidpoint:!1,AdVideoThirdQuartile:!1},this.listenTo(e,this._adSelectorEvents)}stopAd(){this.canNextTry?this._runPlay():this.destroy()}pauseAd(){this._waitMc().then(e=>{e.state===s.PROVIDER_STATE.PLAY&&e.pause()}).catch(e=>(0,l.default)(e))}resumeAd(){this._waitMc().then(e=>{e.state!==s.PROVIDER_STATE.PLAY&&e.play()}).catch(e=>(0,l.default)(e))}expandAd(){}collapseAd(){}skipAd(){this.canNextTry?(this._trigger("AdVideoComplete"),this._runPlay(),this._skipped=!0):(this.pauseAd(),this._trigger("AdSkipped"))}end(){this.state=d.MANAGER_STATE.AD_END,this.destroy()}get adLinear(){return!0}get adWidth(){return this.getPlayer().width}get adHeight(){return this.getPlayer().height}get adExpanded(){return!0}get adSkippableState(){return!1}get adRemainingTime(){return this._mc?this._mc.duration-this._mc.currentTime:10}get adDuration(){return this._mc?this._mc.duration:10}get adVolume(){return this.volumeControl.getMuted("ad",this)?0:this.volumeControl.getVolume("ad",this)}setAdVolume(e){this.adVolume=e}set adVolume(e){this.getPlayer().isUserAction()&&this.volumeControl.setMuted(e<=0,"ad",!0,this),this.volumeControl.setVolume(e,"ad",!0,this)}get adCompanions(){return""}get adIcons(){return!0}_trigger(e,t){"AdError"!==e&&this._logVpaid(`event: ${e}`),new Error(e),this._send({event:e,data:t})}_log2(){if(!1===_)return;let e=Array.prototype.slice.call(arguments);e.unshift(p),a.default.log.apply(a.default,e)}};r.default=m},{"../../../../../../player/core/console":280,"../../../../../../player/providers/default":317,"../../../../../../player/utils/catchHandler":327,"../../../../../../player/utils/dom":328,"../../advert-selector-vpaid":128,"../../lib/managerState":149,"../manager":162,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],173:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UNKNOWN_DURATION=r.default=void 0,e("core-js/modules/es6.promise");var i=p(e("../../../../player/core/media-container")),s=p(e("./provider/providers")),o=e("../../../../player/utils/extend"),a=p(e("../../../../player/core/console")),n=p(e("../vast/providers/vast")),l=p(e("../../../../player/core/error")),d=p(e("../../../../player/utils/error")),u=p(e("../../../../player/utils/timer")),c=p(e("../../../../player/env/index")),h=p(e("../../../../player/utils/catchHandler"));function p(e){return e&&e.__esModule?e:{default:e}}let _=0;var g=class extends i.default{constructor(e,t){e.adIdVideo=t.adId;let r=t.serializedProvider;if(r&&(t.video=!1),super(e,t),this._adPreLoadJob=!1,this._notFocusPauseTimer=null,r){let e=s.default.getProvider(r.provider);e&&(this._unserialized=!0,this.setProvider(e.unserialize(this,r.data)))}if(this.once("timeout",()=>{this.triggerError(304,"Ad starting timeout")}),this._isYoutube()&&this.getEl().nsAddClass("media-container","containYoutube"),this.once("error",e=>{300===parseInt(e.code)&&this._tryDetectAdblock()}),this._timerPreload=new u.default,this._timerLoad=new u.default,this._timerPlay=new u.default,this._firstCallOfPlay=!0,this._pausedWhenHidden=!1,this._blockIndex=0,this.getOption("pauseIfNotFocus"))e.on("visibilityChange",this.onFocusChange,this);else{this.onVisibilityChange=this.onVisibilityChange.bind(this);let e=document.webkitVisibilityState?"webkit":document.mozVisibilityState?"moz":null;document.addEventListener(e+"visibilitychange",this.onVisibilityChange)}}serialize(){let e=this.getProvider();return e.serialize().then(t=>{let r=(0,o.clone)(this.getOptions());return r.serializedProvider={provider:e.getName(),data:t},r})}setProvider(e){return this.listenTo(e,{"adPayed adFirstQuartile adMidpoint adThirdQuartile":this.trigger}),super.setProvider(e)}_getVisibleState(){return document.webkitVisibilityState||document.mozVisibilityState||document.visibilityState||"visible"}_isYoutube(){return this.getOption("backPreload")}_tryDetectAdblock(){let e=++_;setTimeout(()=>{_-e>=4&&this._adBlockDetected()},5e3)}_adBlockDetected(){this.getPlayer().getStorage().setItem("adBlock",!0,{expire:1728e5})}_initControls(){return super._initControls().then(()=>{let e=this.getProvider();if(!e.getOption("nativeControls")&&!this._controls&&e instanceof n.default){let e=(0,o.clone)(this.getOption("controls"));e.items={adresume:{}},this._createControls(e)}}).catch(()=>Promise.resolve())}_getWantPlayText(){return"Воспроизведение продолжится после показа рекламы"}get unserialized(){return this._unserialized}_selectProvider(e){return s.default.select(e)}getAdId(){return this.getOption("adId")}getAdSlotId(){return this.getOption("adSlotId")}getAdSlot(){return this.getOption("adSlot")}getAdUuid(){return this.getOption("adUuid")}getCampaignId(){return this.getOption("campaign_id")}getIsRtb(){return this.getOption("is_rtb")}get blockIndex(){return this._blockIndex}set blockIndex(e){this._blockIndex=e}getRedServizeRtbData(){let e=this.getProvider();if(!(e instanceof n.default))return!1;let t=e.getProvider();return!!t&&t.getOption("redServizeRtbData")}adClickThru(e){this.pause(),this.trigger("click",e),e.playerHandles&&e.url&&window.open(e.url)}log(e,t=!1,r="Общее"){this.getPlayer().trigger("adLog",{adId:this.getAdId(),slotId:this.getAdSlotId(),slot:this.getAdSlot(),type:r,time:new Date,action:e,isError:t})}preLoad(e=5e3){if(this._adPreLoadJob)return this._adPreLoadJob;this.log("Предварительная загрузка...");let t=this.getProvider(),r=t?t.getName():"[не найден]";return this.log(`Выбран провайдер: ${r}`),this._timerPreload.start(),this._adPreLoadJob=super.preLoad(e).then(()=>{this._timerPreload.stop(),this.log("Предварительная загрузка выполнена успешно")}).catch(d.default.done()).catch(e=>(this._timerPreload.stop(),(e instanceof l.default||e instanceof Error)&&this.log(e.message,!0),this.log("При предзагрузке рекламного объявления произошла ошибка",!0),Promise.reject(e))),this._adPreLoadJob}load(e=5e3){if(this._loadJob)return this._loadJob;let t=this.getProvider(),r=t?t.getName():"[не найден]";this.log(`Выбран провайдер: ${r}`),this.log("Начало загрузки"),this._timerLoad.start();let i=super.load(e);return i.then(()=>{this._timerLoad.stop(),this.log("Успешно загружена")}).catch(e=>{this._timerLoad.stop(),this.log("Ошибка загрузки",!0)}),this.load=function(){return i},i}play(){this._firstCallOfPlay&&(this._firstCallOfPlay=!1,this._timerPlay.start(),this.once("start",()=>{this._timerPlay.stop()})),(!0===c.default.adSilentAutoplayAlways||!1===c.default.autoPlay&&!0===c.default.silentAutoplay&&!1===this.getPlayer().isUserAction())&&(this.muted=!0),super.play()}get adLoadStat(){return Math.round(this._timerPreload.time+this._timerLoad.time+(this._isYoutube()?0:this._timerPlay.time))}get adLoadStatMSec(){return Math.max(0,Math.round(this._timerPreload.timeMSec+this._timerLoad.timeMSec+(this._isYoutube()?0:this._timerPlay.timeMSec)))}get adFullTimingStat(){return{preload:this._timerPreload.timeMSec>>0,load:this._timerLoad.timeMSec>>0,play:this._isYoutube()?0:this._timerPlay.timeMSec>>0}}onVisibilityChange(){this._onVisibilityChange("visible"===this._getVisibleState())}onFocusChange(e){this._onVisibilityChange(e.visible)}_onVisibilityChange(e){e?(this._notFocusPauseTimer&&(clearTimeout(this._notFocusPauseTimer),this._notFocusPauseTimer=null),!0===this._pausedWhenHidden&&"pause"===this.state&&(a.default.log("FOCUS - play"),this._pausedWhenHidden=!1,this.play())):"play"===this.state&&(this._notFocusPauseTimer&&clearTimeout(this._notFocusPauseTimer),this._notFocusPauseTimer=setTimeout(()=>{a.default.log("NOT FOCUS - pause"),this._pausedWhenHidden=!0,this.pause()},250))}doNotRemoveAfterDestroy(){return!(!this._isYoutube()||!this.getProvider())&&this.volumeChangeSupport()}destroy(){let e=this.getEl();if(e&&e.css({visibility:"hidden",position:"absolute",top:0,left:0,width:"10px",height:"10px",zIndex:-1e3}),this.getOption("pauseIfNotFocus"))this.getPlayer().off("visibilityChange",this.onFocusChange,this);else{let e=document.webkitVisibilityState?"webkit":document.mozVisibilityState?"moz":null;document.removeEventListener(e+"visibilitychange",this.onVisibilityChange)}this._destroyProvider().then(()=>{super.destroy()}).catch(e=>{(0,h.default)(e)})}selectedForShow(){this.log("Выбрана для показа"),this.trigger("selectedForShow")}};r.default=g;r.UNKNOWN_DURATION=30.01010131245},{"../../../../player/core/console":280,"../../../../player/core/error":281,"../../../../player/core/media-container":287,"../../../../player/env/index":306,"../../../../player/utils/catchHandler":327,"../../../../player/utils/error":329,"../../../../player/utils/extend":330,"../../../../player/utils/timer":336,"../vast/providers/vast":223,"./provider/providers":182,"core-js/modules/es6.promise":97}],174:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.split");var i=o(e("../../../../../../player/core/behavior")),s=o(e("../../../../../../common/js/utils/getTime"));o(e("../../../advert/media-container"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{constructor(...e){super(...e),this.exports=["_getPayedThreshold","_payedSuccess","log","setSkippableState","_autoQuartileEvents"]}_sendPayedOnFinish(){return!0}get name(){return"ad-default-provider"}get alias(){return"ad"}_init(){super._init(),this._adConstructor()}_destroy(){super._destroy(),this._stopListenEvents()}_stopListenEvents(){this._base.off("start",this._onStart,this),this._base.off("timeupdate",this._onTimeUptade,this),this._base.off("finish",this._onFinish,this),this._base.off("empty close timeout error",this._onCloseOrError,this)}_getPayedThreshold(){return 3}_autoQuartileEvents(){return!0}_payedSuccess(){const e=this.__base._player.getNameInstrument(this.__base._player._options.plugins.advert.slots),t=this.__base._player.PREFIX_MV_PLAY.split(", ");"content"===e&&this._base._player.isFirstEvents(t)?this._base.triggerOnce("adPayed"):("vast"===e&&this._base._player.firstSendEvent(t),this._base.triggerOnce("adPayed"))}_adConstructor(){this._base.on("start",this._onStart,this)}_onStart(){this._base.getPlayer().volumeControl.setCurrentType("ad",this._base),this._base._setupVolume(),this._startTime=new Date,this._base.on("timeupdate",this._onTimeUptade,this),this._base.on("finish",this._onFinish,this),this._base.on("empty close timeout error",this._onCloseOrError,this)}_onTimeUptade(e){let t=e.target,r=this._base._getPayedThreshold(),i=this._base._autoQuartileEvents(),o=t.duration,a=t.currentTime,n=new Date-this._startTime;(0,s.default)(),this._startTime,!1!==r&&a>r&&n>1e3*r&&this._base._payedSuccess(),i&&(a>=.25*o&&this._base.triggerOnce("adFirstQuartile"),a>=.5*o&&this._base.triggerOnce("adMidpoint"),a>=.75*o&&this._base.triggerOnce("adThirdQuartile"))}_onFinish(){var e;this._base.getPlayer().volumeControl.cancelCurrentType("ad",this._base),!0===(null!==(e=this._base._sendPayedOnFinish)&&void 0!==e?e:this._sendPayedOnFinish)()&&"function"==typeof this._base._payedSuccess&&this._base._payedSuccess(),this._stopListenEvents()}_onCloseOrError(){this._base.getPlayer().volumeControl.cancelCurrentType("ad",this._base),this._stopListenEvents()}setSkippableState(e){this._base.trigger("skippableState",{state:e})}log(e,t=!1){this._base.getMediaContainer().log(e,t,this._base.getName())}};r.default=a},{"../../../../../../common/js/utils/getTime":231,"../../../../../../player/core/behavior":278,"../../../advert/media-container":173,"core-js/modules/es6.regexp.split":104}],175:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=a(e("../../../../../player/providers/default")),o=a(e("./behaviors/default-provider"));function a(e){return e&&e.__esModule?e:{default:e}}let n=(0,e("../../../../../player/core/behavior").behavior)(o.default)(i=class extends s.default{})||i;n.getName=s.default.getName,n.supports=s.default.supports,n.getPriority=s.default.getPriority;var l=n;r.default=l},{"../../../../../player/core/behavior":278,"../../../../../player/providers/default":317,"./behaviors/default-provider":174}],176:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=d(e("../../../../../player/providers/flv")),o=d(e("./providers")),a=d(e("../../../../../player/env/index")),n=d(e("./behaviors/default-provider")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior"));function d(e){return e&&e.__esModule?e:{default:e}}let u=(0,l.behavior)(n.default)(i=class extends s.default{destroy(){super.destroy(),l.default.deleteAll(this)}})||i;u.getName=s.default.getName,u.supports=s.default.supports,u.getPriority=s.default.getPriority,a.default.hasFlash&&o.default.register(u);var c=u;r.default=c},{"../../../../../player/core/behavior":278,"../../../../../player/env/index":306,"../../../../../player/providers/flv":318,"./behaviors/default-provider":174,"./providers":182}],177:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=l(e("../../../../../player/providers/html5-audio")),o=l(e("./providers")),a=l(e("./behaviors/default-provider")),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior"));function l(e){return e&&e.__esModule?e:{default:e}}let d=(0,n.behavior)(a.default)(i=class extends s.default{destroy(){super.destroy(),n.default.deleteAll(this)}})||i;d.getName=s.default.getName,d.supports=s.default.supports,d.getPriority=s.default.getPriority,o.default.register(d);var u=d;r.default=u},{"../../../../../player/core/behavior":278,"../../../../../player/providers/html5-audio":319,"./behaviors/default-provider":174,"./providers":182}],178:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=u(e("../../../../../player/providers/html5")),o=u(e("./providers")),a=u(e("../../../../../player/env/index")),n=u(e("./behaviors/default-provider")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior")),d=e("../../../../../player/providers/default");function u(e){return e&&e.__esModule?e:{default:e}}let c=(0,l.behavior)(n.default)(i=class extends s.default{constructor(e,t){super(e,t)}_getAutoPlaySupported(){return!!a.default.silentAutoplay||super._getAutoPlaySupported()}get preLoadType(){return d.PROVIDER_PRELOAD_TYPE.DOM}preLoad(){return super.preLoad()}_playVideo(){return super._playVideo()}destroy(){super.destroy(),l.default.deleteAll(this)}})||i;c.getName=s.default.getName,c.getPriority=s.default.getPriority,c.supports=function(e){return s.default.supports(e)},o.default.register(c);var h=c;r.default=h},{"../../../../../player/core/behavior":278,"../../../../../player/env/index":306,"../../../../../player/providers/default":317,"../../../../../player/providers/html5":320,"./behaviors/default-provider":174,"./providers":182}],179:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.EVENT_IFRAME_LOADED=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.promise");var i=l(e("./default")),s=e("../../../../../player/providers/default"),o=l(e("./providers")),a=l(e("../../../../../player/utils/dom")),n=l(e("../../../../../player/core/behavior"));l(e("../../../../../player/utils/catchHandler"));function l(e){return e&&e.__esModule?e:{default:e}}let d='<!DOCTYPE html>\n<html lang="en">\n<head><meta charset="UTF-8"></head>\n<body>\n<script type="text/javascript">var inDapIF=true;<\/script>\n{{ html }}\n</body>\n</html>';const u="_iframeLoaded";r.EVENT_IFRAME_LOADED=u;class c extends i.default{static getName(){return"iframe"}static supports(e){return!1}static getPriority(){return 0}constructor(e,t){super(e,t),this._https="https:"===window.location.protocol,this._iframe=!1,this._ci=!1,this._currentTime=0,this._duration=0,this._onMessage=this._onMessage.bind(this)}destroy(){window.removeEventListener("message",this._onMessage),super.destroy(),this._ci&&(clearInterval(this._ci),this._ci=!1),n.default.deleteAll(this)}load(){return Promise.resolve()}_createIframe(){let e=this.getOption("src");e?this._https&&(e=e.replace("http:","https:")):e="about:blank";const t=this._iframe=(0,a.default)("<iframe/>").attr({src:e,width:"100%",height:"100%",frameborder:"0",allowfullscreen:"",allow:"autoplay"}),r=t[0];this.getEl().append(t);let i=this.getOption("html");if(i){let e=d.replace("{{ html }}",i);if(e){let t=r.contentWindow&&r.contentWindow.document;if(!t)return;t.write(e)}}t.on("load",e=>{console.log("iframe load"),this.trigger(u)}),window.addEventListener("message",this._onMessage);let s=new Promise((e,t)=>{this.once(u,()=>{e()}),setTimeout(()=>{t()},this._getFrameLoadingTimeout())});return this._createIframe=function(){return s},s}_getFrameLoadingTimeout(){return 6e3}_onMessage(e){}stopCurrentTimer(){this._ci&&(clearInterval(this._ci),this._ci=!1),this.startCurrentTimer=function(){}}startCurrentTimer(e){if(!this._ci){let t=+new Date;this._ci=setInterval(()=>{let e=+new Date;if(this.state!==s.PROVIDER_STATE.PAUSE){let r=e-t;this._currentTime+=r/1e3,this.trigger("timeupdate"),this._currentTime>=this.duration&&(this.state=s.PROVIDER_STATE.END,clearInterval(this._ci),this._ci=!1)}t=e},e)}}setMetadata(e){e.duration&&(this._duration=e.duration,this.trigger("durationchange"))}play(){this._createIframe().then(()=>{let e=this.getOption("duration",90),t=this.getOption("collapseTime");e&&(this.setMetadata({duration:e}),this.startCurrentTimer(100)),t&&setTimeout(()=>{this.getMediaContainer().viewMode="thumb"},1e3*t),this.state=s.PROVIDER_STATE.PLAY}).catch(()=>{this.triggerError(900,"Ошибка загрузки фрейма")})}get currentTime(){return this._currentTime>>0}get duration(){return this._duration}get buffered(){return 1}_updateVolume(e,t){}}o.default.register(c),c.prototype._options={controls:{volume:!1,mute:!1,progress:!1,fullscreen:!1}};var h=c;r.default=h},{"../../../../../player/core/behavior":278,"../../../../../player/providers/default":317,"../../../../../player/utils/catchHandler":327,"../../../../../player/utils/dom":328,"./default":175,"./providers":182,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],180:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=n(e("../../../../../player/providers/metaprovider")),o=n(e("./behaviors/default-provider")),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior"));function n(e){return e&&e.__esModule?e:{default:e}}let l=(0,a.behavior)(o.default)(i=class extends s.default{_needUserClick(){return this.getMediaContainer().getOption("backPreload")}_getPayedThreshold(){return this._needUserClick()?30:3}_updateVolume(e,t){}destroy(){super.destroy(),a.default.deleteAll(this)}})||i;l.getName=s.default.getName,l.supports=s.default.supports,l.getPriority=s.default.getPriority;var d=l;r.default=d},{"../../../../../player/core/behavior":278,"../../../../../player/providers/metaprovider":321,"./behaviors/default-provider":174}],181:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./iframe")),s=e("../../../../../player/providers/default"),o=l(e("./providers")),a=l(e("../../../../../player/core/console")),n=l(e("../../../../../player/utils/catchHandler"));function l(e){return e&&e.__esModule?e:{default:e}}const d="_apiInit",u="_adLoaded",c="_adError";class h extends i.default{static getName(){return"mv_iframe"}constructor(e,t){super(e,t),this._buffered=1,this._volumeChangeSupporting=!1,this._paidThreshold=3}destroy(){if(!this._mediaContainer.doNotRemoveAfterDestroy())return super.destroy();this.state===s.PROVIDER_STATE.PLAY&&(this._updateVolume(0,!0),this._updateVolume=function(){});const e=this.getPlayer();this.getEl().css({visibility:"hidden",position:"absolute",top:0,left:0,width:e.width+"px",height:e.height+"px",zIndex:-1e3}),this._observer&&(clearInterval(this._observer),this._observer=!1),this._stopStallObserver(),setTimeout(()=>{this.stopListening().off()},0),this.trigger("destroy")}volumeChangeSupport(){return this._volumeChangeSupporting}_getPayedThreshold(){return this._paidThreshold}_isYoutube(){return this.getMediaContainer().getOption("backPreload")}_getAutoPlaySupported(){return void 0!==this._frameSupportAutoPlay?this._frameSupportAutoPlay:super._getAutoPlaySupported()}_onMessage(e){if(this._iframe[0].contentWindow!==e.source)return;let t,r,i;try{t=JSON.parse(e.data)}catch(e){t={}}if(i=t.event,t.MoeVideoAdIframe&&i)switch(r=t.data,i){case"MVApiInit":this._waitApiSuccess();break;case"MvAutoPlaySupported":this._frameSupportAutoPlay=r;break;case"AdLoaded":this.trigger(u);break;case"AdPlaying":this.state=s.PROVIDER_STATE.PLAY,this.getPlayer().trigger("userClick");break;case"AdPaused":this.state=s.PROVIDER_STATE.PAUSE;break;case"AdStopped":this.state=s.PROVIDER_STATE.END;break;case"AdSkipped":this.trigger("skip",{skipTime:this.currentTime}),this.state=s.PROVIDER_STATE.CLOSE;break;case"AdClosed":this.trigger("close",{closeTime:this.currentTime}),this.state=s.PROVIDER_STATE.CLOSE;break;case"AdSkippableState":this.setSkippableState(r.state);break;case"AdDurationChange":this._duration=r.duration,this.setOption("duration",this._duration),this.trigger("durationchange");break;case"AdTimeUpdateSupported":this.stopCurrentTimer();break;case"AdTimeUpdate":this._currentTime=r.currentTime,this.trigger("timeupdate");break;case"AdBufferedUpdate":this._buffered=r.buffered,this.trigger("progress");break;case"AdError":this.trigger(c),this.triggerError(r.code||1e3,r.message,r);break;case"AdClickThru":case"AdUserClick":this.getMediaContainer().adClickThru({playerHandles:!1,url:""});break;case"AdPayedManual":this._paidThreshold=!1;break;case"AdPayed":this._payedSuccess();break;case"Subscribe":switch(r.event){case"volume":let e,t,i=this.getMediaContainer().controls;i&&(e=i.getControl("volume"),t=i.getControl("mute"),e&&e.show(),t&&t.show()),this._volumeChangeSupporting=!0}}}_waitApiSuccess(){a.default.log("iframe api load"),this._apiReady=!0,this.trigger(i.EVENT_IFRAME_LOADED),this.trigger(d)}_waitApi(){let e=new Promise((e,t)=>{this._apiReady?e():this.once(d,e),setTimeout(()=>{t()},500)});return e.catch(()=>{this.triggerError(900,"Ошибка загрузки API")}),this._waitApi=function(){return e},e}_createIframe(){return super._createIframe()}load(e=5e3){return this._loadingPromise||(this._loadingPromise=this._createIframe().then(()=>this._waitApi()).then(()=>new Promise((e,t)=>{this.once(u,e),this.once(c,t),setTimeout(t,this._getFrameLoadingTimeout())})).then(()=>{this.once("start",()=>{let e=this.getOption("duration")||60,t=this.getOption("collapseTime");e&&(this.setMetadata({duration:e}),this.startCurrentTimer(100)),t&&setTimeout(()=>{this.getMediaContainer().viewMode="thumb"},1e3*t)})})),this._loadingPromise}getControls(){return this._isYoutube()?{progress:!1,mute:!1,volume:!1,fullscreen:!1}:this._controls}play(){this.load().then(()=>{this._started?setTimeout(()=>{"pause"===this.state?this._sendEvent("resumeAd"):this._sendEvent("startAd")},0):this._isYoutube()?this.getMediaContainer().trigger("wantplay"):this._sendEvent("startAd")}).catch(e=>(0,n.default)(e))}pause(){this._sendEvent("pauseAd")}stop(){this._sendEvent("stopAd")}_updateVolume(e,t){a.default.log.apply(a.default,["$$$ ad/provides/mv_iframe _updateVolume"].concat(Array.prototype.slice.call(arguments))),this._sendEvent("volume",t?0:e)}get buffered(){return this._buffered}_sendEvent(e,t){this._iframe[0]&&this._iframe[0].contentWindow&&this._iframe[0].contentWindow.postMessage(JSON.stringify({MoeVideoAdIframe:!0,event:e,data:t}),"*")}}i.default.prototype._options={controls:{volume:!1,mute:!1}},h.supports=i.default.supports,h.getPriority=i.default.getPriority,o.default.register(h);var p=h;r.default=p},{"../../../../../player/core/console":280,"../../../../../player/providers/default":317,"../../../../../player/utils/catchHandler":327,"./iframe":179,"./providers":182,"core-js/modules/es6.promise":97}],182:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=e("../../../../../player/providers/providers"),o=(i=e("../../../../../player/core/console"))&&i.__esModule?i:{default:i};var a=new class extends s.ProvidersClass{select(e){if(this._getType(e),e.provider&&("mv_iframe"===e.provider||"iframe"===e.provider||"integration"===e.provider))for(let t=0;t<this._providers.length;t++){let r=this._providers[t];try{if(r.supports(e))return r}catch(e){o.default.error("У провайдера нет функции supports",r)}}return super.select(e)}};r.default=a},{"../../../../../player/core/console":280,"../../../../../player/providers/providers":322}],183:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=l(e("../../../../../player/providers/vimeo")),o=l(e("./providers")),a=l(e("./behaviors/default-provider")),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior"));function l(e){return e&&e.__esModule?e:{default:e}}let d=(0,n.behavior)(a.default)(i=class extends s.default{destroy(){super.destroy(),n.default.deleteAll(this)}})||i;d.getName=s.default.getName,d.supports=s.default.supports,d.getPriority=s.default.getPriority,o.default.register(d);var u=d;r.default=u},{"../../../../../player/core/behavior":278,"../../../../../player/providers/vimeo":323,"./behaviors/default-provider":174,"./providers":182}],184:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=c(e("../../../../../player/providers/youtube")),o=e("../../../../../player/providers/default"),a=c(e("./providers")),n=c(e("../../../../../player/core/error")),l=c(e("./behaviors/default-provider")),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../../../player/core/behavior")),u=e("../../../../../player/utils/math");function c(e){return e&&e.__esModule?e:{default:e}}let h=(0,d.behavior)(l.default)(i=class extends s.default{_needUserClick(){return this.getMediaContainer().getOption("backPreload")}constructor(e,t){super(e,t),this._needUserClick()&&(this.volumeControl.getVolume()<.3&&this.volumeControl.setVolume((0,u.randomInt)(30,60)),this.volumeControl.setMuted(!1),this.on("state",e=>{e.state===o.PROVIDER_STATE.PLAY&&(this.getPlayer().trigger("userClick"),this.volumeControl.setMuted(!1),setTimeout(()=>{this.volumeControl.setMuted(!1)}),setTimeout(()=>{this._video.setVolume(100*this.volumeControl.getVolume()),this._video.unMute()},100))}))}_initYoutubeParams(){return this._needUserClick()?{height:"100%",width:"100%",playerVars:{autoplay:0,enablejsapi:1,playsinline:1,showinfo:1,disablekb:1,modestbranding:0,fs:1,controls:0,iv_load_policy:1,rel:1}}:super._initYoutubeParams()}destroy(){if(!this._needUserClick())return d.default.deleteAll(this),super.destroy();this._beforeDestroy();let e=this.getPlayer();this.getEl().css({visibility:"hidden",position:"absolute",top:0,left:0,width:e.width+"px",height:e.height+"px",zIndex:-1e3}),this._observer&&(clearInterval(this._observer),this._observer=!1),this._stopStallObserver(),setTimeout(()=>{this.stopListening().off(),d.default.deleteAll(this)},0),this.trigger("destroy")}_getPayedThreshold(){return this._needUserClick()||this.getOption("listId")?30:3}getControls(){return this._needUserClick()?{progress:!1,mute:!0,volume:!0,fullscreen:!0,screenplay:!1}:this._controls}load(e=0){let t=super.load(e).then(e=>e).catch(e=>{if("timeout"===e)throw new n.default(this,402,"Таймаут загрузки iframe api");throw e});return this.load=function(){return t},t}play(){if(!this._needUserClick()||this._started)return super.play();this.getMediaContainer().trigger("wantplay")}get qualityChangeSupported(){return!1}_createPoster(){}})||i;h.getName=s.default.getName,h.supports=s.default.supports,h.getPriority=s.default.getPriority,a.default.register(h);var p=h;r.default=p},{"../../../../../player/core/behavior":278,"../../../../../player/core/error":281,"../../../../../player/providers/default":317,"../../../../../player/providers/youtube":324,"../../../../../player/utils/math":332,"./behaviors/default-provider":174,"./providers":182}],185:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"admixer_sect"}getValue(){switch(location.hostname){case"moevideo.biz":return 3752;case"thesame.tv":return 3749;case"playreplay.me":return 3750;default:return 2069}}};r.default=o},{"../default":189}],186:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"admixer_zoneInt"}getValue(){switch(location.hostname){case"moevideo.biz":return 12381;case"thesame.tv":return 12379;case"playreplay.me":return 12380;default:return 8156}}};r.default=o},{"../default":189}],187:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"admixer_zone"}getValue(){switch(location.hostname){case"moevideo.biz":return"fcf149d2-d62a-4eee-8897-1ba1a3a38bfe";case"thesame.tv":return"51526977-aae0-4d42-b976-0ed715344b57";case"playreplay.me":return"af7a06eb-ea06-4b78-a5e3-b473b71b8af7";default:return"101026e5-ede2-40f4-9238-081deecacf5b"}}};r.default=o},{"../default":189}],188:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../default")),s=o(e("../../../lib/slots"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{static getName(){return"advark_type_id"}getValue(){switch(this._vars.ad_slot){case s.default.PAUSE:return 6;case s.default.POST:return 2;case s.default.MID:return 7;default:return 3}}};r.default=a},{"../../../lib/slots":151,"../default":189}],189:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=class{static getName(){return"default"}constructor(e,t,r){this._label=e,this._labelName=t,this._vars=r}_getDefaultValue(){return this._vars[this._labelName]}getValue(){return this._getDefaultValue()}};r.default=i},{}],190:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=e("../../../../../../player/utils/math"),o=(i=e("./default"))&&i.__esModule?i:{default:i};var a=class extends o.default{static getName(){return"duration"}getValue(e,t){let r=this._getDefaultValue();return void 0!==r?r:2===arguments.length?(0,s.randomInt)(+e,+t):60+(200*Math.random()>>0)}};r.default=a},{"../../../../../../player/utils/math":332,"./default":189}],191:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"instreamvideo_puid10"}getValue(){let e=this._vars.width,t=this._vars.height;switch(!0){case e<400||t<225:return 5;case e<639||t<359:return 0;case e<959||t<539:return 1;case e<1279||t<719:return 2;default:return 3}}};r.default=o},{"../default":189}],192:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../default")),s=o(e("../../../../../../../player/env/index"));function o(e){return e&&e.__esModule?e:{default:e}}const a=13,n=16;var l=class extends i.default{static getName(){return"instreamvideo_puid12"}getValue(){return s.default.hasFlash?a:n}};r.default=l},{"../../../../../../../player/env/index":306,"../default":189}],193:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"instreamvideo_puid8"}getValue(){let e=this._vars.duration||0,t=[30,60,90,120,180,240,300,600,900,1800,3600,5400,7200];for(let r=0;r<t.length;r++)if(t[r]>e)return r;return 13}};r.default=o},{"../default":189}],194:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../default")),s=o(e("../../../lib/slots"));function o(e){return e&&e.__esModule?e:{default:e}}const a=1,n=2,l=3,d=4;var u=class extends i.default{static getName(){return"instreamvideo_vr"}getValue(){switch(this._vars.ad_slot){case s.default.PAUSE:return l;case s.default.POST:return d;case s.default.MID:return n;default:return a}}};r.default=u},{"../../../lib/slots":151,"../default":189}],195:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"mediatoday_puid10"}getValue(){let e=this._vars.width,t=this._vars.height;switch(!0){case e<400||t<225:return 5;case e<639||t<359:return 0;case e<959||t<539:return 1;case e<1279||t<719:return 2;default:return 3}}};r.default=o},{"../default":189}],196:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"mediatoday_puid8"}getValue(){let e=this._vars.duration||0,t=[30,60,90,120,180,240,300,600,900,1800,3600,5400,7200];for(let r=0;r<t.length;r++)if(t[r]>e)return r;return 13}};r.default=o},{"../default":189}],197:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../default")),s=o(e("../../../lib/slots"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{static getName(){return"mediatoday_vr"}getValue(){switch(this._vars.ad_slot){case s.default.PAUSE:return 3;case s.default.POST:return 4;case s.default.MID:return 2;default:return 1}}};r.default=a},{"../../../lib/slots":151,"../default":189}],198:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};var o=class extends s.default{static getName(){return"pladform_dl"}getValue(){return`http://${location.hostname}`}};r.default=o},{"../default":189}],199:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i};let o={"moevideo.net":12683,"thesame.tv":97219,"moevideo.biz":105599,"playreplay.me":105600};var a=class extends s.default{static getName(){return"pladform_pl"}getValue(){return o.hasOwnProperty(location.hostname)?o[location.hostname]:o["playreplay.me"]}};r.default=a},{"../default":189}],200:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=e("../../../../../../player/utils/math"),o=(i=e("./default"))&&i.__esModule?i:{default:i};var a=class extends o.default{static getName(){return"random"}getValue(e,t){return 2===arguments.length?(0,s.randomInt)(+e,+t):1e7*Math.random()>>0}};r.default=a},{"../../../../../../player/utils/math":332,"./default":189}],201:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("../default")),s=o(e("../../../lib/slots"));function o(e){return e&&e.__esModule?e:{default:e}}const a=1,n=2,l=3,d=4,u=5,c=6,h=8;var p=class extends i.default{static getName(){return"rs_slot_id"}getValue(){switch(this._vars.ad_slot){case s.default.AUTO:return l;case s.default.PRE:return a;case s.default.PAUSE:return d;case s.default.POST:return n;case s.default.MID:return u;case s.default.CONTENT:return c;default:return h}}};r.default=p},{"../../../lib/slots":151,"../default":189}],202:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../default"))&&i.__esModule?i:{default:i},o=e("../../../../../../../player/env/canplay");var a=class extends s.default{static getName(){return"redservize_canplay"}getValue(){const e={"video/mp4":1,"video/webm":2,"video/x-flv":3,"application/x-shockwave-flash":4,"application/javascript":5},t=[];for(let r in e)e.hasOwnProperty(r)&&(0,o.mimeTypeSupport)(r)&&t.push(e[r]);return t.join(",")}};r.default=a},{"../../../../../../../player/env/canplay":304,"../default":189}],203:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.regexp.match");var i=b(e("./label/default")),s=b(e("./label/duration")),o=b(e("./label/random")),a=b(e("./label/mediatoday/puid8")),n=b(e("./label/mediatoday/puid10")),l=b(e("./label/mediatoday/vr")),d=b(e("./label/advark/type_id")),u=b(e("./label/instreamvideo/InstreamvideoVrLabel")),c=b(e("./label/instreamvideo/InstreamvideoPuid8Label")),h=b(e("./label/instreamvideo/InstreamvideoPuid10Label")),p=b(e("./label/instreamvideo/InstreamvideoPuid12Label")),_=b(e("./label/pladform/pl")),g=b(e("./label/pladform/dl")),f=b(e("./label/admixer/AdMixerZoneLabel")),m=b(e("./label/admixer/AdMixerZoneIntLabel")),A=b(e("./label/admixer/AdMixerSectLabel")),v=b(e("./label/rs/RedServiceSlotIdLabel")),y=b(e("./label/rs/RedservizeCanplayLabel"));function b(e){return e&&e.__esModule?e:{default:e}}let P={};class T{static registerLabelWorkers(e){for(let t=0;t<e.length;t++)P[e[t].getName()]=e[t]}static getWorker(e,t,r){let i;return new(i=P.hasOwnProperty(t)?P[t]:P.default)(e,t,r)}static replace(e,t,r){let i,s=/\[\s*([^\](]+)\s*(?:\(([^(]+)\))?\s*\]/,o={},a=0,n={},l=e;for(;i=e.match(s);){let s,d,u=i[0],c=i[1].trim(),h=(i[2]||"").trim();if(h){h=h.split(",");for(let e=0;e<h.length;e++)h[e]=h[e].trim()}else h=[];void 0===(s=(d=this.getWorker(u,c,t)).getValue.apply(d,h))?(r.trigger("adUrlReplacerError",{url:l,label:u}),s=u):s=encodeURIComponent(s);let p="{{MV_"+a+"_"+Date.now()+"_MV}}";if(n[p]=s,o[u]={key:c,params:h,replacement:s},e=e.replace(u,p),a++>100)break}for(let t in n)n.hasOwnProperty(t)&&(e=e.replace(t,n[t]));return e}}T.registerLabelWorkers([i.default,s.default,o.default,a.default,n.default,l.default,d.default,u.default,c.default,h.default,p.default,_.default,g.default,f.default,m.default,A.default,v.default,y.default]);var w=T;r.default=w},{"./label/admixer/AdMixerSectLabel":185,"./label/admixer/AdMixerZoneIntLabel":186,"./label/admixer/AdMixerZoneLabel":187,"./label/advark/type_id":188,"./label/default":189,"./label/duration":190,"./label/instreamvideo/InstreamvideoPuid10Label":191,"./label/instreamvideo/InstreamvideoPuid12Label":192,"./label/instreamvideo/InstreamvideoPuid8Label":193,"./label/instreamvideo/InstreamvideoVrLabel":194,"./label/mediatoday/puid10":195,"./label/mediatoday/puid8":196,"./label/mediatoday/vr":197,"./label/pladform/dl":198,"./label/pladform/pl":199,"./label/random":200,"./label/rs/RedServiceSlotIdLabel":201,"./label/rs/RedservizeCanplayLabel":202,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104}],204:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i,s=d(e("./integration-base-provider")),o=e("../../../../../../common/js/utils/string"),a=e("../../../../../../player/core/behavior"),n=d(e("../../../advert/provider/behaviors/default-provider")),l=e("../../../../../../player/providers/default");function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function c(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){u(o,i,s,a,n,"next",e)}function n(e){u(o,i,s,a,n,"throw",e)}a(void 0)})}}var h=(0,a.behavior)(n.default)(i=class extends s.default{constructor(...e){super(...e),this.IS_DEBUG=!0,this.LOG_PREFIX="IntegrationScriptProvider: ",this._eventsList=[],this._eventsRename={},this._eventsCamelCase=!0}_getScriptUrl(){}load(e=5e3){var t=this;return c(function*(){return t._loadingPromise||(t._loadingPromise=t._createPlayer()),t._loadingPromise})()}play(){var e=this,t=(...e)=>super.play.apply(this,e);return c(function*(){if(t(),e._playerInitialized()||e._playerInitializePromise||(e._playerInitializePromise=new Promise(function(){var t=c(function*(t,r){try{yield e._initPlayer(),e._initEvents(),e._playerInitializePromise=void 0,t()}catch(t){e.state=l.PROVIDER_STATE.ERROR,e.triggerError(405,"playback error ["+("object"==typeof t&&"string"==typeof t.message?t.message:t||"")+"]"),e._playerInitializePromise=void 0,r()}});return function(e,r){return t.apply(this,arguments)}}())),e._playerInitializePromise)return e._playerInitializePromise;e._play()})()}_createPlayer(e=5e3){var t=this;return c(function*(){try{return yield t.appendScriptTag(),t._createContainer(),t._appendContainer(),t.onPlayerResize(),!0}catch(e){return!1}})()}_initPlayer(){return c(function*(){})()}_playerInitialized(){}_play(){}get _containerCSSClass(){return this.getName()+"__container_"+this.__count}get _containerId(){return this.getName()+"__container_"+this.__count}_createContainer(){this._container=document.createElement("div"),this._containerId&&(this._container.id=this._containerId),this._containerCSSClass&&this._container.classList.add(this._containerCSSClass)}_appendContainer(){this.getEl()[0].appendChild(this._container),this._hideContainer()}_hideContainer(){this._container&&(this._container.style.opacity="0.01")}_showContainer(){this._container&&(this._container.style.opacity="1")}_initEvents(){for(const e of this._eventsList){const t=e in this._eventsRename?this._eventsRename[e]:e,r=this._eventsCamelCase?(0,o.camelCase)("on_"+t):t;"function"==typeof this[r]&&this._addEventListenerToPlayer(e,this[r])}}_addEventListenerToPlayer(e,t){}_removeEventListenersFromPlayer(){}appendScriptTag(e=this._getScriptUrl(),t=!0,r=5e3){return c(function*(){return new Promise((i,s)=>{let o=setTimeout(()=>{s()},r),a=document.createElement("script");a.src=e,t&&(a.async=t),a.type="text/javascript",a.addEventListener("load",()=>{o&&(clearTimeout(o),o=null),i(!0)}),a.addEventListener("error",()=>{o&&(clearTimeout(o),o=null),s()}),document.head.appendChild(a)})})()}})||i;r.default=h},{"../../../../../../common/js/utils/string":234,"../../../../../../player/core/behavior":278,"../../../../../../player/providers/default":317,"../../../advert/provider/behaviors/default-provider":174,"./integration-base-provider":205,"core-js/modules/es6.promise":97}],205:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.split"),e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes"),e("core-js/modules/es6.string.starts-with");var i,s=d(e("../../../advert/provider/default")),o=e("../../../../../../player/core/behavior"),a=d(e("../../../advert/provider/behaviors/default-provider")),n=(d(e("../../../../../../player/providers/behaviors/provider-auto-time")),e("../../../../../../player/providers/default")),l=d(e("../../../../../../player/core/console.js"));function d(e){return e&&e.__esModule?e:{default:e}}let u=0;var c=(0,o.behavior)(a.default)(i=class extends s.default{static supports(e){return e&&"src"in e&&e.src.startsWith(`//${this.getName()}/`)}static getPriority(){return 1}constructor(e,t){super(e,t),this.IS_DEBUG=!0,this.LOG_PREFIX="IntegrationBaseProvider: ",this._integrationSettings=null,this._integrationSettingsInitialized=!1,this.__count=u++,setTimeout(()=>{this._setupIntegrationSettings()}),this.getPlayer().on("resize",this.onPlayerResize,this)}get integrationSettings(){return this._integrationSettings&&this._integrationSettingsInitialized||this._setupIntegrationSettings(),this._integrationSettings}_setupIntegrationSettings(){this._integrationSettings=this._integrationSettings&&"object"==typeof this._integrationSettings?this._integrationSettings:{},this._integrationSettingsInitialized=!0;const e=this.getOption("src");if(e.startsWith("//")&&e.includes("{")&&e.includes("}")){const t=e.split("/").pop();try{const e=JSON.parse(t);for(let t in e)e.hasOwnProperty(t)&&(this._integrationSettings[t]=e[t])}catch(e){this.triggerError(405,e)}}}onPlayerResize(){}triggerClickThru(e=""){this.getMediaContainer().adClickThru({playerHandles:!1,url:e})}triggerSkip(){this.trigger("skip",{skipTime:this.currentTime}),this.state=n.PROVIDER_STATE.CLOSE}_log2(){if(!1===this.IS_DEBUG)return;let e=Array.prototype.slice.call(arguments);e&&e.length>0&&("string"==typeof e[0]||"number"==typeof e[0]?e[0]=this.LOG_PREFIX+e[0]:e=[this.LOG_PREFIX]+e),l.default.log.apply(l.default,e)}})||i;r.default=c},{"../../../../../../player/core/behavior":278,"../../../../../../player/core/console.js":280,"../../../../../../player/providers/behaviors/provider-auto-time":316,"../../../../../../player/providers/default":317,"../../../advert/provider/behaviors/default-provider":174,"../../../advert/provider/default":175,"core-js/modules/es6.regexp.split":104,"core-js/modules/es6.string.includes":107,"core-js/modules/es6.string.starts-with":108,"core-js/modules/es7.array.includes":111}],206:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.EVENT_FRAME_LOADED=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.string.ends-with"),e("core-js/modules/es6.string.starts-with"),e("core-js/modules/es6.promise");var i,s,o=_(e("../../../advert/provider/behaviors/default-provider")),a=e("../../../../../../player/core/behavior"),n=_(e("../../../../../../player/providers/behaviors/provider-auto-time")),l=_(e("../../../../../../player/utils/dom")),d=e("../../../../../../common/js/utils/string"),u=e("../../../../../../player/providers/default"),c=_(e("./integration-base-provider")),h=_(e("../../../../../../common/js/decorators/autobind")),p=_(e("../../../../../../player/utils/catchHandler"));function _(e){return e&&e.__esModule?e:{default:e}}function g(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){g(o,i,s,a,n,"next",e)}function n(e){g(o,i,s,a,n,"throw",e)}a(void 0)})}}r.EVENT_FRAME_LOADED="__frame_loaded";var m,A,v,y,b,P,T=(0,a.behavior)(o.default)((m=(s=class extends c.default{get _propAutoTimeCheckComplete(){return!0}get _autoPlayIframe(){return!1}constructor(e,t){super(e,t),this.IS_DEBUG=!0,this.LOG_PREFIX="IntegrationIFrameProvider: ",this._$frame=void 0,this._frame=void 0,this._waitAfterDestroyIFrame=2e3,this._duration=300,this._autoTime=!0,this._eventsNamePrefix="",this._eventsNameToLowerCase=!1,this._https="https:"===window.location.protocol,this._autoTime&&n.default.attach(this,null,{checkComplete:this._propAutoTimeCheckComplete})}_autoQuartileEvents(){return!this._autoTime}_hideFrame(){this._frame&&(this._frame.style.opacity=.001)}_showFrame(){this._frame&&(this._frame.style.opacity=1)}destroy(){super.destroy(),this._hideFrame(),setTimeout(()=>{this._destroyIFrame()},this._waitAfterDestroyIFrame)}_destroyIFrame(){this._$frame&&(this._$frame.remove(),this._frame=this._$frame=null)}get preLoadType(){return this._autoPlayIframe?u.PROVIDER_PRELOAD_TYPE.SILENT:u.PROVIDER_PRELOAD_TYPE.DOM}preLoad(e=5e3){var t=this,r=(...e)=>super.preLoad.apply(this,e);return f(function*(){return t.preLoadType===u.PROVIDER_PRELOAD_TYPE.DOM?t._internalLoad(e):r()})()}load(e=5e3){var t=this;return f(function*(){return t._internalLoad(e)})()}_internalLoad(e=5e3){var t=this;return f(function*(){return t._loadingPromise||(t._loadingPromise=new Promise(function(){var r=f(function*(r,i){let s=setTimeout(()=>{i()},e);if(t._initEvents(),!1===t._autoPlayIframe){let r=!1;try{yield t._createIframe(e),r=yield t._waitAd()}catch(e){i(e)}finally{r||i("integration-iframe-provider load fail")}}else setTimeout(()=>{t.state=u.PROVIDER_STATE.WAITING});s&&(clearTimeout(s),s=null),r()});return function(e,t){return r.apply(this,arguments)}}())),t._loadingPromise})()}play(){super.play(),!0===this._autoPlayIframe&&this._createIframe().then(()=>this._waitAd()).catch(e=>(0,p.default)(e))}_getIFrameUrl(){}_createIframe(e=5e3){var t=this;return f(function*(){return new Promise((r,i)=>{let s=setTimeout(()=>{i()},e);t.once("__frame_loaded",()=>{s&&(clearTimeout(s),s=void 0),t._$frame=a,t._frame=a[0],r()});const o=t._getIFrameUrl(),a=t._iframe=(0,l.default)("<iframe/>").attr({src:o,width:"100%",height:"100%",scrolling:"no",frameborder:"no",allowfullscreen:"",mozallowfullscreen:"",webkitallowfullscreen:"",allow:"autoplay"}),n=a[0];n.style.width="100%",n.style.height="100%",a.on("load",()=>{t.trigger("__frame_loaded")}),t.getEl().append(a)})})()}_getIFrameEventData(e){return e&&e.data&&"string"==typeof e.data&&!1===e.data.startsWith("{")&&!1===e.data.endsWith("}")?{name:e.data}:null}_initEvents(){window.addEventListener("message",this._onPostMessage)}_onPostMessage(e){if(this._destroyed||!this._iframe)return;const t=this._iframe?this._iframe[0].contentWindow:null;if(e.source!==t)return;let r=this._getIFrameEventData(e);if(r){let e=r.name;if(this._eventsNameToLowerCase&&(e=e.toLowerCase()),this._eventsNamePrefix){if(!1===e.startsWith(this._eventsNamePrefix))return;e=e.substr(this._eventsNamePrefix.length)}const t=(0,d.camelCase)("on-"+e);this[t]?(this._log2(`iframe event "${e}" - call method "${t}"`),this[t](r)):this._log2(`iframe event "${e}"`)}}_waitAd(){return f(function*(){return Promise.resolve(!0)})()}get duration(){return this._duration}set duration(e){this.setDuration(e)}setDuration(e){e=Math.max(0,e),this._duration!==e&&(this._duration=e,this.trigger("durationchange"))}}).prototype,A="_onPostMessage",v=[h.default],y=Object.getOwnPropertyDescriptor(s.prototype,"_onPostMessage"),b=s.prototype,P={},Object.keys(y).forEach(function(e){P[e]=y[e]}),P.enumerable=!!P.enumerable,P.configurable=!!P.configurable,("value"in P||P.initializer)&&(P.writable=!0),P=v.slice().reverse().reduce(function(e,t){return t(m,A,e)||e},P),b&&void 0!==P.initializer&&(P.value=P.initializer?P.initializer.call(b):void 0,P.initializer=void 0),void 0===P.initializer&&(Object.defineProperty(m,A,P),P=null),i=s))||i;r.default=T},{"../../../../../../common/js/decorators/autobind":228,"../../../../../../common/js/utils/string":234,"../../../../../../player/core/behavior":278,"../../../../../../player/providers/behaviors/provider-auto-time":316,"../../../../../../player/providers/default":317,"../../../../../../player/utils/catchHandler":327,"../../../../../../player/utils/dom":328,"../../../advert/provider/behaviors/default-provider":174,"./integration-base-provider":205,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/es6.string.ends-with":106,"core-js/modules/es6.string.starts-with":108,"core-js/modules/web.dom.iterable":115}],207:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.string.starts-with");(i=e("../../../../../../player/utils/url"))&&i.__esModule;var i,s=e("../../../../../../player/providers/default"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../base/integration-iframe-provider"));class a extends o.default{constructor(e,t){super(e,t),this.IMPRESSION_TIMEOUT=3e3,this.CONTENT_SHOW_TIME=3e4,this.glossaryEvents={READY_INTRO:this.onReady.bind(this),PLAYING_INTRO:"",INTRO_ENDED:this.start.bind(this),ADS_STARTED:"",ADS_ENDED:"",READY_VIDEO:this.onReady.bind(this),VIDEO_STARTED:this.onVideoStart.bind(this),PLAYING_VIDEO:"",VIDEO_25:"",VIDEO_50:"",VIDEO_75:"",VIDEO_ENDED:this.onVideoEnded.bind(this)},this.contentList=["vyyti-nelyzya-ostatysya","pikselynyy-razum"],this._listenFrame()}static getName(){return"chill"}static supports({src:e}){return e.startsWith("//chill")}_getIFrameUrl(){if(this.integrationSettings.test)return"https://chillvision.ru/embed/intro_test/";return`https://chillvision.ru/embed/${this.contentList[this.getRandomNumber(this.contentList.length-1)]}/`}getRandomNumber(e){return Math.floor(Math.random()*(e+1))}_getPayedThreshold(){return!1}play(){this._showFrame(),this.state=s.PROVIDER_STATE.PLAY,this._sendMessage("PLAY"),this._sendMessage("MUTE")}start(){}_sendMessage(e){this._log2("send to chill",e),this._frame.contentWindow.postMessage(e,"*")}_listenFrame(){window.addEventListener("message",this.eventHandling.bind(this))}eventHandling(e){"https://chillvision.ru"===e.origin&&'{"type":"sr"}'!==e.data&&this.glossaryEvents[e.data]&&this.glossaryEvents[e.data]()}onReady(){this.play()}onVideoStart(){setTimeout(()=>{this._payedSuccess()},this.IMPRESSION_TIMEOUT),setTimeout(()=>{this.onVideoEnded()},this.CONTENT_SHOW_TIME)}onVideoEnded(){this._hideFrame(),this.triggerSkip(),this.state=s.PROVIDER_STATE.END}onQuartile25(){this.triggerOnce("adFirstQuartile")}onQuartile50(){this.triggerOnce("adMidpoint")}onQuartile75(){this.triggerOnce("adThirdQuartile")}}a.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var n=a;r.default=n},{"../../../../../../player/providers/default":317,"../../../../../../player/utils/url":338,"../base/integration-iframe-provider":206,"core-js/modules/es6.string.starts-with":108}],208:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.string.starts-with");var i,s=e("../../../../../../player/providers/default"),o=l(e("../base/integration-iframe-provider")),a=l(e("../../../../../../player/env")),n=l(e("../../../../../../common/js/decorators/autobind"));l(e("../../../advert/url/url"));function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function u(e,t,r,i,s){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let c=(u((i=class extends o.default{get _propAutoTimeCheckComplete(){return!1}constructor(e,t){super(e,t),this.IS_DEBUG=!0,this.LOG_PREFIX="MegogoAdProvider: ",this._adAsked=!1,this._hasAd=!1,this._ad=null,this._adIndex=0,this._payedSuccessTimeout=null,this.__waitAdPromise=void 0,this._lastAdDuration=0,this._skipped=!1,this._imp=!1,this._waitPlayTimeout=null,this._eventsNamePrefix="mgg_"}static getName(){return"megogo-iframe"}static supports(e){return super.supports(e)||e&&e.src&&e.src.startsWith("//megogo/")}_getPayedThreshold(){return!1}get duration(){return 300}_updateVolume(e,t){}_getAutoPlaySupported(){return!!a.default.silentAutoplay||super._getAutoPlaySupported()}get _autoPlayIframe(){return!0}_createIframe(e=5e3){var t,r=this,i=(...e)=>super._createIframe.apply(this,e);return(t=function*(){return i(e).then(e=>(r._hideFrame(),e))},function(){var e=this,r=arguments;return new Promise(function(i,s){var o=t.apply(e,r);function a(e){d(o,i,s,a,n,"next",e)}function n(e){d(o,i,s,a,n,"throw",e)}a(void 0)})})()}play(){super.play(),this._hideFrame(),!this._hasAd||this.state!==s.PROVIDER_STATE.WAITING&&this.state!==s.PROVIDER_STATE.PAUSE||(this._clearWaitTimeout(),this._waitPlayTimeout=setTimeout(()=>{this._clearWaitTimeout(),this._hasAd=!1,this.triggerError(405,"playback error")},3e3))}_clearWaitTimeout(){this._waitPlayTimeout&&(clearTimeout(this._waitPlayTimeout),this._waitPlayTimeout=null)}pause(){}stop(){}_getIFrameUrl(){const e="id"in this.integrationSettings?this.integrationSettings.id:333951,t="ref"in this.integrationSettings?this.integrationSettings.ref:null;let r=`https://embed.megogo.net/ev3/player?id=${e}&autoplay=1&referer={referer}&muted=1`;const i=this.getPlayer().getPlugin("backend");return t?r=r.replace("{referer}",t):i&&(r=r.replace("{referer}",i.getOption("ref",""))),r}_payedSuccessIdle(){this._payedSuccessTimeout||(this._payedSuccessTimeout=setTimeout(()=>{this._imp=!0,this._payedSuccess(),this._impIdle=!1},3e3))}onAskAd(...e){}onHasAd1(...e){this._showFrame(),this._hasAd=!0,this._ad=1,this._impIdle&&!this._imp&&(this._imp=!0,this._payedSuccessIdle(),this._impIdle=!1)}onHasAd2(...e){this._showFrame(),this._hasAd=!0,this._ad=2,this._impIdle&&!this._imp&&(this._imp=!0,this._payedSuccessIdle(),this._impIdle=!1)}onStartAd(...e){this._showFrame(),this.state=s.PROVIDER_STATE.PLAY,this._hasAd=!0,this._adIndex++,this._skipped=!1,this._lastAdDuration=this.currentTime,this._clearWaitTimeout(),this._impIdle&&!this._imp&&(this._imp=!0,this._payedSuccessIdle(),this._impIdle=!1)}onImpAd(...e){this._hasAd?(this._imp=!0,this._payedSuccess(),this._impIdle=!1):this._impIdle=!0}onEndAd(...e){this._hideFrame();let t=Math.max(0,this.currentTime-this._lastAdDuration);this.setDuration(this._lastAdDuration+t+1),this._lastAdDuration=this.currentTime,this.state=s.PROVIDER_STATE.END}onClickAd(...e){this.triggerClickThru()}onStartContent(...e){this._hideFrame(),this._hasAd?this._imp?(this._skipped=!0,this.triggerSkip(),this.state=s.PROVIDER_STATE.CLOSE):(this._hasAd=!1,this.triggerError(405,"playback error")):(this._hasAd=!1,this.triggerError(303,"No Ads"))}on1QuartAd(...e){1===this._adIndex&&this.triggerOnce("adFirstQuartile");let t=4*Math.max(0,this.currentTime-this._lastAdDuration);this.setDuration(this._lastAdDuration+t+1)}onMidpointAd(...e){1===this._adIndex&&this.triggerOnce("adMidpoint");let t=2*Math.max(0,this.currentTime-this._lastAdDuration);this.setDuration(this._lastAdDuration+t+1)}on3QuartAd(...e){1===this._adIndex&&this.triggerOnce("adThirdQuartile");let t=Math.max(0,this.currentTime-this._lastAdDuration)/3*4;this.setDuration(this._lastAdDuration+t+1)}}).prototype,"onAskAd",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onAskAd"),i.prototype),u(i.prototype,"onHasAd1",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onHasAd1"),i.prototype),u(i.prototype,"onHasAd2",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onHasAd2"),i.prototype),u(i.prototype,"onStartAd",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onStartAd"),i.prototype),u(i.prototype,"onImpAd",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onImpAd"),i.prototype),u(i.prototype,"onEndAd",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onEndAd"),i.prototype),u(i.prototype,"onClickAd",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onClickAd"),i.prototype),u(i.prototype,"onStartContent",[n.default],Object.getOwnPropertyDescriptor(i.prototype,"onStartContent"),i.prototype),i);c.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var h=c;r.default=h},{"../../../../../../common/js/decorators/autobind":228,"../../../../../../player/env":306,"../../../../../../player/providers/default":317,"../../../advert/url/url":203,"../base/integration-iframe-provider":206,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.string.starts-with":108,"core-js/modules/web.dom.iterable":115}],209:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=u(e("../../advert/provider/providers")),s=u(e("./showjet/showjet-iframe-provider")),o=u(e("./rambler/rambler-eagle-provider")),a=u(e("./tvigle/tvigle-iframe-provider")),n=u(e("./yandex/yandex-provider")),l=u(e("./megogo/megogo-iframe-provider")),d=u(e("./chill/chill-provider"));function u(e){return e&&e.__esModule?e:{default:e}}i.default.register(s.default),i.default.register(o.default),i.default.register(a.default),i.default.register(n.default),i.default.register(l.default),i.default.register(d.default);var c=[s.default,o.default,a.default,n.default,l.default,d.default];r.default=c},{"../../advert/provider/providers":182,"./chill/chill-provider":207,"./megogo/megogo-iframe-provider":208,"./rambler/rambler-eagle-provider":210,"./showjet/showjet-iframe-provider":211,"./tvigle/tvigle-iframe-provider":212,"./yandex/yandex-provider":216}],210:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.string.starts-with");var i,s,o=e("../../../../../../player/providers/default"),a=h(e("../../../../../../player/env")),n=h(e("../../../../../../player/providers/behaviors/provider-auto-time")),l=e("../../../../../../player/core/behavior"),d=h(e("../../../advert/provider/behaviors/default-provider")),u=h(e("../../../../../../common/js/decorators/autobind")),c=h(e("../base/Integration-script-provider"));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(null==e)return{};var r,i,s=function(e,t){if(null==e)return{};var r,i,s={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function _(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function g(e,t,r,i,s){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}const f={src:"https://rvtest.media.eagleplatform.com/player/player.js",id:"eagleplatformjs",type:"text/javascript",async:!0},m={src:"https://lentaru.media.eagleplatform.com/player/player.js",id:"eagleplatformjs",type:"text/javascript",async:!0};let A=(0,l.behavior)(d.default,[n.default,{checkComplete:!1}])((g((s=class extends c.default{constructor(e,t){var r,i,s;super(e,t),this.IS_DEBUG=!0,this.LOG_PREFIX="RamblerEagleProvider: ",this._eaglePlayer=null,this._testMode=!1,this._eventsList=["advertisement_state","advertisement_load","advertisement_video_state","fullscreen","resize","timeupdate","seek","loaded_position","stop","playing","play","reload","ended","start"],this._eventsRename={advertisement_state:"ad_state",advertisement_load:"ad_load",advertisement_video_state:"ad_video_state",fullscreen:"full_screen",timeupdate:"time_update"},this.setOption("videoId",this._testMode?1051650:null===(r=this.integrationSettings)||void 0===r?void 0:r.id),this.setOption("width",null===(i=this.integrationSettings)||void 0===i?void 0:i.width),this.setOption("height",null===(s=this.integrationSettings)||void 0===s?void 0:s.height)}static getName(){return"rambler-eagle"}static supports(e){return super.supports(e)||e&&e.src&&e.src.startsWith("//rambler-eagle/")}get _containerCSSClass(){return this.getName()+"__eagle-player-"+this.__count}get _containerId(){return this.getOption("videoId")}get duration(){return 120}_getAutoPlaySupported(){return!!a.default.silentAutoplay||super._getAutoPlaySupported()}destroy(){super.destroy(),this._startDestroyEagleTimer()}_startDestroyEagleTimer(){this._eaglePlayer&&(this._destroyEagleTimerout||(this._destroyEagleTimerout=setTimeout(this._destroyEagle,2e3)))}_destroyEagle(){this._destroyEagleTimerout&&(clearTimeout(this._destroyEagleTimerout),this._destroyEagleTimerout=void 0),this._eaglePlayer&&(this._removeEventListenersFromPlayer(),setTimeout(()=>{try{this._eaglePlayer.assignMedia()}catch(e){}delete this._eaglePlayer,this._eaglePlayer=void 0,EaglePlayer=void 0,eaglePlayerGlobals=void 0,eaglePlayerPlugins=void 0,eaglePlayers=void 0,eagle_translations=void 0},0)),this._container&&(this._container.remove(),this._container=null)}_updateVolume(e,t){this._eaglePlayer&&(t?(this._eaglePlayer.mute(!0),this._eaglePlayer.volume(0)):(this._eaglePlayer.mute(!1),this._eaglePlayer.volume(e)))}_getScriptUrl(){return(this._testMode?m:f).src}_createContainer(){super._createContainer();const e=this.getOption("width"),t=this.getOption("height");this._container.dataset.width=e||this.width,this._container.dataset.height=t||this.height}_initPlayer(){var e,t=this;return(e=function*(){if(t._eaglePlayer=new EaglePlayer("."+t._containerCSSClass),!t._eaglePlayer)throw new Error},function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){_(o,i,s,a,n,"next",e)}function n(e){_(o,i,s,a,n,"throw",e)}a(void 0)})})()}_play(){this._eaglePlayer.resume()}_playerInitialized(){return!!this._eaglePlayer}_addEventListenerToPlayer(e,t){this._eaglePlayer.on(e,t)}_removeEventListenersFromPlayer(){for(const e of this._eventsList)this._eaglePlayer.off(e)}onPlayerResize(){if(this._log2("onPlayerResize"),!this._destroyed&&this._eaglePlayer){const e=this.getMediaContainer();this._eaglePlayer.size(e.width,e.height),this._log2("onPlayerResize",e.width,e.height)}}onAdState(e){if(this._log2.apply(this,["onAdState"].concat(Array.prototype.slice.call(arguments))),!this._destroyed)switch(e){case"preroll":this.state=o.PROVIDER_STATE.WAITING;break;case"idle":this.state===o.PROVIDER_STATE.WAITING&&0===this.currentTime?(this.state=o.PROVIDER_STATE.ERROR,this.triggerError(303,"No Ads")):this.state=o.PROVIDER_STATE.END;break;default:this.state=o.PROVIDER_STATE.ERROR,this.triggerError(405,"playback error")}}onAdLoad(){this._log2.apply(this,["onAdLoad"].concat(Array.prototype.slice.call(arguments))),this._destroyed||(this._showContainer(),this.state=o.PROVIDER_STATE.PLAY)}onAdVideoState(e){if(this._log2.apply(this,["onAdVideoState"].concat(Array.prototype.slice.call(arguments))),!this._destroyed)switch(e){case"playing":this._showContainer(),this.state=o.PROVIDER_STATE.PLAY;break;case"ended":this._hideContainer(),this.state=o.PROVIDER_STATE.END;break;case"pause":break;default:this._hideContainer(),this.state=o.PROVIDER_STATE.ERROR,this.triggerError(405,"playback error")}}onFullScreen(){this._log2.apply(this,["onFullScreen"].concat(Array.prototype.slice.call(arguments))),this._destroyed}onResize(){this._log2.apply(this,["onResize"].concat(Array.prototype.slice.call(arguments))),this._destroyed}onTimeUpdate(){if(this._log2.apply(this,["onTimeUpdate"].concat(Array.prototype.slice.call(arguments))),this._destroyed)return this._eaglePlayer.pause(),void this._startDestroyEagleTimer()}onSeek(){this._log2.apply(this,["onSeek"].concat(Array.prototype.slice.call(arguments))),this._destroyed}onLoadedPosition(){this._log2.apply(this,["onLoadedPosition"].concat(Array.prototype.slice.call(arguments)))}onStop(){this._log2.apply(this,["onStop"].concat(Array.prototype.slice.call(arguments))),this._destroyed}onPlaying(){if(this._log2.apply(this,["onPlaying"].concat(Array.prototype.slice.call(arguments))),this._destroyed)return this._eaglePlayer.pause(),void this._startDestroyEagleTimer();this.state=o.PROVIDER_STATE.ERROR,this.triggerError(405,"playback error")}onPlay(){if(this._log2.apply(this,["onPlay"].concat(Array.prototype.slice.call(arguments))),this._destroyed)return this._eaglePlayer.pause(),void this._startDestroyEagleTimer();this.state=o.PROVIDER_STATE.ERROR,this.triggerError(405,"playback error")}onReload(){if(this._log2.apply(this,["onReload"].concat(Array.prototype.slice.call(arguments))),this._destroyed)return this._eaglePlayer.pause(),void this._startDestroyEagleTimer()}onEnded(){this._log2.apply(this,["onEnded"].concat(Array.prototype.slice.call(arguments))),this._destroyed&&this._startDestroyEagleTimer()}onStart(e){let t=e.id,r=e.mode,i=e.autoplay,s=e.volume,o=e.mute,a=p(e,["id","mode","autoplay","volume","mute"]);this._log2("onStart",{id:t,mode:r,autoplay:i,volume:s,mute:o,args:a}),!1===i&&(this._log2("autoplay === false, manual start aster 100ms"),setTimeout(()=>{this.updateVolume(),this._eaglePlayer.play()},100)),this._destroyed}}).prototype,"_startDestroyEagleTimer",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"_startDestroyEagleTimer"),s.prototype),g(s.prototype,"_destroyEagle",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"_destroyEagle"),s.prototype),g(s.prototype,"onPlayerResize",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onPlayerResize"),s.prototype),g(s.prototype,"onAdState",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdState"),s.prototype),g(s.prototype,"onAdLoad",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdLoad"),s.prototype),g(s.prototype,"onAdVideoState",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdVideoState"),s.prototype),g(s.prototype,"onFullScreen",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onFullScreen"),s.prototype),g(s.prototype,"onResize",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onResize"),s.prototype),g(s.prototype,"onTimeUpdate",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onTimeUpdate"),s.prototype),g(s.prototype,"onSeek",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onSeek"),s.prototype),g(s.prototype,"onLoadedPosition",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onLoadedPosition"),s.prototype),g(s.prototype,"onStop",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onStop"),s.prototype),g(s.prototype,"onPlaying",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onPlaying"),s.prototype),g(s.prototype,"onPlay",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onPlay"),s.prototype),g(s.prototype,"onReload",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onReload"),s.prototype),g(s.prototype,"onEnded",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onEnded"),s.prototype),g(s.prototype,"onStart",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onStart"),s.prototype),i=s))||i;A.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var v=A;r.default=v},{"../../../../../../common/js/decorators/autobind":228,"../../../../../../player/core/behavior":278,"../../../../../../player/env":306,"../../../../../../player/providers/behaviors/provider-auto-time":316,"../../../../../../player/providers/default":317,"../../../advert/provider/behaviors/default-provider":174,"../base/Integration-script-provider":204,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/es6.string.starts-with":108,"core-js/modules/web.dom.iterable":115}],211:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.search"),e("core-js/modules/es6.string.starts-with");var i,s=(i=e("../../../../../../player/utils/url"))&&i.__esModule?i:{default:i},o=e("../../../../../../player/providers/default"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../base/integration-iframe-provider"));function n(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}const l=/embed\/frame\/showjet\/mute/,d=/embed\/frame\/showjet\/test/,u="//showjet/",c="new",h="old",p="new",_="old";class g extends a.default{get _propAutoTimeCheckComplete(){return!1}constructor(e,t){if(super(e,t),this.IS_DEBUG=!0,this.LOG_PREFIX="ShowjetAdProvider: ",this._playbackMethod=c,this._hasAd=!1,this._sjAdIndex=0,this._lastAdDuration=0,this._waitAdTimeout=5e3,this._eventsNamePrefix="sj_",this._linkType=t.src.startsWith(u)||t.src.startsWith(`//${this.getName()}/`)?p:_,this._linkType===p){this.setOption("mute",!0),this.setOption("test",!1),this.setOption("autoplay",!0),this.setOption("domain","showjet.net");for(let e in this.integrationSettings)this.integrationSettings.hasOwnProperty(e)&&this.setOption(e,this.integrationSettings[e])}else{let e,r=s.default.parse(t.src);r&&((e=s.default.parseSearch(r.search)).utm_source&&this.setOption("utm_source",e.utm_source),e.partner_id&&this.setOption("partner_id",e.partner_id>>0)),this.setOption("mute",l.test(t.src)),this.setOption("test",d.test(t.src)),this.setOption("autoplay",this.getOption("test")),this.setOption("domain","showjet.net")}}static getName(){return"showjet-iframe"}static supports(e){return super.supports(e)||e&&e.src&&e.src.startsWith(u)}_getPayedThreshold(){return!1}play(){super.play(),this._log2("play()"),!this._hasAd||this.state!==o.PROVIDER_STATE.WAITING&&this.state!==o.PROVIDER_STATE.PAUSE||this.sendResume()}pause(){this.sendPause()}stop(){}_getIFrameUrl(){const e=this.getOption("partner_id"),t=this.getOption("domain"),r=this.getOption("test"),i=!!this.getOption("autoplay"),o=this.getOption("mute"),a=this.getOption("utm_source"),n={autoplay:!0,sjuid1:"10",sjuid2:"1",sjuid5:e};return 50!==e&&60!==e||(n.sjuid3="20"),!0!==r&&!1!==i||(n.autoplay="true",n.sjuid7="true",n.sjuid2="1"),o&&(n.sjuid6="0"),a&&(n.utm_source=a),this._https,"https"+`://${t}/promolanding?${s.default.buildQuery(n)}`}_waitAd(){var e,t=this;return(e=function*(){return new Promise((e,r)=>{if(t._hasAd&&t.state===o.PROVIDER_STATE.WAITING)return!0;let i=s=>{s.state!==o.PROVIDER_STATE.ERROR&&s.state!==o.PROVIDER_STATE.END||(t.off("state",i),r()),t._hasAd&&s.state===o.PROVIDER_STATE.WAITING&&(t.off("state",i),e(!0))};t.on("state",i)})},function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){n(o,i,s,a,l,"next",e)}function l(e){n(o,i,s,a,l,"throw",e)}a(void 0)})})()}onNoAds(){this.trigger(a.EVENT_FRAME_LOADED),this._hasAd=!1,this._hideFrame(),this.triggerError(303,"No Ads")}onHasAds(){this.trigger(a.EVENT_FRAME_LOADED),this._hasAd=!0,this._showFrame(),this.state=o.PROVIDER_STATE.IDLE}onPlayerError(){this._hasAd=!1,this._hideFrame(),this.triggerError(405,"playback error")}onAdsFinished(){this._hideFrame(),this._skipped?(this.triggerSkip(),this.state=o.PROVIDER_STATE.CLOSE):this.state=o.PROVIDER_STATE.END}onSkipped(){this._skipped=!0,this._hideFrame(),this.state=o.PROVIDER_STATE.WAITING}onAdclicked(){this.triggerClickThru()}onImpression(){this._payedSuccess()}onAdpaused(){this.state===o.PROVIDER_STATE.IDLE?this.state=o.PROVIDER_STATE.WAITING:this.state=o.PROVIDER_STATE.PAUSE}onAdStarted(){this.trigger(a.EVENT_FRAME_LOADED),this._showFrame(),this.state===o.PROVIDER_STATE.WAITING&&this._hasAd?(this.state=o.PROVIDER_STATE.PLAY,this.resetTriggeredOnce(),this._skipped=!1,this._lastAdDuration=this.currentTime,this._sjAdIndex++):this.state===o.PROVIDER_STATE.IDLE&&this._hasAd&&(this._log2("old payback method"),this._showFrame(),this._playbackMethod=h,this.state=o.PROVIDER_STATE.WAITING,this.state=o.PROVIDER_STATE.PLAY,this.resetTriggeredOnce(),this._skipped=!1,this._lastAdDuration=this.currentTime,this._sjAdIndex++)}onAdview25(){1===this._sjAdIndex&&this.triggerOnce("adFirstQuartile");let e=4*Math.max(0,this.currentTime-this._lastAdDuration);this.duration=this._lastAdDuration+e+1}onAdview50(){1===this._sjAdIndex&&this.triggerOnce("adMidpoint");let e=2*Math.max(0,this.currentTime-this._lastAdDuration);this.duration=this._lastAdDuration+e+1}onAdview75(){1===this._sjAdIndex&&this.triggerOnce("adThirdQuartile");let e=Math.max(0,this.currentTime-this._lastAdDuration)/3*4;this.duration=this._lastAdDuration+e+1}onAdview100(){let e=Math.max(0,this.currentTime-this._lastAdDuration);this.duration=this._lastAdDuration+e+1,this._lastAdDuration=this.currentTime}onAdresumed(){this._showFrame(),!this._hasAd||this.state!==o.PROVIDER_STATE.PAUSE&&this.state!==o.PROVIDER_STATE.IDLE&&this.state!==o.PROVIDER_STATE.WAITING||(this.state=o.PROVIDER_STATE.PLAY)}sendResume(){this._sendMessage("sj_adresume")}sendPause(){this._sendMessage("sj_adpause")}_sendMessage(e){this._log2("send to sj",e),this._frame.contentWindow.postMessage(e,"*")}_updateVolume(e,t){}}g.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var f=g;r.default=f},{"../../../../../../player/providers/default":317,"../../../../../../player/utils/url":338,"../base/integration-iframe-provider":206,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.search":103,"core-js/modules/es6.string.starts-with":108}],212:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.string.starts-with");var i,s,o=e("../../../../../../player/providers/default"),a=h(e("../base/integration-iframe-provider")),n=e("../../../../../../player/core/behavior"),l=h(e("../../../advert/provider/behaviors/default-provider")),d=h(e("../../../../../../player/providers/behaviors/provider-auto-time")),u=h(e("../../../../../../common/js/decorators/autobind")),c=h(e("../../../../../../player/env"));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r,i,s){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let g=(0,n.behavior)(l.default,[d.default,{checkComplete:!1}])((_((s=class extends a.default{constructor(...e){super(...e),this.IS_DEBUG=!0,this.LOG_PREFIX="TvigleAdProvider: ",this._integrationSettings={muted:!0},this._hasAd=!1}static getName(){return"tvigle-iframe"}_getIFrameUrl(){var e;let t="//cloud.tvigle.ru/video/5766269/?playerId=256&partnerId=9912";return"muted"in this.integrationSettings&&(t+="&mutedAd="+(this.integrationSettings.muted?"true":"false")),"parentDomain"in this.integrationSettings?t+="&parentDomain="+this.integrationSettings:t+="&parentDomain=cloud.tvigle.ru",(null===(e=this.integrationSettings)||void 0===e?void 0:e.ref)&&(t+="&ref="+this.integrationSettings.ref),t}get duration(){return 300}_updateVolume(e,t){}_getAutoPlaySupported(){return!!c.default.silentAutoplay||super._getAutoPlaySupported()}_getIFrameEventData(e){if(!e)return null;const t=e.message?"message":"data";if(!e[t])return null;let r=e[t];if(r.startsWith("tvigle.player::event::")){var i;let e;r=r.replace("tvigle.player::event::","");try{e=JSON.parse(r)}catch(t){e={}}return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){p(e,t,r[t])})}return e}({name:null===(i=e)||void 0===i?void 0:i.method},e)}return!1}get _autoPlayIframe(){return!0}play(){super.play(),!this._hasAd||this.state!==o.PROVIDER_STATE.WAITING&&this.state!==o.PROVIDER_STATE.PAUSE||this.onAdvertStart()}onAdvertStart(){this._showFrame(),this.state=o.PROVIDER_STATE.PLAY,this._hasAd=!0}onAdvertResume(){this.onAdvertStart()}onAdvertPause(){this.state=o.PROVIDER_STATE.PAUSE}onAdvertComplete(){this._hideFrame()}onAdvertImpression(){this._hasAd&&this._payedSuccess()}onAdvertFirstQuartile(){this._hasAd&&this.triggerOnce("adFirstQuartile")}onAdvertMidpoint(){this._hasAd&&this.triggerOnce("adMidpoint")}onAdvertThirdQuartile(){this._hasAd&&this.triggerOnce("adThirdQuartile")}onAdvertSectionEnded(){this._showFrame(),this.state=o.PROVIDER_STATE.END}onAdvertSectionEmpty(){this._hideFrame(),this.triggerError(303,"No Ads")}onAdvertClick(){this.triggerClickThru()}}).prototype,"onAdvertStart",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertStart"),s.prototype),_(s.prototype,"onAdvertResume",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertResume"),s.prototype),_(s.prototype,"onAdvertPause",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertPause"),s.prototype),_(s.prototype,"onAdvertComplete",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertComplete"),s.prototype),_(s.prototype,"onAdvertImpression",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertImpression"),s.prototype),_(s.prototype,"onAdvertFirstQuartile",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertFirstQuartile"),s.prototype),_(s.prototype,"onAdvertMidpoint",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertMidpoint"),s.prototype),_(s.prototype,"onAdvertThirdQuartile",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertThirdQuartile"),s.prototype),_(s.prototype,"onAdvertSectionEnded",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertSectionEnded"),s.prototype),_(s.prototype,"onAdvertSectionEmpty",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertSectionEmpty"),s.prototype),_(s.prototype,"onAdvertClick",[u.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdvertClick"),s.prototype),i=s))||i;g.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var f=g;r.default=f},{"../../../../../../common/js/decorators/autobind":228,"../../../../../../player/core/behavior":278,"../../../../../../player/env":306,"../../../../../../player/providers/behaviors/provider-auto-time":316,"../../../../../../player/providers/default":317,"../../../advert/provider/behaviors/default-provider":174,"../base/integration-iframe-provider":206,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.string.starts-with":108,"core-js/modules/web.dom.iterable":115}],213:[function(e,t,r){"use strict";function i(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(s,o){var a=e.apply(t,r);function n(e){i(a,s,o,n,l,"next",e)}function l(e){i(a,s,o,n,l,"throw",e)}n(void 0)})}}Object.defineProperty(r,"__esModule",{value:!0}),r.yandexIntegrationInPage=function({_partnerId:e,category:t,_container:r}){return new Promise((i=s(function*(i,s){try{(yield ya.videoAd.loadModule("InPage")).addInPageVideo(r,{partnerId:e,category:t,visibleAfterInit:!0,slide:!1},e=>i(e))}catch(e){s(e)}}),function(e,t){return i.apply(this,arguments)}));var i},r.yandexIntegrationAdLoader=function({_partnerId:e,category:t,_container:r,video:i}){return new Promise((o=s(function*(s,o){try{const a=yield ya.videoAd.loadModule("AdLoader"),n=yield a.AdLoader.create({partnerId:e,category:t}),l=yield n.loadAd();yield l.preload({videoSlot:i,desiredBitrate:1e3}),s(l.createPlaybackController(i,r))}catch(e){o(e)}}),function(e,t){return o.apply(this,arguments)}));var o},r.yandexIntegrationRtb=function({_partnerId:e,category:t,_container:r,onAdStart:i,onAdEnd:o,onAdImpression:a}){return new Promise((n=s(function*(s,n){try{const p=document.createElement("div");p.id="mv_rtb",r.appendChild(p),l=window,d=document,l[u="yandexContextAsyncCallbacks"]=l[u]||[],l[u].push(function(){window.Ya.Context.AdvManager.render({blockId:`R-A-${e}-${t}`,renderTo:"mv_rtb",async:!0,videoCallbacks:{onAdStart(){i(),setTimeout(a,3e3)},onAdEnd(){o()}},onRender(){s({})},onError(e){n(e)}})}),h=d.getElementsByTagName("script")[0],(c=d.createElement("script")).type="text/javascript",c.src="//an.yandex.ru/system/context.js",c.async=!0,h.parentNode.insertBefore(c,h)}catch(e){n(e)}var l,d,u,c,h}),function(e,t){return n.apply(this,arguments)}));var n},e("core-js/modules/es6.promise")},{"core-js/modules/es6.promise":97}],214:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.gatewaySDK=function(e){return c.apply(this,arguments)},e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.promise");var i=e("./apiYandexSDK");function s(e,t){if(null==e)return{};var r,i,s=function(e,t){if(null==e)return{};var r,i,s={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function o(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var a=e.apply(t,r);function n(e){o(a,i,s,n,l,"next",e)}function l(e){o(a,i,s,n,l,"throw",e)}n(void 0)})}}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){l(e,t,r[t])})}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d={0:function(e,t){return new Promise((r=a(function*(r,s){setTimeout(()=>s(new Error("timeout")),e),r((0,i.yandexIntegrationInPage)(t))}),function(e,t){return r.apply(this,arguments)}));var r},1:function(e,t){let r=t._container,o=s(t,["_container"]);const l=document.createElement("video");return l.volume=0,l.style.height=`${document.documentElement.clientHeight}px`,r.appendChild(l),new Promise((d=a(function*(t,s){setTimeout(()=>s(new Error("timeout")),e),t((0,i.yandexIntegrationAdLoader)(n({},o,{_container:r,video:l})))}),function(e,t){return d.apply(this,arguments)}));var d},2:function(e,t){return new Promise((r=a(function*(r,s){setTimeout(()=>s(new Error("timeout")),e),r((0,i.yandexIntegrationRtb)(t))}),function(e,t){return r.apply(this,arguments)}));var r}},u={0:function(e){return n({},e,{setAdVolume:()=>{}})},1:function(e,t){return e.subscribe("AdStarted",t.onAdStart),e.subscribe("AdPodStopped",t.onAdEnd),e.subscribe("AdPodSkipped",t.onAdSkipped),e.subscribe("AdClickThru",t.onClickThrough),e.subscribe("AdPodVideoFirstQuartile",t.onAdFirstQuartile),e.subscribe("AdPodVideoMidpoint",t.onAdMidpoint),e.subscribe("AdPodVideoThirdQuartile",t.onAdThirdQuartile),e.subscribe("AdPodImpression",t.onAdImpression),{play:()=>e.playAd(),destroy:()=>e.stopAd(),getCurrentTime:()=>e.getAdPodDuration()-e.getAdPodRemainingTime(),getDuration:()=>e.getAdPodDuration(),getPaused:()=>e.getAdPlayingState(),setAdVolume:t=>e.setAdVolume(t)}},2:function(e,t){return{play:()=>{},destroy:()=>{},getCurrentTime:()=>{},getDuration:()=>10,getPaused:()=>{},setAdVolume:e=>{}}}};function c(){return(c=a(function*(e){const t=yield(0,d[e.type])(5e3,e);if(t instanceof Error)throw t;return function(e,t){return(0,u[t.type])(e,t)}(t,e)})).apply(this,arguments)}},{"./apiYandexSDK":213,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],215:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.YANDEX_PROVIDER_IN_STREAM=r.YANDEX_PROVIDER_OUT_STREAM=void 0;r.YANDEX_PROVIDER_OUT_STREAM=0;r.YANDEX_PROVIDER_IN_STREAM=1},{}],216:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable");var i,s,o=p(e("../base/Integration-script-provider")),a=p(e("../../../../../../common/js/decorators/autobind")),n=e("../../../../../../player/core/behavior"),l=p(e("../../../advert/provider/behaviors/default-provider")),d=e("../../../../../../player/providers/default"),u=p(e("../../../../../../player/env")),c=e("./gatewaySDK"),h=e("./types");p(e("../../../../../../player/core/console"));function p(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function g(e,t,r,i,s){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let f=(0,n.behavior)(l.default)((g((s=class extends o.default{static getName(){return"yandex"}_autoQuartileEvents(){return!1}get currentTime(){return this._currentTime}set currentTime(e){(e>>=0)!==this._currentTime&&(this._currentTime=e>>0,this.trigger("timeupdate"))}get duration(){var e;return(null===(e=this._yandexController)||void 0===e?void 0:e.getDuration)?this._yandexController.getDuration():1/0}destroy(){var e;super.destroy(),(null===(e=this._yandexController)||void 0===e?void 0:e.destroy)&&(this._yandexController.destroy(),setTimeout(()=>{this._yandexController=void 0},100))}constructor(e,t){var r,i,s,o,a,n;super(e,t),this.LOG_PREFIX="YandexAdProvider: ",this._partnerId=264947,this.category=0,this.type=h.YANDEX_PROVIDER_OUT_STREAM,this._yandexController=void 0,this._yandexPlayerInitialized=!1,this._stepTimer=250,this._yandexPlayTimer=void 0,this._eventsList=["onAdStart","onAdEnd","onAdSkipped","onAdFirstQuartile","onAdMidpoint","onAdThirdQuartile","onClickThrough","onAdImpression"],this._eventsCamelCase=!1,this._currentTime=0,this._partnerId=(null!==(r=null===(i=this.integrationSettings)||void 0===i?void 0:i.partner_id)&&void 0!==r?r:this._partnerId)>>0,this.category=(null!==(s=null===(o=this.integrationSettings)||void 0===o?void 0:o.category)&&void 0!==s?s:this.category)>>0,this.type=(null!==(a=null===(n=this.integrationSettings)||void 0===n?void 0:n.type)&&void 0!==a?a:this.type)>>0}get _containerCSSClass(){return"mv-embed-frame-externalFrame"}get _containerId(){return"adv"}_getScriptUrl(){return"https://an.yandex.ru/system/video-ads-sdk/adsdk.js"}_getAutoPlaySupported(){return!!u.default.silentAutoplay||super._getAutoPlaySupported()}_addEventListenerToPlayer(e,t){this._yandexController&&(this._yandexController[e]=t)}checkVastForAds(){setTimeout(()=>{var e;(null===(e=this._yandexController)||void 0===e?void 0:e.getDuration())||this.playError("BED VAST YANDEX")},500)}playError(e){this.triggerError(303,"No Ads"),this.state=d.PROVIDER_STATE.ERROR}_initPlayer(){var e,t=this;return(e=function*(){try{t._yandexController=yield(0,c.gatewaySDK)(t),t._play(),t._yandexPlayTimer=setTimeout(()=>t.playError("NO Play timeout 5000"),5e3),t.checkVastForAds()}catch(e){t.playError(e)}finally{t._yandexPlayerInitialized=!0}},function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){_(o,i,s,a,n,"next",e)}function n(e){_(o,i,s,a,n,"throw",e)}a(void 0)})})()}_trackVideoTime(){const e=setInterval(()=>{var t;this.currentTime=null===(t=this._yandexController)||void 0===t?void 0:t.getCurrentTime(),this._yandexController||clearInterval(e)},this._stepTimer)}_play(){this._yandexController&&this._yandexController.getPaused()&&(this._yandexController.play(),this._yandexController.setAdVolume(0))}_playerInitialized(){return!!this._yandexPlayerInitialized}_getPayedThreshold(){return!1}_sendPayedOnFinish(){return!1}resizeRtb(){const e=this._container.querySelector("#mv_rtb"),t=null===e||void 0===e?void 0:e.querySelector("yatag > yatag > yatag > div");e&&(e.style.height=this.getPlayer().height+"px",e.style.width=this.getPlayer().width+"px"),t&&(t.style=`width:${this.getPlayer().width}px!important;height:${this.getPlayer().height}px!important;`)}resizeInStream(){const e=this._container.querySelector("video[style*=height]");e&&(e.style.height=this.getPlayer().height+"px")}resizeOutStream(){return!1}onPlayerResize(){const e={0:this.resizeOutStream,1:this.resizeInStream,2:this.resizeRtb};return!(this._destroyed||!this._container)&&e[this.type]()}onAdStart(){clearTimeout(this._yandexPlayTimer),this._log2("onAdStart"),this._showContainer(),this._log2.apply(this,["onAdState"].concat(Array.prototype.slice.call(arguments))),this._destroyed||(this._trackVideoTime(),this.state=d.PROVIDER_STATE.WAITING,this.trigger("timeupdate"),setTimeout(()=>{this.state=d.PROVIDER_STATE.PLAY},0))}onAdEnd(){this._log2("onAdMediaEnd"),this._hideContainer(),this.state=d.PROVIDER_STATE.END}onAdSkipped(){this._log2("onAdSkipped"),this._hideContainer(),this.triggerSkip(),this.state=d.PROVIDER_STATE.CLOSE}onAdFirstQuartile(){this.triggerOnce("adFirstQuartile")}onAdMidpoint(){this.triggerOnce("adMidpoint")}onAdThirdQuartile(){this.triggerOnce("adThirdQuartile")}onClickThrough(){this._log2("onClickThrough"),this._showContainer(),this.triggerClickThru()}onAdImpression(){this._payedSuccess()}_removeEventListenersFromPlayer(){}_updateVolume(e,t){}}).prototype,"resizeRtb",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"resizeRtb"),s.prototype),g(s.prototype,"resizeInStream",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"resizeInStream"),s.prototype),g(s.prototype,"resizeOutStream",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"resizeOutStream"),s.prototype),g(s.prototype,"onPlayerResize",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onPlayerResize"),s.prototype),g(s.prototype,"onAdStart",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdStart"),s.prototype),g(s.prototype,"onAdEnd",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdEnd"),s.prototype),g(s.prototype,"onAdSkipped",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdSkipped"),s.prototype),g(s.prototype,"onAdFirstQuartile",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdFirstQuartile"),s.prototype),g(s.prototype,"onAdMidpoint",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdMidpoint"),s.prototype),g(s.prototype,"onAdThirdQuartile",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdThirdQuartile"),s.prototype),g(s.prototype,"onClickThrough",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onClickThrough"),s.prototype),g(s.prototype,"onAdImpression",[a.default],Object.getOwnPropertyDescriptor(s.prototype,"onAdImpression"),s.prototype),i=s))||i;f.prototype._options={controls:{hideToolBar:!0,volume:!1,mute:!1,progress:!1,adcountdown:!1,fullscreen:!1,wantunmute:!1}};var m=f;r.default=m},{"../../../../../../common/js/decorators/autobind":228,"../../../../../../player/core/behavior":278,"../../../../../../player/core/console":280,"../../../../../../player/env":306,"../../../../../../player/providers/default":317,"../../../advert/provider/behaviors/default-provider":174,"../base/Integration-script-provider":204,"./gatewaySDK":214,"./types":215,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],217:[function(e,t,r){"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("./providers/vpaid-js"),e("./providers/vpaid-swf"),e("./providers/vast");var s=((i=e("./../../../../player/core/plugin"))&&i.__esModule?i:{default:i}).default;r.default=s},{"./../../../../player/core/plugin":289,"./providers/vast":223,"./providers/vpaid-js":225,"./providers/vpaid-swf":226}],218:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=n(e("./base")),s=n(e("./wrapper")),o=n(e("./extensions")),a=n(e("./creative"));n(e("../../../../../player/utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}var l=class extends i.default{constructor(e){super(e),this._creatives=[],this._wrapperURI="",this._wrapper=!1}getCreatives(){if(this._wrapper)return this._wrapper.getCreatives();let e=this._creatives,t=[];for(let r=0;r<e.length;r++){let i=e[r];i.isEmpty||t.push(i)}return t}getEvents(){let e=super.getEvents();return this._wrapper&&this._creatives.length>0&&(e=this.mergeEvents(e,this._creatives[0].events)),e}parse(e){return new Promise((t,r)=>{let i=!1;for(let o=0;o<e.childNodes.length;o++){let a=e.childNodes[o];if(["InLine","Wrapper"].indexOf(a.nodeName)>-1){i=!0,this._parseAd(a.childNodes),"Wrapper"===a.nodeName&&this._wrapperURI?(this._wrapper=new s.default(this,this.parent.timeout-(Date.now()-this.parent.start),this.parent.depth+1),this._wrapper.on("adWrapperLoading",e=>{this.trigger(e)}),this._wrapper.load(this._wrapperURI).then(t).catch(e=>{let t=this._wrapper.getEvents();this.parent.addHandler("noad",t.noad),r(e)})):t();break}}i||r({code:101,message:"Scheme validation error"})})}_parseAd(e){for(let t=0;t<e.length;t++){let r=e[t];switch(r.nodeName){case"Impression":this.addHandler("impression",r.textContent);break;case"Error":this.addHandler("error",r.textContent);break;case"Creatives":this._parseCreatives(r.childNodes);break;case"Extensions":this._parseExtensions(r.childNodes);break;case"VASTAdTagURI":this._wrapperURI=r.textContent.trim()}}}_parseCreatives(e){for(let t=0;t<e.length;t++)"Creative"===e[t].nodeName&&this._creatives.push(new a.default(this,e[t]))}_parseExtensions(e){let t=(0,o.default)(e);this.events=this.mergeEvents(this.events,t.events);for(let e in t.extensions)this.addExtension(e,t.extensions[e]);this.unknownExtensions=this.unknownExtensions.concat(t.unknown)}};r.default=l},{"../../../../../player/utils/catchHandler":327,"./base":219,"./creative":220,"./extensions":221,"./wrapper":222,"core-js/modules/es6.promise":97}],219:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign");var i,s=(i=e("../../../../../player/core/events"))&&i.__esModule?i:{default:i};function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class a{constructor(e){this.parent=e,this.events={times:[],percents:[]},this.extensions={},this.unknownExtensions=[]}addExtension(e,t){this.extensions[e]=t.trim()}addHandler(e,t){if(t)if(this.events.hasOwnProperty(e)||(this.events[e]=[]),"string"==typeof t)this.events[e].push(t.trim());else if(t.length)for(let r=0;r<t.length;r++)this.addHandler(e,t[r]);else this.events[e].push(t)}mergeEvents(e,t){for(let r in t)t.hasOwnProperty(r)&&(e.hasOwnProperty(r)||(e[r]=[]),e[r]=e[r].concat(t[r]));return e}getEvents(){let e=o({},this.events);if(this.parent){let t=this.parent.getEvents();e=this.mergeEvents(e,t)}return e}getExtensions(){return o({},this.parent?this.parent.getExtensions():{},this.extensions)}}o(a.prototype,s.default);var n=a;r.default=n},{"../../../../../player/core/events":283,"core-js/modules/es6.object.assign":95}],220:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.to-string");var i=o(e("./base")),s=o(e("./../../../../../player/utils/time"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{constructor(e,t){super(e),this.media=[],this._linear=!1,this._parse(t)}get isEmpty(){return 0===this.media.length}_parse(e){for(let t=0;t<e.childNodes.length;t++){let r=e.childNodes[t];switch(r.nodeName){case"Linear":this._linear||(this._linear=!0,this._parseLinear(r))}}}_parseLinear(e){let t=e.getAttribute("skipoffset");t&&this.addExtension("skipTime",t);for(let t=0;t<e.childNodes.length;t++){let r=e.childNodes[t];switch(r.nodeName){case"AdParameters":this.addExtension("AdParameters",r.textContent);break;case"Duration":this.addExtension("duration",s.default.fromString(r.textContent).toString());break;case"MediaFiles":this.media=this._parseMedia(r.childNodes);break;case"TrackingEvents":this._parseTrackingEvents(r.childNodes);break;case"VideoClicks":this._parseVideoClicks(r.childNodes)}}}_parseVideoClicks(e){for(let t=0;t<e.length;t++){let r=e[t];switch(r.nodeName){case"ClickThrough":this.addExtension("clickThrough",r.textContent);break;case"CustomClick":this.addExtension("customClick",r.textContent);break;case"ClickTracking":this.addHandler("click",r.textContent)}}}_parseMedia(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r];if(i.nodeType===i.TEXT_NODE||i.nodeType===i.COMMENT_NODE)continue;let s=i.textContent.trim();"https:"===window.location.protocol&&(s=s.replace("http:","https:")),t.push({parent:this,type:i.getAttribute("type"),src:s,bitrate:i.getAttribute("bitrate")?i.getAttribute("bitrate"):0,height:i.getAttribute("height")?i.getAttribute("height"):0,width:i.getAttribute("width")?i.getAttribute("width"):0})}return t}_parseTrackingEvents(e){for(let t=0;t<e.length;t++){let r=e[t];if("Tracking"!==r.nodeName)continue;let i=r.getAttribute("event");switch(i){case"progress":let e={link:r.textContent.trim(),value:!1},t=r.getAttribute("offset");t&&(t.indexOf(":")>-1&&(i="times",e.value=parseInt(s.default.fromString(t))),t.indexOf("%")>-1&&(i="percents",e.value=parseInt(t))),!1!==e.value&&this.addHandler(i,e);break;default:this.addHandler(i,r.textContent)}}}};r.default=a},{"./../../../../../player/utils/time":335,"./base":219,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.to-string":105}],221:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;let i=function(e,t,r){r.hasOwnProperty(e)||(r[e]=[]),r[e].push(t)};var s=function(e){let t={},r={times:[],percents:[]},s=[];for(let o=0;o<e.length;o++){let a=e[o];if(a.nodeType!==a.TEXT_NODE)switch(a.getAttribute("type")){case"controls":t.controls=a.textContent;break;case"skipTime":t.skipTime=a.textContent;break;case"skipTime2":t.skipTime2=a.textContent;break;case"linkTxt":t.linkTxt=decodeURIComponent(a.textContent);break;case"isClickable":t.isClickable=a.textContent.trim();break;case"skipAd":i("skip",a.textContent,r);break;case"addClick":i("customClick",a.textContent,r);break;case"Allowblock":case"WOW":break;case"dart":for(let e=0;e<a.childNodes.length;e++){let t=a.childNodes[e];switch(t.nodeName){case"AdServingData":continue;case"CustomTracking":switch(t.getAttribute("type")){case"skip":i("skip",a.textContent,r);break;case"engagedView":r.times.push({time:30,link:a.textContent})}}}break;case"redServizeRtbData":t.redServizeRtbData=a.textContent;break;default:s.push({type:a.getAttribute("type"),xml:a.outerHTML})}}return{extensions:t,events:r,unknown:s}};r.default=s},{}],222:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.promise");var i=l(e("./advert")),s=l(e("./base")),o=l(e("./../../../../../player/utils/ajax")),a=l(e("../../../../../player/utils/catchHandler")),n=e("../../advert/lib/rtbService");function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){d(o,i,s,a,n,"next",e)}function n(e){d(o,i,s,a,n,"throw",e)}a(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var h=class extends s.default{constructor(e,t=5e3,r=0){super(e),this._https="https:"===window.location.protocol,this._depth=r,this._maxdepth=10,this._adList=[],this.ads=[],this.url="",this.loadJob=!1,this.start=Date.now(),this._timeout=t}get timeout(){let e=this._timeout;return e<1500&&(e=1501),e}get depth(){return this._depth}_error(e){let t=c(e,3),r=t[0],i=t[1],s=t[2],o=Math.round((new Date-this.start)/100)/10;switch(i){case"parsererror":throw{code:100,message:"XML parsing error",duration:o};case"timeout":throw{code:301,message:"Timeout",duration:o};case"abort":throw{code:300,message:"Request aborted",networkStatus:r&&r.status,url:this.url,depth:this._depth,duration:o};default:throw{code:300,message:s,error:i,networkStatus:r&&r.status,url:this.url,depth:this._depth,duration:o}}}load(e,t){return this.isRtb(e)?this._rtbStore(t):this._load(e)}isRtb(e){return/moevideo.biz\/ssp/i.test(e)}_rtbStore(e){var t=this;return u(function*(){const r=yield(new n.RtbService).getStore();try{const i=(new DOMParser).parseFromString(r[e],"application/xml");return t._paseXml(i,r[e])}catch(i){return t.log("parseFail",{code:i.code,message:i.message,xml:r[e],xhrStatus:200,xhrStatusText:"OK",isWrapper:/<wrapper/i.test(r[e]),Info:"XmlParsingError"}),Promise.reject({code:100,message:"XML parsing error"})}})()}_load(e){if(!this.loadJob)if(this._https&&(e=e.replace("http:","https:")),this.url=e.trim(),this.start=Date.now(),this._depth<this._maxdepth){let e,t=!/pladform\.ru/.test(this.url);e=((e=!0)=>(0,o.default)({url:this.url,crossDomain:!0,timeout:this.timeout,cache:!0,xhrFields:{withCredentials:e},dataType:"xhr"})),this.log("requestStart",{url:this.url}),this.loadJob=e(t).catch(r=>{let i=c(r,3),s=i[0],o=i[1],a=i[2];return 0===s.status&&!a&&"timeout"!==o&&t?e(!1):Promise.reject(r)}).catch(e=>{let t=c(e,3),r=t[0],i=t[1],s=t[2];this.log("requestFail",{code:i,message:s,url:this.url,xhrStatus:r&&r.status,xhrStatusText:r&&r.statusText,timeout:this.timeout,isError:e instanceof Error}),this._error(e)}).then(e=>{let t,r=e.responseText.trim();if(this.log("requestSuccess",{url:this.url,xml:r}),204==e.status)return this.log("parseFail",{code:303,message:"No Ads",xml:r}),Promise.reject({code:303,message:"No Ads"});if(200==e.status)switch(r){case"<noad></noad>":case"<nobanner/>":case'<?xml version="1.0" encoding="UTF-8"?>\n\n<VAST version="3.0">\n<Error><![CDATA[https://content.adriver.ru/1x1.gif]]></Error>\n</VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\r\n\r\n<VAST version="3.0">\r\n<Error><![CDATA[https://content.adriver.ru/1x1.gif]]></Error>\r\n</VAST>':case'<?xml version="1.0"?><nobanner></nobanner>':case'<?xml version="1.0"?><nobanner/>':case'<?xml version="1.0" encoding="UTF-8"?><nobanner></nobanner>':case'<VAST version="2.0"></VAST>':case'<?xml version="1.0"?><VAST></VAST>':case'<?xml version="1.0" encoding="UTF-8"?><VAST version="3.0"></VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\n<nobanner></nobanner>':case'<?xml version="1.0" encoding="UTF-8"?>\r\n<nobanner></nobanner>':case'<?xml version="1.0" encoding="UTF-8"?>\n<VAST version="2.0">\n</VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\r\n<VAST version="2.0">\r\n</VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\n<VAST version="2.0">\n\n</VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\r\n<VAST version="2.0">\r\n\r\n</VAST>':case'<?xml version="1.0" encoding="UTF-8"?>\n<VAST version="2.0">\n    \n</VAST>':case"<?xml version='1.0' encoding='UTF-8'?><VAST version='2.0'>\n</VAST>":case'<?xml version="1.0" encoding="utf-8"?><document></document>':case'<?xml version="1.0" encoding="UTF-8" standalone="no"?><VAST version="2.0"/>':case"<noad/>":return this.log("parseFail",{code:303,message:"No Ads",xml:r}),Promise.reject({code:303,message:"No Ads"})}try{t=(new DOMParser).parseFromString(r,"application/xml")}catch(t){return this.log("parseFail",{code:t.code,message:t.message,xml:r,xhrStatus:e.status,xhrStatusText:e.statusText,isWrapper:/<wrapper/i.test(r),Info:"XmlParsingError"}),Promise.reject({code:100,message:"XML parsing error"})}return this._paseXml(t,r,e)})}else this.log("fail",{code:302,message:"Wrapper limit reached"}),this.loadJob=Promise.reject({code:302,message:"Wrapper limit reached"});return this.loadJob}_paseXml(e,t,r={status:200,statusText:"OK"}){var i=this;return u(function*(){try{const s=yield i._parse(e);return i.log("parseSuccess",{url:i.url,xml:t}),s}catch(e){return i.log("parseFail",{code:e.code,message:e.message,xml:t,xhrStatus:r.status,xhrStatusText:r.statusText,isWrapper:/<wrapper/i.test(t)}),Promise.reject(e)}})()}getCreatives(){let e=[];for(let t=0;t<this.ads.length;t++)e=e.concat(this.ads[t].getCreatives());return e}_parse(e){if(e){e.ignoreWhitespace=!0;let t=e.childNodes[0].childNodes;for(let e=0;e<t.length;e++)switch(t[e].nodeName){case"Ad":this._adList.push(t[e]);break;case"Error":this.addHandler("noad",t[e].textContent)}}return this._loadAds(0).then(()=>0!==this.ads.length||Promise.reject({code:303,message:"No Ads"}))}_loadAds(e){return e<this._adList.length?new Promise((t,r)=>{let s=new i.default(this);s.on("adWrapperLoading",e=>{this.trigger(e)}),s.parse(this._adList[e]).then(()=>{s.getCreatives().length>0&&this.ads.push(s),this._loadAds(e+1).then(()=>t()).catch(e=>(0,a.default)(e))}).catch(r=>{this._loadAds(e+1).then(()=>t()).catch(e=>(0,a.default)(e))})}):Promise.resolve()}log(e,t={}){const r=new Date;t.action=e,t.url=this.url,t.start=r,t.depth=this._depth,t.end=new Date,t.duration=t.end-r,this.trigger("adWrapperLoading",{info:t})}};r.default=h},{"../../../../../player/utils/catchHandler":327,"../../advert/lib/rtbService":150,"./../../../../../player/utils/ajax":325,"./advert":218,"./base":219,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],223:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.promise"),e("core-js/modules/es6.array.sort");var i,s=f(e("./../../advert/provider/metaprovider")),o=f(e("./../../advert/provider/providers")),a=e("./../../../../../player/providers/default"),n=f(e("./../items/wrapper")),l=f(e("./../../../../../player/core/error")),d=f(e("./../../../../../player/utils/pixels")),u=f(e("../../../../../player/env/index")),c=f(e("../../../../../player/core/console")),h=e("../../../../../common/js/utils/string"),p=f(e("../../../../../player/core/behavior")),_=f(e("../../../../../player/utils/catchHandler")),g=f(e("../../../../../common/js/decorators/autobind"));function f(e){return e&&e.__esModule?e:{default:e}}let m=function(e,t){return e.value>t.value},A=(v=(i=class extends s.default{static getName(){return"vast"}static getMediaTypePriority(){return["video/mp4","video/webm","video/youtube","video/x-flv","application/x-shockwave-flash","application/javascript","application/x-javascript"]}static supports(e){return"type"in e&&"text/xml"===e.type}get supportSerializing(){return!0}constructor(e,t){super(e,t),this._vastSkipped=!1,this.PRIORITIES_CREATIVE_TYPE={"application/javascript":1,"video/mp4":2,"video/webm":2,"video/youtube":2,"application/x-mpegURL":2,"video/3gpp":2,"video/x-flv":2,"application/x-shockwave-flash":2},this.mediaContainer=e,this._content=!1,this._vastEvents=[],this._preloadJob=!1,this._substituteReferrer()}destroy(){this.log("Удаление провайдера..."),this._destroyProvider().then(()=>{this.log("Провайдер удалён, очистка ресурсов."),super.destroy(),p.default.deleteAll(this)}).catch(e=>(0,_.default)(e))}_substituteReferrer(){try{this.mediaContainer.getOption("substituteReferrer")&&Object.defineProperty(document,"referrer",{get:function(){return location.hostname}})}catch(e){(0,_.default)(e)}}_prepareOptions(e){let t={wantunmute:{}};return e.clickThrough&&(t.adclickable={href:e.clickThrough}),e.hasOwnProperty("controls")&&"0"===e.controls?(u.default.autoPlay||(t.wantplay={text:"Воспроизведение продолжится после показа рекламы"}),t.adresume={},t.onlyProviderControls=!0,t):(e.clickThrough&&(t.adbutton=t.adbutton||{},t.adbutton.href=e.clickThrough,e.linkTxt&&(t.adbutton.text=e.linkTxt)),e.skipTime&&(t.adskip={time:e.skipTime}),e.skipTime2&&(t.adclose={time:e.skipTime2}),e.customClick&&(t.adbutton.href=e.customClick),"0"===e.isClickable&&(t.adclickable=!1),t)}_loadProvider(e){let t=super._loadProvider(e),r=this._provider;if(r){let e=r.getName();this.log(`Выбран провайдер: ${e}`),this.log(`Загрузка провайдера  ${e}...`),t.then(()=>{this.trigger("providerLoadingState",{state:"loaded"}),this.log(`Провайдер ${e} успешно загружен`)}).catch(t=>{this.trigger("providerLoadingState",{state:"error"}),this.log(`Ошибка при загрузке провайдера ${e}`,!0)})}else this.log("Провайдер не выбран",!0);return t}_processMacro(e){return(0,h.replaceAll)(e,{"[CACHEBUSTING]":parseInt(1e7*Math.random()),"[ERRORCODE]":this._errorCode,"[TIMESTAMP]":(new Date).toISOString(),"[ASSETURI]":this._provider?this._provider.getOption("src"):"","[CONTENTPLAYHEAD]":this._content?new Date(1e3*this._content.currentTime).toISOString().substring(11,23):0})}_sendEvents(e,t){if(this._vastEvents[e]){let r=this._vastEvents[e].map(e=>this._processMacro(e));(0,d.default)(r),t&&(this._vastEvents[e]=[])}}_sendProgress(e,t){let r=this._vastEvents[e];if(r.length>0&&r[0].value<=t){let i;for(i=0;i<r.length&&r[i].value<=t;i++)(0,d.default)([r[i].link]);this._vastEvents[e]=r.slice(i)}}_addVastEvents(e){e.times=e.times.sort(m),e.percents=e.percents.sort(m),this._vastEvents=e,this.listenTo(this.getPlayer(),"fullscreenchange",()=>{this.getPlayer().fullScreen?(this._sendEvents("fullscreen"),this._sendEvents("expand")):(this._sendEvents("exitFullscreen"),this._sendEvents("collapse"))}),this.listenTo(this.getMediaContainer(),{skip:()=>{this._vastSkipped=!0,this._sendEvents("skip")},close:()=>{this._sendEvents("closeLinear"),this._sendEvents("close")},click:()=>{this._sendEvents("click")},customClick:()=>{this._sendEvents("click"),this._sendEvents("customClick")},vast:e=>{this._sendEvents(e.event,!0)}}),this.volumeControl.on("volumeChange",e=>{c.default.log("### VPAID-BASE Provider - event from volumeControl `volumeChange`",e),"ad"===e.type&&this._sendEvents(e.muted?"mute":"unmute")}),this.on({timeupdate:e=>{if(this.duration>0){let e=100*this.currentTime/this.duration;e>=25&&this._sendEvents("firstQuartile",!0),e>=50&&this._sendEvents("midpoint",!0),e>=75&&this._sendEvents("thirdQuartile",!0),this._sendProgress("percents",e),this._sendProgress("times",this.currentTime)}},start:()=>{this._sendEvents("impression",!0),this._sendEvents("start",!0),this._sendEvents("creativeView",!0)},state:e=>{e.state===a.PROVIDER_STATE.END&&this._sendEvents("complete",!0),e.state===a.PROVIDER_STATE.PAUSE&&this._sendEvents("pause"),this.state===a.PROVIDER_STATE.PAUSE&&e.state===a.PROVIDER_STATE.PLAY&&this._sendEvents("resume")},error:e=>{e.code?this._errorCode=e.code:this._errorCode=300,this._sendEvents("error")}})}_sortMediaBaskets(e){let t;for(t in e)e.hasOwnProperty(t)&&(e[t]=e[t].sort(function(e,t){return e.height<t.height}));let r=this.constructor.getMediaTypePriority(),i=[];for(t=0;t<r.length;t++)e[r[t]]&&(i.push(e[r[t]]),e[r[t]]=!1);for(t in e)e.hasOwnProperty(t)&&!1!==e[t]&&i.push(e[t]);return i}_getMediaFormatBuskets(e){let t={};for(let r=0;r<e.length;r++)for(let i=0;i<e[r].media.length;i++){let s=e[r].media[i];t.hasOwnProperty(s.type)||(t[s.type]=[]),t[s.type].push(s)}return t}_extractData(e){let t={};for(let r=0;r<e.length;r++)for(let i=0;i<e[r].media.length;i++){let s=e[r].media[i];if(!s.src)continue;let o=s.parent.getExtensions(),a=s.parent.getEvents();o.AdParameters&&(s.AdParameters=o.AdParameters),o.duration&&(s.duration=o.duration),o.redServizeRtbData&&(s.redServizeRtbData=o.redServizeRtbData),s.controls=this._prepareOptions(o),s.events=a,delete s.parent,t.hasOwnProperty(s.type)||(t[s.type]=[]),t[s.type].push(s)}return this._sortMediaBaskets(t)}findProviderClass(e){!e&&this._vastBaskets&&(e=this._vastBaskets);let t=[];for(let r=0;r<e.length;r++)for(let i=0;i<e[r].length;i++)t.push(e[r][i]);t.sort((e,t)=>{try{const r=e.type!==t.type,i=this.PRIORITIES_CREATIVE_TYPE[e.type]!==this.PRIORITIES_CREATIVE_TYPE[t.type];if(r&&i)return this.PRIORITIES_CREATIVE_TYPE[e.type]-this.PRIORITIES_CREATIVE_TYPE[t.type]}catch(e){c.default.error("error sort vast",e)}return e.bitrate&&t.bitrate?e.bitrate-t.bitrate:0});for(let e=0;e<t.length;e++){let r,i=t[e];try{r=o.default.select(i)}catch(e){c.default.error(e)}if(r)return{Provider:r,media:i}}}selectProvider(e=!1){let t=this.findProviderClass(e);if(t){let e=t.Provider,r=t.media;this.setControls(r.controls),this._addVastEvents(r.events);let i=new e(this.getMediaContainer(),r);return i.parentProvider=this,this.trigger("providerSelected",{provider:i}),i}return this.trigger("providerNotSelected",{baskets:e}),null}preLoad(){return this._preloadJob||(this._wrapper=new n.default(void 0,this.getOption("timeout")),this._wrapper.on("adWrapperLoading",e=>{let t=this.getMediaContainer();e.info.adId=t.getAdId(),e.info.adCampaignId=t.getCampaignId(),e.info.slotId=t.getAdSlotId(),e.info.slot=t.getAdSlot(),this.getPlayer().trigger(e)}),this._preloadJob=this._wrapper.load(this.getOption("src"),this.mediaContainer.getOption("adId")).then(()=>{let e=this._extractData(this._wrapper.getCreatives());return this._vastBaskets=e,e}).catch(e=>(e.code?this._errorCode=e.code:this._errorCode=300,this.trigger("error",e),Promise.reject(e)))),this._preloadJob}errorLoad(e){return this._wrapper&&this._addVastEvents(this._wrapper.getEvents()),e&&e.code&&(this._errorCode=e.code,e=new l.default(this,e.code,e.message,e)),this._sendEvents("noad"),Promise.reject(e)}_sendPayedOnFinish(){return this._vastSkipped}}).prototype,y="_sendPayedOnFinish",b=[g.default],P=Object.getOwnPropertyDescriptor(i.prototype,"_sendPayedOnFinish"),T=i.prototype,w={},Object.keys(P).forEach(function(e){w[e]=P[e]}),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=b.slice().reverse().reduce(function(e,t){return t(v,y,e)||e},w),T&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(T):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(v,y,w),w=null),i);var v,y,b,P,T,w;A.prototype._options={controls:{volume:{},mute:{}},stallTimeout:10,suspendTimeout:0},A.getPriority=s.default.getPriority,o.default.register(A);var S=A;r.default=S},{"../../../../../common/js/decorators/autobind":228,"../../../../../common/js/utils/string":234,"../../../../../player/core/behavior":278,"../../../../../player/core/console":280,"../../../../../player/env/index":306,"../../../../../player/utils/catchHandler":327,"./../../../../../player/core/error":281,"./../../../../../player/providers/default":317,"./../../../../../player/utils/pixels":333,"./../../advert/provider/metaprovider":180,"./../../advert/provider/providers":182,"./../items/wrapper":222,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.array.sort":94,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],224:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.VPAID_EVENT=void 0,e("core-js/modules/es6.promise");var i=h(e("./../../advert/provider/default")),s=e("./../../../../../player/providers/default"),o=h(e("./../../../../../player/core/error")),a=h(e("../../../../../player/utils/timer")),n=e("./../../advert/media-container"),l=h(e("../../advert/media-container"));e("../../../../../player/env/index");var d=h(e("../../../../../player/core/console")),u=h(e("../../../../../player/utils/catchHandler")),c=e("../../../../../common/js/utils/waitHelper");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}r.VPAID_EVENT={AdError:"AdError",AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdImpression:"AdImpression",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdStopped:"AdStopped",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdUserClose:"AdUserClose",AdSkipped:"AdSkipped"};const _=-1,g=-2,f=0,m=-1,A=-2,v=0;class y extends i.default{get autoPlaySupported(){return!0}get supportWantPlay(){return!1}constructor(e,t){super(e,t),this.listenTo(e,"viewmodechange",this._onResize),this.listenTo(this.getPlayer(),"resize",this._onResize),this.on("skip",this._onSkip),this._video=!1,this._wrapper=!1,this._currentTime=0,this._duration=t.duration?+t.duration:0,this._observer=!1,this._loaded=!1,this._skipped=!1,this._checkTimer=new a.default,this._checkTimerFailCount=0,this._allowZeroRemainingTime=!1,this._waitAdVideoStartReset=null}destroy(){let e;this._loaded&&(this._callVpaid("pauseAd"),this._stopVpaid(),this.log("waiting AdStopped..."));let t=()=>{e&&(clearTimeout(e),e=void 0),t=function(){},this._wrapper&&(this._wrapper.destroy(),this._wrapper=!1),this._observer&&(clearInterval(this._observer),this._observer=!1),this.log("destroy..."),super.destroy()};this._waitAdStopped().then(t).catch(e=>(0,u.default)(e)),e=setTimeout(t,1e3)}_waitAdStopped(){return this._waitAdStoppedJob?this._waitAdStoppedJob:(this._wrapper?this._waitAdStoppedJob=new Promise(e=>{this._wrapper.once("AdStopped",e)}):this._waitAdStoppedJob=Promise.resolve(),this._waitAdStoppedJob)}_startObserver(){this._observer=setInterval(()=>{this.trigger("timeupdate")},200)}disableCurrentTimeControl(){this._currentTimeControlDisabled=!0}disableAdVideoStartControl(){this._adVideoStartControlDisabled=!0}get multiAdModeEnabled(){return 2===parseInt(this.getMediaContainer().getOption("campaign_id"))}_setupVolume(){this.volumeControl.setCurrentType("ad",this);const e=this.getMediaContainer()?this.getMediaContainer().getOptions():null;e&&"backPreload"in e&&e.backPreload&&setTimeout(()=>{this.volumeControl.setMuted(!1,"ad",!0,this)},0),this.updateVolume()}_attachEvents(){var e=this;this.listenTo(this,{start:()=>{d.default.log("### VPAID-BASE Provider - event from self `start`"),this._startObserver(),this._currentTime=0,this._vpaidStarted=!0,setTimeout(()=>{this.trigger("timeupdate")},0)},state:e=>{switch(d.default.log("### VPAID-BASE Provider - event from self  `state`",e.state),e.state){case s.PROVIDER_STATE.PLAY:this._checkTimer.start(),this._vpaidStarted=!0,this.trigger("timeupdate");break;case s.PROVIDER_STATE.PAUSE:this._checkTimer.stop(),this.trigger("timeupdate");break;case s.PROVIDER_STATE.END:this._checkTimer.stop(),this._currentTime=this.duration,this.trigger("timeupdate");break;case s.PROVIDER_STATE.CLOSE:this._checkTimer.stop()}}});let t=this.getMediaContainer(),r=0,i=this.getPlayer(),o=t instanceof l.default,a=o?t.getAdId():t.adId,n=o?t.getOption("allowPlayingIfNotFocus"):t.allowPlayingIfNotFocus;var u,h;this.listenTo(this._wrapper,{"AdLoaded AdStarted AdImpression AdPaused AdPlaying AdStopped AdVideoStart AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdClickThru AdUserClose AdSkipped":e=>{d.default.log("### VPAID-BASE Provider - event from wrapper",e.type),this.log(`event ${e.type}`),this.trigger("vpaid",{event:e.type})},AdLoaded:e=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdLoaded`"),this._setupVolume(),this.state===s.PROVIDER_STATE.END&&d.default.log("WTF!!!"),i.visible||n?this._callVpaid("startAd"):this.log("Не запускаем рекламу, т.к. плеер не в фокусе",a)},AdStarted:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdStarted`"),t.needShow(),this._setupVolume(),t.trigger("vast",{event:"creativeView"}),this.state=s.PROVIDER_STATE.PLAY},AdImpression:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdImpression`"),t.needShow(),t.trigger("vast",{event:"impression"})},AdPaused:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdPaused`"),this.state=s.PROVIDER_STATE.PAUSE},AdPlaying:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdPlaying`"),this.state=s.PROVIDER_STATE.PLAY},AdStopped:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdStopped`"),this.state=s.PROVIDER_STATE.END},AdVideoStart:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdVideoStart`"),t.needShow(),this.state!==s.PROVIDER_STATE.PLAY&&(this.state=s.PROVIDER_STATE.PLAY),this._waitAdVideoStartReset&&this._waitAdVideoStartReset()},AdVideoFirstQuartile:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdVideoFirstQuartile`"),this._currentTime=.25*this.duration,this.trigger("timeupdate")},AdVideoMidpoint:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdVideoMidpoint`"),this._currentTime=.5*this.duration,this.trigger("timeupdate")},AdVideoThirdQuartile:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdVideoThirdQuartile`"),this._currentTime=.75*this.duration,this.trigger("timeupdate")},AdVideoComplete:(u=function*(){d.default.log("### VPAID-BASE Provider - event from wrapper `AdVideoComplete`"),3===++r?e.state=s.PROVIDER_STATE.END:(e._waitAdVideoStartReset&&(e._waitAdVideoStartReset(),e._waitAdVideoStartReset=null),e._waitAdVideoStartReset=c.waitHelper.resettableTimout(2500,()=>{e.state=s.PROVIDER_STATE.END}),e.state=s.PROVIDER_STATE.WAITING)},h=function(){var e=this,t=arguments;return new Promise(function(r,i){var s=u.apply(e,t);function o(e){p(s,r,i,o,a,"next",e)}function a(e){p(s,r,i,o,a,"throw",e)}o(void 0)})},function(){return h.apply(this,arguments)}),AdClickThru:e=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdClickThru`",e),t.adClickThru({playerHandles:e.playerHandles,url:e.url})},AdVolumeChange:e=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdVolumeChange`");let t=void 0===e.data?this._getVolume():e.data.volume;t<=0?this.volumeControl.setMuted(!0,"ad",!0,this):(this.volumeControl.setVolume(t,"ad",!0,this),this.volumeControl.setMuted(!1,"ad",!0,this))},AdDurationChange:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdDurationChange`"),this.trigger("durationchange")},AdSkippableStateChange:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdSkippableStateChange`")},AdUserClose:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdUserClose`"),this.trigger("close",{closeTime:this.currentTime}),this.state=s.PROVIDER_STATE.CLOSE},AdSkipped:()=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdSkipped`"),this._skipped=!0,this.trigger("skip",{skipTime:this.currentTime}),this.state=s.PROVIDER_STATE.CLOSE},AdRemainingTimeChange:()=>{const e=this._video.getAdRemainingTime();this._version<2&&!this._duration&&(this._duration=e,this.trigger("durationchange")),this._currentTime=this._duration-e,this._vpaidStarted&&this.trigger("timeupdate")},AdError:e=>{d.default.log("### VPAID-BASE Provider - event from wrapper `AdError`",e);const t=this._getPlayerErrorByAdError(e);this.log(`event AdError ${t.code} (${t.message})`,!0),this.state=s.PROVIDER_STATE.ERROR,this.trigger(t)}}),this._waitAdStopped()}_getPlayerErrorByAdError(e,t){let r=901,i="";if("object"==typeof e)switch(!0){case!!e.message:i=e.message||"";break;case"object"==typeof e.data:e.data.status&&(i=e.data.status),e.data.code&&(r=e.data.code);break;case!!e.status:i=e.status||""}else i=e,e={};switch(i.toLowerCase()){case"no playable sources found":case"no active campaigns":case"no active campaigns.":case"no suitable ads found":case"unable to find suitable ad":case"no ad found in ad tag response":case"ad absent":case"all campaigns excluded":case"all campaigns removed":case"no ad.":r=303;break;case"wait adloaded event timeout":case"unable to load ad data":case"error loading config":r=301}return i=`VPAID: ${i}`,t&&(i+=t),new o.default(this,r,i)}_loadWrapper(){}_loadVPAID(){}_initAd(){return new Promise((e,t)=>{const r=new Date,i=this.getPlayer();let o=0,a=e=>{o&&clearTimeout(o);let t=new Date-r;this.getPlayer().trigger("VpaidInitAdDuration",{duration:250*Math.round(t/250),result:e})},n=this._wrapper,l=12e3;i.testMode&&(l=5e3),o=setTimeout(()=>{n.trigger("AdError",{data:{status:"Wait AdLoaded event timeout",code:301}})},l),this.listenToOnce(n,"AdLoaded",t=>{this.log("event AdLoaded"),this.trigger("vpaid",{event:"AdLoaded"}),this._loaded=!0,this._attachEvents(),a(!0),e()}),this.listenToOnce(n,"AdError",e=>{let r=this._getPlayerErrorByAdError(e);this.log(`event AdError ${r.code} (${r.message})`,!0),this.trigger("vpaid",{event:"AdError"}),a(!1),this.state=s.PROVIDER_STATE.ERROR,t(r)});const d=this._callVpaid("handshakeVersion","2.0");this.log(`vpaid version: ${d}`),this._version=parseFloat(d);const u=this._getCreativeData(),c=this._getEnvironmentVars(),h=this.getMediaContainer();this._callVpaid("initAd",h.width,h.height,"normal",2500,u,c)})}_getCreativeData(){return""}_getEnvironmentVars(){return""}load(){return this._loadWrapper().then(()=>this._loadVPAID()).then(()=>this._initAd())}play(){if(this.state!==s.PROVIDER_STATE.ERROR){if(this._video){if(this.state===s.PROVIDER_STATE.PLAY)return;this.state===s.PROVIDER_STATE.PAUSE?this._callVpaid("resumeAd"):(this.state=s.PROVIDER_STATE.WAITING,this._callVpaid("startAd"))}}else window.console.trace("AHHHHHHH",this)}_callVpaid(e,...t){let r=!0;switch(e){case"getAdVolume":case"setAdVolume":case"getAdRemainingTime":case"getAdDuration":case"resizeAd":r=!1}try{return r&&(this.log(`call ${e}(${t.join(", ")})...`),d.default.log("### VPAID-BASE Provider - vpaid call",e,t)),this._video[e].apply(this._video,t)}catch(t){r&&this.log(`exception after call ${e}...`,!0)}}pause(){this._callVpaid("pauseAd")}_onSkip(){this._skipped||(this._skipped=!0,this.version>=2?this._callVpaid("skipAd"):this._stopVpaid())}_stopVpaid(){this._callVpaid("stopAd")}_onResize(){const e=this.getMediaContainer();this._callVpaid("resizeAd",e.width,e.height,e.viewMode)}_updateVolume(e,t){d.default.log.apply(d.default,["$$$ vast/provides/vpaid-base _updateVolume"].concat(Array.prototype.slice.call(arguments))),this._callVpaid("setAdVolume",t?0:e)}_getVolume(){return this._callVpaid("getAdVolume")||0}_getAdRemainingTime(){let e;try{e=this._video.getAdRemainingTime()}catch(t){e=m}if(e>0){let t=this._getAdDuration();switch(t){case _:case g:this._durationByRemainingTime<e&&(this._durationByRemainingTime=e)}!this._durationByRemainingTime&&t<e&&(this._durationByRemainingTime=e)}return e}_getCurrentTime(){let e;const t=this._getAdRemainingTime();switch(t){case v:e=this._allowZeroRemainingTime?this.duration-t:0;break;case A:e=0;break;case m:e=this._checkTimer.time;break;default:e=this.duration-t}return e>0&&(this._allowZeroRemainingTime=!0),this._currentTime=e}get currentTime(){return this._getCurrentTime()}_getAdDuration(){try{const e=this._video.getAdDuration();switch(e){case void 0:return g;default:return e}}catch(e){return g}}_getDuration(){const e=this._getAdDuration();switch(e){case g:case f:case _:return this._durationByRemainingTime>0?this._durationByRemainingTime:n.UNKNOWN_DURATION;default:return e}}get duration(){return this._getDuration()}}y.prototype._options={controls:!1,suspendTimeout:0,stallTimeout:0};var b=y;r.default=b},{"../../../../../common/js/utils/waitHelper":236,"../../../../../player/core/console":280,"../../../../../player/env/index":306,"../../../../../player/utils/catchHandler":327,"../../../../../player/utils/timer":336,"../../advert/media-container":173,"./../../../../../player/core/error":281,"./../../../../../player/providers/default":317,"./../../advert/media-container":173,"./../../advert/provider/default":175,"core-js/modules/es6.promise":97}],225:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace");var i=h(e("./vpaid-base")),s=h(e("./../../../../../player/core/iframe")),o=h(e("./../../../../../player/utils/unique")),a=h(e("./../../../../../player/env/index")),n=h(e("./../../../../../player/utils/dom")),l=h(e("../../../../../player/core/console")),d=h(e("./../../advert/provider/providers")),u=(e("./../../../../../player/providers/default"),h(e("../../../../../player/providers/behaviors/provider-auto-time"))),c=h(e("./vast"));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const _=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],g=["AdStarted","AdStopped","AdSkipped","AdLoaded","AdLinearChange","AdSizeChange","AdExpandedChange","AdSkippableStateChange","AdDurationChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdClickThru","AdInteraction","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdError","AdLog"],f='<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8">\n<style type="text/css">\nhtml, body {\nheight: 100%;\nwidth: 100%;\nmargin: 0;\npadding: 0;\n}\n</style>\n</head>\n<body>\n<script type="text/javascript">var inDapIF=true;<\/script>\n<script type="text/javascript" src="{{ src }}"><\/script>\n</body>\n</html>';class m extends i.default{constructor(...e){super(...e),this._infinityDuration=!1}static getName(){return"vpaid-js"}static supports(e){return e.type||(e.type=/[^.]+(\?|$)/.exec(e.src),e.type=e.type[0].replace("?","")),"js"===e.type||"application/javascript"===e.type||"application/x-javascript"===e.type}static getPriority(){return 2}destroy(){this._removeEventListeners(),this._loadWrapperIntervalStop(),super.destroy()}_loadWrapper(){return new Promise((e,t)=>{this._wrapper=new s.default(this.getPlayer(),{attributes:{id:(0,o.default)("vpaid"),allow:"autoplay"},src:"about:blank"}),this._setupElement(this._wrapper.getEl()),this.addChild(this._wrapper);let r=f.replace("{{ src }}",this.getOption("src").trim());if(r){let e=this._wrapper.getEl()[0],t=e.contentWindow&&e.contentWindow.document;if(!t)return;t.write(r),this._$wrapperBody=(0,n.default)(t.body)}const i=Date.now();this._loadWrapperInterval=setInterval(()=>{this._getVpaidObject()?(this._loadWrapperIntervalStop(),this._video=this._getVpaidObject()(),this._validateVpaidInterface()?(this._addEventListeners(),e()):t("invalid interface")):Date.now()-i>this._options.loadTimeout&&(this._loadWrapperIntervalStop(),t("timeout"))},100),this._loadWrapperIntervalStop=(()=>{clearInterval(this._loadWrapperInterval),delete this._loadWrapperInterval,delete this._loadWrapperIntervalStop})})}_loadWrapperIntervalStop(){}_loadVPAID(){return Promise.resolve()}_getVpaidObject(){let e,t=this._wrapper;if(t&&"function"==typeof t.getEl){let r=t.getEl()[0].contentWindow;r&&(e=r.getVPAIDAd)}return!(!e||"function"!=typeof e)&&e}_getCreativeData(){let e={};return this.getOption("AdParameters")&&(e.AdParameters=this.getOption("AdParameters")),e}_setupElement(e){e.css({width:"100%",height:"100%",position:"absolute",left:0,top:0})}_getEnvironmentVars(){let e=this.getEl(),t=this._v=document.createElement("video"),r=this._slot=document.createElement("div"),i=this._$video=(0,n.default)(t),s=this._$slot=(0,n.default)(r);return this._setupElement(i),this._setupElement(s),e.append(i),e.append(s),i[0].setAttribute("disableremoteplayback",""),i[0].setAttribute("webkit-playsinline",""),i[0].setAttribute("playsinline",""),i[0].setAttribute("src",""),(!0===a.default.adSilentAutoplayAlways||!1===a.default.autoPlay&&!0===a.default.silentAutoplay&&!1===this.getPlayer().isUserAction())&&(i[0].muted=!0),i.once("playing",e=>{l.default.log("### VPAID-JS Provider: use videoSlot"),this.adViaVideoSlot=!0}),this.adViaVideoSlot=!1,{slot:this._slot,videoSlot:this._v,videoSlotCanAutoPlay:a.default.autoPlay}}set adViaVideoSlot(e){l.default.log("### VPAID-JS Provider: set adViaVideoSlot",e),this._adViaVideoSlot!==e&&(this._adViaVideoSlot=e,e?this._$video.css("visibility","visible"):this._$video.css("visibility","hidden"))}get adViaVideoSlot(){return this._adViaVideoSlot}_addEventListeners(){let e=[];g.forEach(t=>{let r=(e,...r)=>{"AdRemainingTimeChange"!==t&&l.default.log("### VPAID-JS Provider: event",t,e);let i=this._wrapper;if(i)switch(t){case"AdStarted":i.trigger(t,e),!1===this.getMediaContainer().getOption("backPreload")&&setTimeout(()=>{this._getCurrentTime()<=0&&(this._callVpaid("pauseAd"),setTimeout(()=>{this._callVpaid("resumeAd")},250))},1100);break;case"AdError":"string"==typeof e?i.trigger(t,{message:e}):i.trigger(t,e);break;case"AdClickThru":case"AdInteraction":if("string"==typeof e){const s=e,o=p(r||["",!0],2),a=o[0],n=o[1];i.trigger(t,{url:s,id:a,playerHandles:n}),n&&!s&&this.parentProvider instanceof c.default&&this.getControls().adclickable.href&&window.open(this.getControls().adclickable.href)}else i.trigger(t,e);break;case"AdDurationChange":-2===e?(this._infinityDuration=!0,this._hideControls(),u.default.attach(this)):this._infinityDuration&&(this._infinityDuration=!1,this._showControls(),u.default.detach(this));break;default:i.trigger(t,e)}};this._video.subscribe(r,t),e.push({fn:r,event:t})}),this._videoListeners=e}_removeEventListeners(){this._videoListeners&&this._videoListeners.forEach(e=>{this._video.unsubscribe(e.fn,e.event)})}_validateVpaidInterface(){for(let e=0;e<_.length;e++)if("function"!=typeof this._video[_[e]])return!1;return!0}_getCurrentTime(){return this._infinityDuration?0:super._getCurrentTime()}_getDuration(){return this._infinityDuration?15:super._getDuration()}}m.prototype._options={controls:!1},d.default.register(m);var A=m;r.default=A},{"../../../../../player/core/console":280,"../../../../../player/providers/behaviors/provider-auto-time":316,"./../../../../../player/core/iframe":285,"./../../../../../player/env/index":306,"./../../../../../player/providers/default":317,"./../../../../../player/utils/dom":328,"./../../../../../player/utils/unique":337,"./../../advert/provider/providers":182,"./vast":223,"./vpaid-base":224,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],226:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace");var i=d(e("./vpaid-base")),s=d(e("./../../../../../player/core/swf")),o=d(e("./../../../../../player/utils/error")),a=d(e("./../../advert/provider/providers")),n=d(e("./../../../../../player/env/index")),l=d(e("../../../../../player/core/console"));function d(e){return e&&e.__esModule?e:{default:e}}window.vpaidFlashError=function(e){o.default.rethrow(new Error(`Flash error: ${e}`))};class u extends i.default{static getName(){return"vpaid-swf"}static disable(){this._disabled=!0}static getPriority(){return 1}static supports(e){return!this._disabled&&(e.type||(e.type=/[^.]+(\?|$)/.exec(e.src),e.type=e.type[0].replace("?","")),"swf"===e.type||"application/x-shockwave-flash"===e.type)}_getCreativeData(){let e="";return this.getOption("AdParameters")&&(e=this.getOption("AdParameters")),e}_loadWrapper(){return new Promise((e,t)=>{let r=this.getPlayer(),i=r.path+"/swf/vpaid.swf";this._wrapper=new s.default(r,{src:i,loadMethod:"jsFireMethod",visible:!0,listener:(e,t)=>{l.default.log(e,t);let r=this._wrapper;switch(e){case"AdError":"string"==typeof t?r.trigger(e,{message:t}):r.trigger(e,t);break;default:r.trigger(e,t)}}});let o=this._wrapper.getEl()[0];this.listenToOnce(this._wrapper,"ready",()=>{this._loadTimer&&clearTimeout(this._loadTimer),e()}),this.listenToOnce(this._wrapper,"error",()=>{t({code:2})}),this._video=o,this.addChild(this._wrapper),this._loadTimer=setTimeout(()=>{let e;this._loadTimer=!1;try{e=o.testMethod()}catch(t){e=!1}t({code:e?3:1})},5e3)})}_loadVPAID(){return new Promise((e,t)=>{this.listenToOnce(this._wrapper,"content.loaded",e),this.listenToOnce(this._wrapper,"content.ioerror content.securiryerror",e=>{t(this._getPlayerErrorByAdError(e))}),this._video.load(this.getOption("src"))})}}u.prototype._options={controls:!1},n.default.hasFlash&&a.default.register(u);var c=u;r.default=c},{"../../../../../player/core/console":280,"./../../../../../player/core/swf":296,"./../../../../../player/env/index":306,"./../../../../../player/utils/error":329,"./../../advert/provider/providers":182,"./vpaid-base":224,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],227:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Player",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Providers",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"Plugin",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"OMVP_VERSION",{enumerable:!0,get:function(){return a.OMVP_VERSION}}),Object.defineProperty(r,"path",{enumerable:!0,get:function(){return n.path}}),e("../polyfill/index");var i=l(e("../../player/core/player"));e("../../player/core/translate");var s=l(e("../../player/providers/providers")),o=l(e("../../player/core/plugin"));e("../../player/providers/html5"),e("../../player/providers/html5-audio"),e("../../player/providers/flv"),e("../../player/providers/youtube"),e("../../player/providers/vimeo"),e("../../player/plugins/li"),e("../../player/plugins/tns"),e("../../player/plugins/settings-sync");var a=e("../../../config/player-version"),n=e("./utils/path");function l(e){return e&&e.__esModule?e:{default:e}}},{"../../../config/player-version":1,"../../player/core/player":288,"../../player/core/plugin":289,"../../player/core/translate":297,"../../player/plugins/li":309,"../../player/plugins/settings-sync":314,"../../player/plugins/tns":315,"../../player/providers/flv":318,"../../player/providers/html5":320,"../../player/providers/html5-audio":319,"../../player/providers/providers":322,"../../player/providers/vimeo":323,"../../player/providers/youtube":324,"../polyfill/index":238,"./utils/path":233}],228:[function(e,t,r){"use strict";let i;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,{value:r,configurable:s,enumerable:o}){if("function"!=typeof r)throw new SyntaxError(`@autobind can only be used on functions, not: ${r}`);const a=e.constructor;return{configurable:s,enumerable:o,get(){if(this===e)return r;if(this.constructor!==a&&Object.getPrototypeOf(this).constructor===a)return r;if(this.constructor!==a&&t in this.constructor.prototype)return function(e,t){if("undefined"==typeof WeakMap)throw new Error(`Using @autobind on ${t.name}() requires WeakMap support due to its use of super.${t.name}()\n      See https://github.com/jayphelps/core-decorators.js/issues/20`);i||(i=new WeakMap);!1===i.has(e)&&i.set(e,new WeakMap);const r=i.get(e);!1===r.has(t)&&r.set(t,t.bind(e));return r.get(t)}(this,r);const s=r.bind(this);return Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!1,value:s}),s},set(e){return Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e}),e}}},e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.weak-map")},{"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.weak-map":110,"core-js/modules/web.dom.iterable":115}],229:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rafSetInterval=r.rafSetTimeout=r.RafTimer=void 0,e("core-js/modules/es6.array.from"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable");var i,s=(i=e("./getTime"))&&i.__esModule?i:{default:i};function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}const a=1,n=2,l=3,d=4,u=1,c=2;class h{constructor(e,t=100,r=h.TYPE_TIMEOUT,i=null){if("function"!=typeof e)throw new Error("unknown callback type");if(r!==h.TYPE_TIMEOUT&&r!==h.TYPE_INTERVAL)throw new Error("unknown timer type");this._status=a,this._callback=e,this._timeout=t,this._type=r,this._args=i,this._mode=u,this._startTime=-1,this._fireTime=-1,this._setTimeoutFire=this._setTimeoutFire.bind(this),this._setTimeout=null}_updateType(){}_changeModeToRaf(){m=!1,this._mode=u,this._setTimeout&&(clearTimeout(this._setTimeout),this._setTimeout=null)}_changeModeToSetTimeout(){m=!0,this._mode=c;let e=(0,s.default)(),t=Math.max(0,this._fireTime-e);this.isWork&&(this._setTimeout=setTimeout(this._setTimeoutFire,t))}_setTimeoutFire(){this._setTimeout&&(clearTimeout(this._setTimeout),this._setTimeout=null);let e=(0,s.default)();!1===this.fire()||this._type===h.TYPE_TIMEOUT?this.stop():(this._fireTime=e+this._timeout,this._setTimeout=setTimeout(this._setTimeoutFire,this._timeout))}get type(){return this._type}get mode(){return this._mode}set mode(e){if(e!==u&&e!==c)throw new Error("unknown timer mode");this._mode!==e&&(e===u?this._changeModeToRaf():this._changeModeToSetTimeout())}get isEnd(){return this._status===d}get isWork(){return this._status===n}get isPause(){return this._status===l}start(){this._status=n,this._startTime=(0,s.default)(),this._fireTime=this._startTime+this._timeout}pause(){this._status=l,this._setTimeout&&(clearTimeout(this._setTimeout),this._setTimeout=null)}resume(){this._status!==n&&this._status!==d&&(this._status=n,this._mode===c&&this._changeModeToSetTimeout())}stop(){this._status!==d&&(this._status=d,this._setTimeout&&(clearTimeout(this._setTimeout),this._setTimeout=null))}tick(e,t,r){if(this._status===l&&(this._fireTime+=r),this._status===n){if(this.mode===c){if(this.type!==h.TYPE_INTERVAL)return;this._changeModeToRaf()}if(e>=this._fireTime){this._fireTime=-1,!1===this.fire()||this._type===h.TYPE_TIMEOUT?this.stop():this._fireTime=e+this._timeout}}}fire(){return this._callback.apply(this,o(this._args))}}r.RafTimer=h,h.TYPE_TIMEOUT=1,h.TYPE_INTERVAL=2;r.rafSetTimeout=function(e,t,...r){let i=new h(e,t,h.TYPE_TIMEOUT,r);return p.push(i),i.start(),i};r.rafSetInterval=function(e,t,...r){let i=new h(e,t,h.TYPE_INTERVAL,r);return p.push(i),i.start(),i};let p=[],_=(0,s.default)(),g=((0,s.default)(),0),f=null,m=!1,A=0,v=function e(){let t=(0,s.default)()-_;if(Math.abs(t)>100){if(!1===m&&++A>1){for(let e in p)p.hasOwnProperty(e)&&!1===p[e].isEnd&&(p[e].mode=c);m=!0,A=2}}else{if(--A<=0&&(A=0,m))for(let e in p)p.hasOwnProperty(e)&&!1===p[e].isEnd&&p[e].type===h.TYPE_INTERVAL&&(p[e].mode=u);m=!1}m&&(_=(0,s.default)()),f=setTimeout(e,50)};window.requestAnimationFrame(function e(){let t=(0,s.default)(),r=t-_;for(let e in p)p.hasOwnProperty(e)&&(p[e].isEnd?(p[e]=void 0,delete p[e]):p[e].tick(t,_,r));_=t,g=r,window.requestAnimationFrame(e),f=setTimeout(v,50)}),f=setTimeout(v,50)},{"./getTime":231,"core-js/modules/es6.array.from":92,"core-js/modules/es6.regexp.to-string":105,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],230:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.sort"),e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes");var i;(i=e("../../../player/core/console"))&&i.__esModule;var s={_loadedAds:[],_rejectedAds:[],get loadedAds(){return this._loadedAds},get rejectedAds(){return this._rejectedAds},_isExist(e,t){let r;return(r="rejected"===t?this.rejectedAds:this.loadedAds).map(e=>e.ad).includes(e)},addLoaded(e,t){!1===this._isExist(e)&&(this._loadedAds.push({ad:e,index:t}),this.sortAds())},addRejected(e,t){return(!e||!e.getIsRtb())&&(!1===this._isExist(e,"rejected")&&this._rejectedAds.push({ad:e,index:t}),!0)},removeAd(e){if(e){let t=this.loadedAds.map(e=>e.ad).indexOf(e);this._loadedAds.splice(t,1)}},getFirstAd(){return this.count()>0?this._loadedAds[0].ad:null},getFirstIndex(){return this.count()?this._loadedAds[0].index:null},sortAds(){this._loadedAds=this.loadedAds.sort((e,t)=>e.index-t.index)},count(){return this._loadedAds.length},countRejected(){return this._rejectedAds.length},getIds(){return this._loadedAds.map(e=>e.ad.getAdId())},clear(){this._loadedAds=[],this._rejectedAds=[]}};r.default=s},{"../../../player/core/console":280,"core-js/modules/es6.array.sort":94,"core-js/modules/es6.string.includes":107,"core-js/modules/es7.array.includes":111}],231:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return i?performance.now()+performance.timing.navigationStart:(new Date).getTime()};let i="undefined"!=typeof performance&&void 0!==performance.now},{}],232:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getPropertyDescriptor=function e(t,r,i=[]){i.push(t);if(t.hasOwnProperty(r)){let e=Object.getOwnPropertyDescriptor(t,r);return e.path=i,e.owner=t,e}return r in t?e(t.__proto__,r,i):void 0}},{}],233:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.path=function(e){return function(e){if(!e||!e.src)return"";return e.src.replace(/[\\/][^\\/]+$/,"")}(function(e){let t=document.getElementsByTagName("script"),r=new RegExp("/"+e);for(let e=0;e<t.length;e++)if(r.test(t[e].src))return t[e]}(e))},e("core-js/modules/es6.regexp.constructor"),e("core-js/modules/es6.regexp.replace")},{"core-js/modules/es6.regexp.constructor":99,"core-js/modules/es6.regexp.replace":102}],234:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.words=a,r.capitalize=n,r.camelCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>(t=t.toLowerCase(),e+(r?n(t):t)),"")},r.upperCamelCase=l,r.kebabCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?"-":"")+t.toLowerCase(),"")},r.lowerCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?" ":"")+t.toLowerCase(),"")},r.snakeCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?"_":"")+t.toLowerCase(),"")},r.startCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?" ":"")+u(t.toLowerCase()),"")},r.upperCase=function(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?" ":"")+t.toUpperCase(),"")},r.upperFirst=u,r.replaceAll=function e(t,r,i){if(!1===Array.isArray(r)&&"object"==typeof r){for(let i in r)r.hasOwnProperty(i)&&(t=e(t,i,r[i]));return t}return t.split(r).join(i)},r.pascalCase=void 0,e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.match");var i=e("./unicode");const s=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function a(e,t=null){if(null===t){return(o.test(e)?e.match(i.unicodeWords):e.match(s))||[]}return e.match(t)||[]}function n(e){return u(e.toLowerCase())}function l(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+n(t=t.toLowerCase()),"")}const d=l;function u(e){return a(`${e}`.replace(/['\u2019]/g,"")).reduce((e,t,r)=>e+(r?" ":"")+t[0].toUpperCase()+t.substr(1),"")}r.pascalCase=d},{"./unicode":235,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104}],235:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hasUnicode=function(e){return v.test(e)},r.unicodeWords=void 0,e("core-js/modules/es6.regexp.constructor");const i="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",o=`[${s}]`,a="\\d+",n="[\\u2700-\\u27bf]",l="[a-z\\xdf-\\xf6\\xf8-\\xff]",d=`[^\\ud800-\\udfff${s+a+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde"}]`,u="(?:\\ud83c[\\udde6-\\uddff]){2}",c="[\\ud800-\\udbff][\\udc00-\\udfff]",h="[A-Z\\xc0-\\xd6\\xd8-\\xde]",p=`(?:${l}|${d})`,_=`(?:${h}|${d})`,g=`${`(?:${`[${i}]`}|\\ud83c[\\udffb-\\udfff])`}?`,f="[\\ufe0e\\ufe0f]?"+g+`(?:\\u200d(?:${["[^\\ud800-\\udfff]",u,c].join("|")})${"[\\ufe0e\\ufe0f]?"+g})*`,m=`(?:${[n,u,c].join("|")})${f}`,A=RegExp([`${h}?${l}+(?:['’](?:d|ll|m|re|s|t|ve))?(?=${[o,h,"$"].join("|")})`,`${_}+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=${[o,h+p,"$"].join("|")})`,`${h}?${p}+(?:['’](?:d|ll|m|re|s|t|ve))?`,`${h}+(?:['’](?:D|LL|M|RE|S|T|VE))?`,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",a,m].join("|"),"g");r.unicodeWords=A;const v=RegExp(`[${"\\u200d\\ud800-\\udfff"+i+"\\ufe0e\\ufe0f"}]`)},{"core-js/modules/es6.regexp.constructor":99}],236:[function(e,t,r){"use strict";function i(){}Object.defineProperty(r,"__esModule",{value:!0}),r.waitHelper=void 0,e("core-js/modules/es7.promise.finally"),e("core-js/modules/es6.promise");const s=new class{wait(e,t){let r="object"==typeof t?t:{timeout:"number"==typeof t?t:0,resolveTrue:!0};return r||(r={timeout:0,resolveTrue:!0}),"resolveTrue"in r==0&&(r.resolveTrue=!0),"throwWhenTimeout"in r==0&&"rejectWhenTimeout"in r==0&&"resolveFalseWhenTimeout"in r==0&&(r.resolveFalseWhenTimeout=!0),new Promise((t,i)=>{let s=r.timeout>0?setTimeout(()=>{s=void 0,r.resolveFalseWhenTimeout?t(!1):r.rejectWhenTimeout?i():r.throwWhenTimeout},r.timeout):null;const o=(...i)=>{e.apply(void 0,i)?(s&&(clearTimeout(s),s=void 0),r.resolveTrue&&t(!0)):requestAnimationFrame(o)};requestAnimationFrame(o)})}asyncTimeout(e=0){return new Promise(t=>{setTimeout(t,e)})}resettableTimout(e,t,r=!0,s="Timeout #timeout#"){let o=()=>{n=null,a=i,o=i},a=()=>{n=null,o=i,a=null,t(!1!==r?new Error(!0===r?"":r+": Timeout "+e+(s?". "+s:"")):void 0)},n=this.asyncTimeout(e);return n.finally(a),o}promiseTimeout(e,t,r=!0,s="Timeout #timeout#"){return new Promise(o=>{let a=()=>{t=null,a=null,o(!1!==r?new Error(!0===r?"":r+": Timeout "+e+(s?". "+s:"")):void 0)};t.then(e=>{a=i,o(e)}),this.asyncTimeout(e).finally(a)})}};r.waitHelper=s},{"core-js/modules/es6.promise":97,"core-js/modules/es7.promise.finally":113}],237:[function(e,t,r){"use strict";var i,s=(i=e("fastclick"))&&i.__esModule?i:{default:i};document.addEventListener("DOMContentLoaded",function(){(0,s.default)(document.body)},!1)},{fastclick:116}],238:[function(e,t,r){"use strict";e("./fast-click"),e("./promise-finally"),e("fullscreen-polyfill")},{"./fast-click":237,"./promise-finally":239,"fullscreen-polyfill":117}],239:[function(e,t,r){"use strict";if(e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/es7.promise.finally"),e("core-js/modules/es6.promise"),"function"!=typeof Promise)throw new TypeError("A global Promise is required");if("function"!=typeof Promise.prototype.finally){let e=function(e,t){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Assertion failed: Type(O) is not Object");let r=e.constructor;if(void 0===r)return t;if(!r||"object"!=typeof r&&"function"!=typeof r)throw new TypeError("O.constructor is not an Object");let i="function"==typeof Symbol&&"symbol"==typeof Symbol.species?r[Symbol.species]:void 0;if(null==i)return t;if("function"==typeof i&&i.prototype)return i;throw new TypeError("no constructor found")},t={finally(t){let r=this;if("object"!=typeof r||null===r)throw new TypeError('"this" value is not an Object');let i=e(r,Promise);return"function"!=typeof t?Promise.prototype.then.call(r,t,t):Promise.prototype.then.call(r,e=>new i(e=>e(t())).then(()=>e),e=>new i(e=>e(t())).then(()=>{throw e}))}};Object.defineProperty(Promise.prototype,"finally",{configurable:!0,writable:!0,value:t.finally})}},{"core-js/modules/es6.promise":97,"core-js/modules/es6.symbol":109,"core-js/modules/es7.promise.finally":113,"core-js/modules/es7.symbol.async-iterator":114}],240:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MVPlayer=void 0;var i=e("../common/js/EmbedPlayer");e("./js/plugins/LogPlugin"),e("./js/plugins/MvPlayListPlugin"),e("./js/plugins/MoevideoKibanaPlugin"),e("./js/plugins/PostMessagePlugin"),e("./js/plugins/ComscoreCounterPlugin"),e("./js/plugins/ClickerPlugin"),e("./js/plugins/backend/BackendPlugin"),e("../ad/js/plugins/advert/AdvertPluginPlayer"),e("../ad/js/plugins/vast/index"),e("../rs/js/embed/plugins/RsPromoPlugin");var s=l(e("./../player/utils/dom")),o=l(e("./../player/utils/extend")),a=l(e("./../player/core/translate")),n=l(e("../player/core/console"));function l(e){return e&&e.__esModule?e:{default:e}}s.default.setNs("mv"),void 0===window.log&&(window.log=function(){});let d={plugins:{postmessage:{}}},u=function e(t,r){return r.version=i.OMVP_VERSION,r.path=e.path,r=(0,o.default)(d,r),new i.Player(t,r)};r.MVPlayer=u,u.log=function(){},u.path=(0,i.path)("mvplayer"),u.version=i.OMVP_VERSION,u.registerProvider=i.Providers.register,u.registerPlugin=Plugin.register,u.addLang=function(e,t){a.default.addLang(e,t)},u.console=n.default,"undefined"==typeof setupMvUidCallback&&(window.setupMvUidCallback=function(e){n.default.info("ID пользователя установлен для домена: "+e.host)}),"undefined"==typeof setupMvSidCallback&&(window.setupMvSidCallback=function(e){n.default.info("ID сессии пользователя установлен для домена: "+e.host)})},{"../ad/js/plugins/advert/AdvertPluginPlayer":122,"../ad/js/plugins/vast/index":217,"../common/js/EmbedPlayer":227,"../player/core/console":280,"../rs/js/embed/plugins/RsPromoPlugin":340,"./../player/core/translate":297,"./../player/utils/dom":328,"./../player/utils/extend":330,"./js/plugins/ClickerPlugin":242,"./js/plugins/ComscoreCounterPlugin":243,"./js/plugins/LogPlugin":244,"./js/plugins/MoevideoKibanaPlugin":245,"./js/plugins/MvPlayListPlugin":246,"./js/plugins/PostMessagePlugin":247,"./js/plugins/backend/BackendPlugin":248}],241:[function(e,t,r){"use strict";var i=e("./MVPlayer");window.mvplayer=i.MVPlayer},{"./MVPlayer":240}],242:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ClickerPlugin=void 0,e("core-js/modules/es6.promise");var i=a(e("../../../player/utils/ajax")),s=a(e("../../../player/utils/dom")),o=a(e("../../../player/core/plugin"));function a(e){return e&&e.__esModule?e:{default:e}}class n extends o.default{load(){return this._load().then(()=>{this._el=(0,s.default)("<div/>").css({position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:1e4,cursor:"pointer"}),this.getPlayer().getEl().append(this._el),this.listenTo(this._el,"click",this._click)},()=>{})}_load(){let e=this.getOption("src"),t=this.getOption("url");return e?this._loadScript(e):t?Promise.resolve():Promise.reject("no clicker")}_click(){let e=this.getOption("url");this.getOption("src")&&"function"==typeof window.onClickTrigger?window.onClickTrigger():e&&window.open(e,"_blank"),this.getPlayer().trigger("clickerClick"),this._el.remove(),this.destroy()}_loadScript(e){return(0,i.default)({url:e,timeout:3e3,dataType:"script"}).then(()=>{if("function"!=typeof window.onClickTrigger)return Promise.reject();this.getPlayer().getEl().append(this)})}}r.ClickerPlugin=n,o.default.register("clicker",n)},{"../../../player/core/plugin":289,"../../../player/utils/ajax":325,"../../../player/utils/dom":328,"core-js/modules/es6.promise":97}],243:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ComscoreCounterPlugin=void 0,e("core-js/modules/es6.regexp.replace");var i=o(e("../../../player/core/media-container")),s=o(e("../../../player/core/plugin"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends s.default{constructor(e,t){super(e,t),this.getOption("id")&&(this._ref=this._getRef(),this.listenTo(this.getPlayer(),"create",this._onCreate))}_getRef(){let e=window.location.href,t=this.getOption("mirrors");if("string"==typeof t)e=window.location.href.replace(window.location.host,t);else for(let r in t)if(t.hasOwnProperty(r)&&window.location.host===r){e=window.location.href.replace(window.location.host,t[r]);break}return e}_onCreate(e){let t=e.target;t instanceof i.default&&this.listenToOnce(t,"start",this._sendEvent)}_sendEvent(e){"undefined"!=typeof COMSCORE&&COMSCORE.beacon({c1:"1",c2:this.getOption("id"),c4:this._ref,c5:e.target.getOption("advert")?"09":"06"})}}r.ComscoreCounterPlugin=a,s.default.register("comscore",a)},{"../../../player/core/media-container":287,"../../../player/core/plugin":289,"core-js/modules/es6.regexp.replace":102}],244:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LogPlugin=void 0;var i=n(e("../../../player/core/plugin")),s=e("../../../player/plugins/log/LogPluginDefault"),o=e("./backend/embed-api"),a=n(e("../../../player/utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}class l extends s.LogPluginDefault{constructor(e,t){if(super(e,t),this.availableForUser){let e=this._logPanel;e.on("needSave",()=>{this.save().then(t=>{e.setUrl(t.url)}).catch(e=>(0,a.default)(e))})}}save(){return this._log("Сохранение лога...",!1,!0),(0,o.post)("log/save",{log:this._logPanel.getEl()[0].innerHTML})}}r.LogPlugin=l,i.default.register("log",l)},{"../../../player/core/plugin":289,"../../../player/plugins/log/LogPluginDefault":310,"../../../player/utils/catchHandler":327,"./backend/embed-api":250}],245:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MoevideoKibanaPlugin=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.split");var i=c(e("../../../player/core/media-container")),s=c(e("../../../ad/js/plugins/advert/media-container")),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../../ad/js/plugins/vast/providers/vpaid-base")),a=c(e("../../../ad/js/plugins/vast/providers/vast")),n=c(e("../../../player/providers/metaprovider")),l=c(e("../../../player/core/plugin")),d=(e("../../../player/utils/ajax"),c(e("../../../player/env/index"))),u=c(e("../../../player/utils/catchHandler"));function c(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let p,_=Math.random()<.01;p=[{method:"==",width:10,height:10,name:"10x10"},{width:320,height:240,name:"noAd"},{width:640,height:360,name:"240p"},{width:1280,height:720,name:"360p"},{width:1920,height:1080,name:"720p"},{width:3840,height:2160,name:"1080p"},{width:7680,height:4320,name:"2160p"}];class g extends l.default{constructor(e,t){if(super(e,t),this._startDate=new Date-0,this._logArr={},this._logAds={},this._errorCount=0,d.default.isBot)return;this.listenTo(e,{create:this._onCreate,error:this._onError,adWrapperLoading:this._logAdWrapperLoading,inventoryLog:this._logInventory,adStatSend:this._logAdStat,log:this._logAdvancedMessage,adLog:this._logAd,adSlotLog:this._logAdSlot,adPositionCount:this._logAdSlotCount,adTryToPlay:this._logAdTryToPlay,ready:this._logPlayerReady,pluginStorageDoNotWork:this._onPluginStorageDoNotWork,AdVpaidJsViaVideoSlot:this._onAdVpaidJsViaVideoSlot,adUrlReplacerError:this._onAdUrlReplacerError,adSlotStat:this._onAdSlotStat,tryToPlayVideo:this._onTryToPlayVideo,clickerClick:this._onClickerClick,change:this._onVideoChange,adListEmpty:this._onAdListEmpty,adSavedToStorage:this._onAdSavedToStorage,adRemovedFromStorage:this._onAdRemovedFromStorage,adTrySaveToStorage:this._onAdTrySaveToStorage,topUrlDetected:this._onTopUrlDetected});let r=e.getMediaContainer();r&&this._onCreate({item:r}),this._debugAdData={},this._videoChangeCount=0,this._adBlockDetected=!1,this.getPlayer().getStorage().getItem("adBlock").then(e=>{this._adBlockDetected=e}).catch(e=>(0,u.default)(e))}_onTopUrlDetected(e){this._topUrl=e.url}_log(e,t={}){let r=[Math.round((new Date-this._startDate)/100)/10,t],i=e.split("."),s=this._logArr;for(let e=0;e<i.length;e++){let t=i[e];s.hasOwnProperty(t)||(s[t]={}),s=s[t]}s.hasOwnProperty("_")||(s._=[]),s._.push(r);let o=t.adId,a=this._logAds;o&&(a.hasOwnProperty(o)||(a[o]=[]),a[o].push([e,r]))}_getLogForAd(e){return this._logAds[e]}_onVpaidInitAdDuration(e){this._send({Type:"VpaidInitAdDuration",duration:e.duration,result:e.result})}_logPlayerReady(){this._log("player_ready")}_onClickerClick(){this._log("clicker")}_onVideoChange(){this._videoChangeCount++>0&&(this._log("change_video"),this._send({Type:"VideoChange"}))}_onAdListEmpty(){this._adsEmpty=!0}_getPlayerSize(){let e=this.getPlayer(),t=e.width,r=e.height;for(let e=0;e<p.length;e++){let i=p[e];if(void 0!==i.method)switch(i.method){case"=":case"==":if(i.width==t&&i.height==r)return i.name}else if(i.width>t||i.height>r)return i.name}return"4320p"}_logInventory(e){let t,r=this.getPlayer(),i=r.getPlugin("backend"),s=r.getPlugin("advert"),o=e.slot,a=r.testMode;if("player"!==o||!i.getOption("inventoryDisablePlayerSlot")){switch(this._log("inventory",o),o){case"player":case"content":case"over_click":case"over_focus":let i=r.visibility,n=r.getStorage();t={Type:"Invent",adSlot:o,adSlotId:e.slotId,adsEmpty:!!this._adsEmpty,autoPlay:d.default.autoPlay?"yes":d.default.silentAutoplay?d.default.adSilentAutoplayAlways?"silent-always":"silent":"no",test:a,fd:+i.fullDetectionSupport,fdm:i.fullDetectionMethod,storage:n.type,topUrl:this._topUrl||"",playerSize:this._getPlayerSize()};break;case"vast":t={Type:"Invent",adSlot:o,adSlotId:e.slotId,test:a,vpaidType:s.getVpaidManager().vpaidType,playerSize:this._getPlayerSize()};break;default:t={Type:"Invent",adSlot:o,adSlotId:e.slotId,test:a}}if(t){switch(o){case"player":case"content":case"over_click":case"over_focus":case"vast":let e=r.refInfo;e&&(t.refInfo_ref=e.ref,t.refInfo_referer=e.referer,t.refInfo_refN=e.refN,t.refInfo_count=e.count,t.refInfo_success=e.success,e.error&&(t.refInfo_error=e.error))}this._sendLog(t)}if("player"===o&&!i.getOption("inventoryDisablePlayerSlot")){let e=setTimeout(()=>{let e=r.getMediaContainer().getOption("video"),t={Type:"VideoShowError",referer:i.getOption("referer"),videoSrc:e.src,videoProvider:e.provider};this._sendLog(t)},6e4);r.once("start",()=>{clearTimeout(e)})}}}_onTryToPlayVideo(){this._log("video","try")}_logSlot(e,t){this._log(`slot.${e}`,t)}_logAdvert(e,t,r,i){this._log(`slot.${e}.${t}.${r}`,i)}_logAdStat(e){this._logAdvert(e.slotId,e.adId,"stat",e.data||e.event)}_logAdvancedMessage(e){this._log("log",{msg:e.message,type:e.type})}_logAd(e){this._logAdvert(e.slotId,e.adId,"log",e.action)}_logAdTryToPlay(e){this._logAdvert(e.adSlotId,e.adId,"log","try_to_play")}_isInstreamvideo(e){return 2==e}_isRontar(e){return-1!==[19542,25892,10592,19972,10032].indexOf(+e)}_isBuzzoola(e){return-1!==[27862].indexOf(+e)}_isAdvark(e){return-1!==[24932].indexOf(+e)}_isVihub(e){return-1!==[28082].indexOf(+e)}_needDebugAd(e){return this._isInstreamvideo(e)}_onAdVpaidJsViaVideoSlot(e){this._sendLog({Type:"VpaidJsViaVideoSlot",adId:e.adId,adSlotId:e.slotId})}_logAdWrapperLoading(e){let t=e.info,r=+t.depth,i=t.adId,s=t.adCampaignId,o=t.slotId,a=t.url,n=t.xml||"",l=t.action,d=this.getPlayer();if(this._logAdvert(o,i,"wrapper",{url:a,code:t.code,message:t.message||"",action:l,start:t.start,end:t.end,xml:n,time:(t.end-t.start)/1e3,isError:t.code||t.message,adId:i}),"parseFail"===l&&this._sendLog({Type:"VastWrapper",Subtype:"ParseFail",Info:t.Info,url:a,xml:n,xhrStatus:t.xhrStatus,xhrStatusText:t.xhrStatusText,isWrapper:t.isWrapper,timeout:t.timeout,code:t.code,message:t.message,adId:i,slotId:o,adCampaignId:s}),"requestFail"===l&&this._sendLog({Type:"VastWrapper",Subtype:"RequestFail",code:t.code,url:a,xhrStatus:t.xhrStatus,message:t.message||"",xhrStatusText:t.xhrStatusText,timeout:t.timeout,duration:t.duration,isHttps:"https:"===location.protocol,isError:t.isError,adId:i,slotId:o,adCampaignId:s}),this._needDebugAd(s))switch(l){case"requestStart":this._setAdDebugInfo(s,i,o,`VastUrl_${r}`,a);break;case"requestSuccess":this._setAdDebugInfo(s,i,o,`VastUrl_${r}_state`,"success"),this._setAdDebugInfo(s,i,o,"VastXML",n);break;case"requestFail":this._setAdDebugInfo(s,i,o,`VastUrl_${r}_state`,"fail");break;case"parseSuccess":0===r&&(this._setAdDebugInfo(s,i,o,"VastParseSuccess_size",`${d.width}x${d.height}`),this._setAdDebugInfo(s,i,o,"VastParseSuccess"));break;case"parseFail":this._setAdDebugInfo(s,i,o,`VastXML_${r}`,n)}}_onAdSavedToStorage(e){this._setAdDebugInfo(e.adCampaignId,e.adId,e.adSlotId,"SavedToStorage")}_onAdTrySaveToStorage(e){this._setAdDebugInfo(e.adCampaignId,e.adId,e.adSlotId,"TrySaveToStorage")}_onAdRemovedFromStorage(e){this._setAdDebugInfo(e.adCampaignId,e.adId,e.adSlotId,"RemovedFromStorage",e.outdated?2:1),this._setAdDebugInfo(e.adCampaignId,e.adId,e.adSlotId,"adSlotIdSrc",e.adSlotIdSrc)}_logAdSlot(e){this._logSlot(e.adSlotId,"log",{action:e.action,isError:e.isError})}_logAdSlotCount(e){this._logSlot(e.adSlotId,"count",e.count)}_onAdSlotStat(e){let t=e.data,r="",i=()=>{this._sendLog({Type:"AdSlotStat",slot:e.slot,slotId:e.slotId,success:t.success,count:t.count,tryCount:t.tryCount,minPreLoadTimeout:t.minPreLoadTimeout,maxPreLoadTimeout:t.maxPreLoadTimeout,avgPreLoadTimeout:t.avgPreLoadTimeout,minPreLoadTimeoutValue:t.minPreLoadTimeoutValue,maxPreLoadTimeoutValue:t.maxPreLoadTimeoutValue,avgPreLoadTimeoutValue:t.avgPreLoadTimeoutValue,minLoadTimeout:t.minLoadTimeout,maxLoadTimeout:t.maxLoadTimeout,avgLoadTimeout:t.avgLoadTimeout,minLoadTimeoutValue:t.minLoadTimeoutValue,maxLoadTimeoutValue:t.maxLoadTimeoutValue,avgLoadTimeoutValue:t.avgLoadTimeoutValue,minPlayTimeout:t.minPlayTimeout,maxPlayTimeout:t.maxPlayTimeout,avgPlayTimeout:t.avgPlayTimeout,minPlayTimeoutValue:t.minPlayTimeoutValue,maxPlayTimeoutValue:t.maxPlayTimeoutValue,avgPlayTimeoutValue:t.avgPlayTimeoutValue,globalTimeout:t.globalTimeout,globalTimeoutAdId:t.globalTimeoutAdId,globalTimeoutAdCID:t.globalTimeoutAdCID,timeout:t.timeout,log:JSON.stringify(t.log),logUrl:r,filtered:JSON.stringify(t.filtered)})},s=this.getPlayer().getPlugin("backend").getOption("ref");-1!==["altapress.ru","free-news.su","subscribe.ru","ollnewz.ru","real-vin.com","diletant.media","newsyou.info","planet-today.ru","v-kurse.ru","novostigroupp.ru","autodont.ru","azpolitika.info","online812.ru","newsrbk.ru","sobytiya.info","boss-consult.ru","saint-petersburg.ru"].indexOf(s)?this._saveLog().then(e=>{r=e,i()}).catch(e=>i):i()}_onAdUrlReplacerError(e){_&&this._send({Type:"AdUrlReplacerError",url:e.url,label:e.label})}_onPluginStorageDoNotWork(){_&&this._sendLog({Type:"GlobalStorage",Subtype:"doNotWork"})}load(){return window.addEventListener("error",e=>{e.filename&&this._sendError(this._prepareNativeError(e))}),super.load()}_sendError(e){function t(){}e&&!d.default.isBot&&(++this._errorCount>10||(e.PlayerVersion=this.getPlayer().version,e.PlayerVisible=+this.getPlayer().visible,e.adBlock=d.default.adBlock?"true":"false",e.flash=+d.default.hasFlash,this._saveLog().then(t=>{e.log=t}).catch(e=>t)))}_onError(e){e.originalEvent&&e.originalEvent.filename&&this._sendError(this._prepareNativeError(e.originalEvent))}_prepareNativeError(e){if(0!==e.filename.indexOf(this.getPlayer().path))return;let t={Type:"JS"};try{t.Info=e.message,e.lineno&&e.colno&&(t.Info+="("+e.lineno+":"+e.colno+")"),e.filename&&(t.File=e.filename.replace(/(.*)\?.*/,"$1")),e.error&&e.error.stack&&(t.Stack=e.error.stack)}catch(e){t.Info=e.message}return t}_setAdDebugInfo(e,t,r,i,s=1){if(!this._needDebugAd(e))return;let o,a=JSON.stringify([+t,+r]),n=this.getPlayer();switch(!0){case this._isInstreamvideo(e):o="Instreamvideo";break;case this._isRontar(t):o="Rontar";break;case this._isBuzzoola(t):o="Buzzoola";break;case this._isAdvark(t):o="Advark";break;case this._isVihub(t):o="Vihub";break;default:o="DebugAd"}this._debugAdData.hasOwnProperty(a)||(this._debugAdData[a]={sended:!1,timeout:0,data:{Type:o,adId:t,adSlotId:r,adSlotIdSrc:0,adCID:e,selectedForShow:0,VastInsertedToDom:0,VastProvider:"unknown",VastProviderFail:!1,VastStart:0,VastParseSuccess:0,VpaidAdLoaded:0,VpaidAdStarted:0,VpaidAdImpression:0,VpaidAdVideoStart:0,SavedToStorage:0,TrySaveToStorage:0,RemovedFromStorage:0,autoPlay:d.default.autoPlay?"yes":d.default.silentAutoplay?d.default.adSilentAutoplayAlways?"silent-always":"silent":"no",referer:n.getPlugin("backend").getOption("referer")}});let l=this._debugAdData[a],u=()=>{if(l.sended)return;let e=Math.random()<.01,t=l.data.VastXML;t&&t.length>500&&(e=!0),e?this._saveLog().then(e=>{l.data.log=e,this._sendLog(l.data,!0)}).catch(e=>this._sendLog(l.data,!0)):this._sendLog(l.data,!0),clearTimeout(l.timeout),l.sended=!0};l.data[i]=s,console.info(i);let c=e=>{l.timeout||(console.info(`tryToSend: ${e}`),l.timeout=setTimeout(u,e))};switch(i){case"VpaidAdVideoStart":case"VpaidAdError":case"VastStart":c(1e3);break;case"selectedForShow":case"SavedToStorage":case"TrySaveToStorage":c(1e4);break;case"VastUrl_0":c(2e4);break;case"RemovedFromStorage":c(2==s?1e3:1e4)}}_onCreateVpaid(e){let t=e.getMediaContainer(),r=t.getCampaignId(),i=t.getAdId(),s=t.getAdSlotId();this._needDebugAd(r)&&this.listenTo(e,{vpaid:e=>{let t=e.event;switch(t){case o.VPAID_EVENT.AdLoaded:case o.VPAID_EVENT.AdStarted:case o.VPAID_EVENT.AdImpression:case o.VPAID_EVENT.AdVideoStart:case o.VPAID_EVENT.AdError:this._setAdDebugInfo(r,i,s,`Vpaid${t}`)}}})}_onCreateVast(e){let t=e.getMediaContainer(),r=t.getAdId(),i=t.getCampaignId(),s=t.getAdSlotId(),o=this.getPlayer();this._needDebugAd(i)&&(e.once("insertedToDom",e=>{this._setAdDebugInfo(i,r,s,"VastInsertedToDom")}),e.getEl().parent().length&&this._setAdDebugInfo(i,r,s,"VastInsertedToDom"),e.once("providerSelected",e=>{this._setAdDebugInfo(i,r,s,"VastProvider",e.provider.getName())}),e.once("providerNotSelected",e=>{this._setAdDebugInfo(i,r,s,"VastProviderFail",JSON.stringify(e.baskets))}),e.once("start",e=>{this._setAdDebugInfo(i,r,s,"VastStart")}),e.once("tryPlaying",e=>{this._setAdDebugInfo(i,r,s,"VastTryPlaying",`${o.width}x${o.height}`)}),e.once("providerLoadingState",e=>{this._setAdDebugInfo(i,r,s,"VastProviderState",e.state)}),e.once("error",e=>{this._setAdDebugInfo(i,r,s,"VastError")}))}_onCreate(e){let t=e.item;t instanceof a.default&&setTimeout(()=>{this._onCreateVast(t)},0),t instanceof o.default&&setTimeout(()=>{this._onCreateVpaid(t)},0);let r=t instanceof s.default;if(!r&&t instanceof i.default){let e=t.getProvider();this._log("video",{action:"created",provider:e?e.getName():"",video:t.getOption("video")}),this.listenTo(t,{"wantplay start pause finish":e=>{this._log("video",{action:e.type}),this._kibana(e.type,t)},error:e=>{this._log("video",{action:"error",message:e.message,code:e.code});let r={Message:e.message,Code:e.code},i=()=>{this._kibana("error",t,r)};this._saveLog().then(e=>{r.log=e,i()}).catch(e=>i)}})}if(r&&t.getOption("advert")){let e=t.getAdId(),r=t.getCampaignId(),i=t.getAdSlotId();this.listenTo(t,{selectedForShow:()=>{this._setAdDebugInfo(r,e,i,"selectedForShow")},"wantplay start finish click customClick skip close":t=>{this._logAdvert(i,e,"log",t.type)},start:e=>{this._kibana(e.type,t,{SubtypeTime:e.target.currentTime,adLoadTime:t.adLoadStat})},error:r=>{let s=r.code||666,o=function(e){if("object"!=typeof e)return e;let t={};for(let r in e)e.hasOwnProperty(r)&&("object"!=typeof e[r]?t[r]=e[r]:t[r]="[object]");return JSON.stringify(t)}(r.message),a={ErrorCode:s,message:(r.error?r.error+" ":"")+o,adLoadTime:t.adLoadStat};403==s&&(a.media=JSON.stringify(r.media),a.logData=JSON.stringify(this._getLogForAd(e))),r.url&&(a.url=r.url),r.currentTime&&(a.currentTime=r.currentTime),void 0!==r.duration&&(a.duration=r.duration),r.depth&&(a.depth=r.depth),r.networkStatus&&(a.networkStatus=r.networkStatus),this._logAdvert(i,e,"log",{action:"error",error:a}),this._kibana("error",t,a),this.stopListening(t)}})}}_saveLog(){this.getPlayer().getPlugin("log");return Promise.reject()}_kibana(e,t,r={}){let i=this.getPlayer(),s=t.getOption("advert"),o=t.getProvider();if(s){r.Info=t.getOption("adId"),r.adSlotId=t.getOption("adSlotId"),r.adSlot=t.getOption("adSlot"),r.adSrcSlotId=t.getOption("adSrcSlotId")||0,r.adSrcSlot=t.getOption("adSrcSlot")||"",r.adCID=t.getCampaignId();let e=i.refInfo;e&&(r.refInfo_ref=e.ref,r.refInfo_referer=e.referer,r.refInfo_refN=e.refN,r.refInfo_count=e.count,r.refInfo_success=e.success,e.error&&(r.refInfo_error=e.error))}else{let e=t.getOption("video");if(o)if(o instanceof n.default){let e=o.getProvider();e&&(r.VideoMimeType=e.getOption("type"))}else r.VideoMimeType=o.getOption("type");e&&(r.VideoId=e.src)}if(o&&(r.VideoDuration=o.duration,r.VideoType=o.getName(),o instanceof n.default)){let e=o.getProvider();e&&(r.VideoType+=` (${e.getName()})`)}let a=i.getPlugin("backend");r.test=i.testMode,this._sendLog(h({Type:s?"AD":"Video",Subtype:e,isNewUser:a.isNewUser},r))}_addLogDataToOptions(e){e.log=JSON.stringify(this._logArr)}_sendLog(e,t=!1){let r=this.getPlayer().getPlugin("backend");h(e,{PlayerVisible:+this.getPlayer().visible,flash:+d.default.hasFlash,hasWebSocked:"WebSocket"in window?"true":"false",platform:this.getOption("platform","unknown"),adBlock:this.adBlockDetected,browserName:d.default.browser.fullName,browser:d.default.browser.name,browserVersion:d.default.browser.version,ref:r.getOption("ref"),referer:r.getOption("referer"),domainType:r.getOption("domainType")},e),this._send(e,t)}get adBlockDetected(){return d.default.adBlock?"true":this._adBlockDetected?"maybe":void 0===d.default.adBlock?"loading":"false"}_send(e,t=!1){(t||this.getOption("enabled",!0))&&(e.PlayerVersion=this.getPlayer().version,e.srvTest=this.getPlayer().srvTestMode)}}r.MoevideoKibanaPlugin=g,l.default.register("mvk",g)},{"../../../ad/js/plugins/advert/media-container":173,"../../../ad/js/plugins/vast/providers/vast":223,"../../../ad/js/plugins/vast/providers/vpaid-base":224,"../../../player/core/media-container":287,"../../../player/core/plugin":289,"../../../player/env/index":306,"../../../player/providers/metaprovider":321,"../../../player/utils/ajax":325,"../../../player/utils/catchHandler":327,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104}],246:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MvPlayListPlugin=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.array.find"),e("core-js/modules/es6.promise");var i=l(e("../../../player/core/component")),s=l(e("./../../../player/core/plugin")),o=l(e("./../../../player/controls/draggable")),a=l(e("./../../../player/utils/dom")),n=l(e("../../../player/utils/catchHandler"));function l(e){return e&&e.__esModule?e:{default:e}}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class u extends i.default{constructor(e,t){super(e,t),this._items=!1,this._playListHidden=!0;let r=this.getNs();this.CLASS_PLAYLIST_HIDDEN=`${r}-playlist__hidden`,this.listenTo(e,{state:e=>{"play"===e.state&&this.getEl().nsRemoveClass("hidden")},"playlist-ready":this._onPlaylistReady,fullscreenchange:()=>{this._updateScroll()}}),this.listenTo(this._$playlistInner[0],"scroll",()=>{this._updateScroll()}),this.getPlayer().addChild(this),this.initDrag(this._bar),this._hidePlaylist()}_hidePlaylist(){this.getEl().addClass(this.CLASS_PLAYLIST_HIDDEN)}_showPlaylist(){this.getEl().removeClass(this.CLASS_PLAYLIST_HIDDEN)}downHandler(e,t){}upHandler(e,t){}moveHandler(e,t){let r=this._bar,i=this._drag,s=i.height(),o=r.height(),a=r[0].getBoundingClientRect().top,n=Math.max(0,Math.min(t-a-s/2,o-s));i.css("top",n+"px");let l=this._$videos[0].getBoundingClientRect();this._$playlistInner[0].scrollTop=n*(l.bottom-(l.top-22)-o)/(o-s)}load(){return Promise.resolve()}buildCSSClass(){return`${this.getNs()}-playlist-widget ${super.buildCSSClass()}`}createEl(e="div"){super.createEl(e,{},{});let t=this.getEl();t.html(this._createPlaylistSkeletonHtml()),this._hidePlaylist(),this._$videos=t.nsFind("playlist-videos"),this._$playlistInner=t.nsFind("playlist-inner"),this._listWrapper=t.find("ul"),this.listenTo(t.nsFind("playlist-btn"),"click",()=>{this._onPlaylistToggle()}),this._createScroll()}_open(){!1===this._items&&Promise.all([this._loading()]).then(e=>{e[0]?this._onPlaylistReady(e[0]):this._items=[]}).catch(e=>(0,n.default)(e)),this._playListHidden=!1,this._showPlaylist()}_loading(){let e=this.getOption("loader");return"function"==typeof e?e(this):e}_close(){this._playListHidden=!0,this._hidePlaylist()}_createScroll(){let e=this.getEl();this._bar=e.nsFind("playlist-bar"),this._drag=e.nsFind("playlist-bar-drag"),e.nsAddClass("hidden")}_updateScroll(){let e=this.getEl(),t=this._drag,r=e.height(),i=t.height(),s=this._$videos[0].getBoundingClientRect();this._bar.css("height",r-6+"px"),t.css("top",-(s.top-22)*(r-6-i)/(s.bottom-s.top+22-(r-6))+"px")}_onIdle(e){e?this.hide():this.show()}_onPlaylistToggle(){this._updateScroll(),this._playListHidden?this._open():this._close()}_onPlaylistReady(e){this._items=e,this._listWrapper.html(this._createPlaylistItemsHtml(e)),this._findAndAdjustLinks(),this.show(),this._updateScroll()}_findAndAdjustLinks(){let e=this._listWrapper.find("a");this.listenTo(e,"click",t=>{t=t.originalEvent,e.removeClass("active"),(0,a.default)(t.currentTarget).addClass("active");let r=t.currentTarget.getAttribute("data-uid");if(r)return this._processItemClick(r),history.pushState({},"",window.location.href.replace(/(.*\/(framevideo\/)?)(.*)/i,"$1"+r)),this._close(),t.preventDefault(),!1})}_processItemClick(e){this.getPlayer().load(e,!1,"our").then(()=>{this.getPlayer().play()}).catch(e=>(0,n.default)(e))}_createPlaylistSkeletonHtml(){let e=this.getNs();return`<div class="${e}-playlist">\n        <div class="${e}-playlist-inner">\n            <div class="${e}-playlist-videos"><ul></ul></div>\n        </div>\n        <div class="${e}-playlist-btn"></div>\n        <div class="${e}-playlist-bar">\n            <div class="${e}-playlist-bar-drag"></div>\n        </div>\n        </div>`}_createPlaylistItemsHtml(e){return e.reduce((e,t)=>e+this._createPlaylistItemHtml(t),"")}_createPlaylistItemHtml(e){let t="<li>",r=this.getNs();return e.uid?t+=`<a class="${r}-text ${r}-playlist-video" href="#" data-sampleType="video" data-uid="${e.uid}">`:t+=`<a class="${r}-text ${r}-playlist-video" target="_blank" data-sampleType="banner" href="${e.link}">`,t+=`<div class="${r}-playlist-video-image">`,t+='<img src="'+e.image+'">',e.len&&(t+=`<div class="${r}-playlist-video-time">${e.len}</div>`),t+=`<div class="${r}-playlist-video-hover"></div>`,t+="</div>",t+=`<div class="${r}-text">`+e.name+"</div>",t+="</a>",t+="</li>"}}r.MvPlayListPlugin=u,d(u.prototype,o.default.prototype),s.default.register("playlist",u)},{"../../../player/core/component":279,"../../../player/utils/catchHandler":327,"./../../../player/controls/draggable":258,"./../../../player/core/plugin":289,"./../../../player/utils/dom":328,"core-js/modules/es6.array.find":91,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/web.dom.iterable":115}],247:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PostMessagePlugin=void 0,e("core-js/modules/es6.object.assign");var i=a(e("../../../player/core/plugin")),s=a(e("../../../player/utils/dom")),o=a(e("../../../player/core/console"));function a(e){return e&&e.__esModule?e:{default:e}}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=["error","start","state","adLoaded","adContentRollManagerInit","adContentRollManagerState","adContentRollManagerDestroy","adManagerState","adContentRollAudioManagerState","adAutorollManagerState","adAutorollSimpleManagerState","adPrerollManagerState","adPauserollManagerState","adPostrollManagerState","adVastManagerState","adPreloadStart","adPreloadSuccess","adClose","adClosed","adEmpty","adError","adPreloadFail","adShown","ready","playerOptions","visibilityChange","adPayed"];class d extends i.default{constructor(e,t){super(e,t),window.parent!==window&&(o.default.log("Post message inited"),this.listenTo(e,l.join(" "),this._onPlayerEvents),(0,s.default)(window).on("message",this._onMessage,this))}_onPlayerEvents(e){let t=this.getPlayer().debug,r=this._postMessage.bind(this),i=e.type,s=()=>{t?(r("adLoaded"),r("adPreloadSuccess"),s=function(){}):r(i)};switch(i){case"ready":case"adShown":case"adLoaded":case"adPreloadSuccess":case"adPreloadStart":case"adContentRollManagerInit":case"adContentRollManagerDestroy":case"adPayed":r(i);break;case"adContentRollManagerState":case"adContentRollAudioManagerState":case"adAutorollManagerState":case"adAutorollSimpleManagerState":case"adPrerollManagerState":case"adPauserollManagerState":case"adPostrollManagerState":case"adVastManagerState":case"adManagerState":r(i,{state:e.state,slot:e.slot});break;case"adClosed":case"adClose":case"adError":t||r(i);break;case"adEmpty":case"adPreloadFail":case"error":s();break;case"start":r("started");break;case"state":switch(e.state){case"pause":r("paused");break;case"play":r("play");break;case"end":r("ended")}break;case"playerOptions":r(i,{options:this.getPlayer().getOptions()});break;case"visibilityChange":r(i,e.visible)}}_postMessage(e,t={}){if(window.parent!==window){let r={};this.getOption("playerId")&&(r={playerId:this.getOption("playerId")}),window.parent.postMessage(n({MoeVideo:!0,event:e,eventData:t},r),"*")}}_onMessage(e){let t=(e=e.originalEvent).data;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}if(!t)return;let r=t,i=r.type,s=r.name,o=r.params;if(!t.MoeVideo)return;let a=this.getPlayer();switch(i){case"event":switch(s){case"inventory":a.trigger("inventory",{slot:o.slot}),a.visible=!0;break;case"playAd":a.trigger("playAd",{slot:o.slot});break;case"visible":case"invisible":break;case"visibleRateChange":a.trigger("visibleRateChange",o)}}}}r.PostMessagePlugin=d,i.default.register("postmessage",d)},{"../../../player/core/console":280,"../../../player/core/plugin":289,"../../../player/utils/dom":328,"core-js/modules/es6.object.assign":95}],248:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BackendPlugin=void 0,e("core-js/modules/es6.promise"),e("./provider"),e("./secure-provider"),e("../../../../player/providers/providers");var i=n(e("../../../../player/core/plugin")),s=n(e("./stat/advert")),o=n(e("./api")),a=n(e("../../../../player/core/console"));function n(e){return e&&e.__esModule?e:{default:e}}class l extends i.default{constructor(e,t){super(e,t),this._advertStat=new s.default(this),this.listenTo(e,{start:this._onStart}),this._firstVisitTime=0,a.default.info("====================== UIDs ====================="),a.default.info(`viewer:  ${this.viewerUid}`),a.default.info(`session: ${this.sessionUid}`),a.default.info(`visit:   ${this.visitUid}`),a.default.info(`tool:    ${e.toolUid}`),a.default.info("================================================="),window.mvuid=this.viewerUid}load(){return this.getUserIdFromInfo(1)?this._saveFirstVisitTime():this._loadFirstVisitTime()}_saveFirstVisitTime(){let e=new Date-0;return this._firstVisitTime=e,this.getPlayer().getStorage().setItem("_mvFirstVisitTime",e),Promise.resolve()}_loadFirstVisitTime(){return this.getPlayer().getStorage().getItem("_mvFirstVisitTime").then(e=>e?(this._firstVisitTime=e,Promise.resolve()):this._saveFirstVisitTime()).catch(()=>Promise.resolve())}getUserIdFromInfo(e){let t=this.getOption("userUids");return t?t[e]:""}get viewerUid(){return this.getUserIdFromInfo(0)}get isNewUser(){return new Date-this._firstVisitTime<864e5}get sessionUid(){return this.getUserIdFromInfo(2)}get visitUid(){return this.getUserIdFromInfo(4)}_onStart(e){let t=e.target,r=t.constructor.getName(),i=this.getOption("pin"),s=this.getOption("ref");"youtube"!==r&&"vimeo"!==r||!i||(0,o.default)([["direct/start",{param:JSON.stringify({pin:i,link:encodeURIComponent(t.getOption("src")),token:this.getOption("id")})}]]),"our"!==r&&i&&setTimeout(()=>{(0,o.default)([["direct/view",{param:JSON.stringify({key:i,link:encodeURIComponent(t.getOption("src")),ref:s,type:2,token:this.getOption("id")})}]])},1e3*Math.round(.75*t.duration))}}r.BackendPlugin=l,i.default.register("backend",l)},{"../../../../player/core/console":280,"../../../../player/core/plugin":289,"../../../../player/providers/providers":322,"./api":249,"./provider":251,"./secure-provider":252,"./stat/advert":253,"core-js/modules/es6.promise":97}],249:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let t="";"moevideo.biz"==window.location.host&&(t="//videochart.net");return(0,s.default)({url:t+"/data",type:"post",data:"r="+JSON.stringify(e),dataType:"json"}).catch(e=>{let t=(i=3,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),s=t[0],o=t[1],a=t[2];throw new Error("API Error: "+s.status+" - "+o+" - "+a)});var r,i},e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable");var i,s=(i=e("../../../../player/utils/ajax"))&&i.__esModule?i:{default:i}},{"../../../../player/utils/ajax":325,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],250:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.get=n,r.post=function(e,t){return a(e,"post",t)},r.request=a,r.default=void 0,e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable");var i,s=(i=e("../../../../player/utils/ajax"))&&i.__esModule?i:{default:i};function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e,t,r){let i="/embed/api/"+e;return(0,s.default)({url:i,type:t,data:r}).catch(e=>{let t=o(e,3),r=t[0],i=t[1],s=t[2];throw new Error(`API Error: ${r.status} - ${i} - ${s}`)}).then(e=>null===e||void 0===e?void 0:e.data)}function n(e,t){return a(e,"get",t)}var l=n;r.default=l},{"../../../../player/utils/ajax":325,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],251:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.promise");var i=n(e("../../../../player/providers/metaprovider")),s=n(e("../../../../player/providers/providers")),o=n(e("./api")),a=n(e("./embed-api"));function n(e){return e&&e.__esModule?e:{default:e}}const l="https:"===window.location.protocol;class d extends i.default{static getName(){return"our"}_initPlaylist(){let e=this.getPlayer().getPlugin("playlist"),t=this.getOption("src");e&&e.setOption("loader",()=>(0,o.default)([["playlist/get_playlist",{uid:t}]]).then(e=>"ok"===e.status?Promise.resolve(e.data[0].videos):Promise.reject())),this._getBackend().getOption("mosaic",!0)&&this.setControls({mosaic:{loader:()=>(0,a.default)("mosaic",{uid:t})}})}_getBackend(){return this.getPlayer().getPlugin("backend")}_fixUrl(e){return l?e.replace(/^http:\/\//,"https://"):e}preLoad(){this._initPlaylist();let e,t=this._getBackend(),r=t.getOption("id"),i=t.getOption("ref");e={uid:this.getOption("src"),token:r},i&&(e.ref=i);let s=this.getOption("ourUrl");return s?this._postRequest({poster:this.getOption("poster"),video:s}):(0,a.default)("video",e).then(e=>this._postRequest(e))}_postRequest(e){return this.setControls({poster:{image:this._fixUrl(e.poster)}}),Promise.resolve({src:this._fixUrl(e.video)})}}s.default.register(d);var u=d;r.default=u},{"../../../../player/providers/metaprovider":321,"../../../../player/providers/providers":322,"./api":249,"./embed-api":250,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],252:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace");var i=a(e("../../../../player/providers/metaprovider")),s=a(e("../../../../player/providers/providers")),o=a(e("./embed-api"));function a(e){return e&&e.__esModule?e:{default:e}}class n extends i.default{static getName(){return"secure"}preLoad(){let e,t=this.getPlayer().getPlugin("backend"),r=t.getOption("ref");return e={src:this.getOption("src"),pin:t.getOption("pin")},r&&(e.ref=r),(0,o.default)("video/sign-url",e).then(e=>{return"https:"===window.location.protocol&&(e=e.replace(/^http:\/\//,"https://")),{src:e}})}}n.supports=i.default.supports,s.default.register(n);var l=n;r.default=l},{"../../../../player/providers/metaprovider":321,"../../../../player/providers/providers":322,"./embed-api":250,"core-js/modules/es6.regexp.replace":102}],253:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign");var i=l(e("../../../../../player/core/base-object")),s=l(e("../../../../../ad/js/plugins/advert/media-container")),o=l(e("../embed-api")),a=l(e("../../../../../player/utils/google")),n=l(e("../../../../../player/utils/pixels"));function l(e){return e&&e.__esModule?e:{default:e}}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}const u=100*Math.random()<=1,c=!1;var h=class extends i.default{constructor(e){let t=e.getPlayer();super(t),this._backend=e,this.listenTo(t,{create:this._onCreate}),e.getOption("inventoryDisable")||this.listenTo(t,"inventoryLog",this._onInventoryLog),t.once("userClick",this._onPlayerClick,this)}_onCreate(e){let t=e.item;if(t instanceof s.default&&t.getOption("advert")&&t.getOption("adId")){let e=t.getOption("externalEvents"),r=!1,i={adPayed:{event:"payed",external:"play3",sended:!1},adFirstQuartile:{event:"firstQuartile",external:"",sended:!1},adMidpoint:{event:"midpoint",external:"",sended:!1},adThirdQuartile:{event:"thirdQuartile",external:"",sended:!1}},s=r=>{let s=i[r];s.sended||(this._sendEvent(s.event,t),e&&e.hasOwnProperty(s.external)&&(0,n.default)(e[s.external]),s.sended=!0)};this.listenTo(t,{start:()=>{this._sendEvent("start",t),e&&e.start&&(0,n.default)(e.start),this.listenTo(t,{"adPayed adFirstQuartile adMidpoint adThirdQuartile":e=>{s(e.type)},"skip close":()=>{this._sendEvent("skip",t),e&&e.skip&&(0,n.default)(e.skip)},click:()=>{this._sendEvent("click",t),e&&e.click&&(0,n.default)(e.click)},customClick:()=>{this._sendEvent("customClick",t),e&&e.click&&(0,n.default)(e.click)},finish:()=>{this._sendEvent("end",t),e&&e.ended&&(0,n.default)(e.ended),setTimeout(()=>{this.stopListening(t)},0)},"empty close timeout error":()=>{this.stopListening(t)}})},error:e=>{r||(this._sendError(e,t),r=!0)}})}}_getToken(){return this._backend.getOption("id")}_getRef(){return this._backend.getOption("ref")}_onInventoryLog(e){let t=this._backend;if(t.statDisabled)return;if("player"===e.slot&&t.getOption("inventoryDisablePlayerSlot"))return;let r=this._getRef(),i=this.getPlayer(),s={token:this._getToken(),slotId:e.slotId,mvViewerUid:t.viewerUid,mvSessionUid:t.sessionUid,mvVisitUid:t.visitUid,mvToolUid:i.toolUid};r&&(s.ref=r),(0,o.default)("stat/inventory",s)}_onPlayerClick(){this.getPlayer().trigger("inventory",{slot:"player"})}_sendEvent(e,t,r){let i=t.getAdId(),s=t.getAdUuid(),a=t.getAdSlotId(),n=t.blockIndex,l=t.getIsRtb(),u=t.getAdSlot(),c=t.adFullTimingStat,h=this.getPlayer(),p=this._backend,_=this._getRef(),g=t.getRedServizeRtbData();p.statDisabled||(r=d({adId:i,adSlotId:a,adUuid:s,adBlockIndex:n,adIsRtb:l,adTimeout:Math.max(0,c.preload+c.load+c.play),adTimeoutPreload:Math.max(0,c.preload),adTimeoutLoad:Math.max(0,c.load),adTimeoutPlay:Math.max(0,c.play),token:this._getToken(),event:e,mvViewerUid:p.viewerUid,mvSessionUid:p.sessionUid,mvVisitUid:p.visitUid,mvToolUid:h.toolUid},r),_&&(r.ref=_,r.referer=p.getOption("referer")),g&&(r.redServizeRtbData=g),(0,o.default)("stat/ad",r),this._googleEvents(e,t),this.getPlayer().trigger("adStatSend",{event:e,adId:i,slotId:a,slot:u,adBlockIndex:n,adIsRtb:l,timeout:r.adTimeout,timeoutPreload:r.adTimeoutPreload,timeoutLoad:r.adTimeoutLoad,timeoutPlay:r.adTimeoutPlay,data:{event:e,adId:i,slotId:a,slot:u,adBlockIndex:n,adIsRtb:l,timeout:r.adTimeout,timeoutPreload:r.adTimeoutPreload,timeoutLoad:r.adTimeoutLoad,timeoutPlay:r.adTimeoutPlay}}))}_sendError(e,t){let r=e.code||300,i=t.getAdId(),s=t.getAdUuid(),a=t.getAdSlotId(),n=t.getAdSlot(),l=t.blockIndex,d=t.getIsRtb(),h=t.adFullTimingStat,p=this.getPlayer(),_=this._backend;if(_.statDisabled)return;let g={adId:i,adSlotId:a,adUuid:s,adBlockIndex:l,adIsRtb:d,adTimeout:Math.max(0,h.preload+h.load+h.play),adTimeoutPreload:Math.max(0,h.preload),adTimeoutLoad:Math.max(0,h.load),adTimeoutPlay:Math.max(0,h.play),token:this._getToken(),event:"error",code:r,mvViewerUid:_.viewerUid,mvSessionUid:_.sessionUid,mvVisitUid:_.visitUid,mvToolUid:p.toolUid},f=this._getRef();f&&(g.ref=f),u&&(0,o.default)("stat/ad",g),c&&this._googleEvents("error",t,r),this.getPlayer().trigger("adStatSend",{event:"error",code:r,adId:i,slotId:a,slot:n,adBlockIndex:l,adIsRtb:d,timeout:g.adTimeout,timeoutPreload:g.adTimeoutPreload,timeoutLoad:g.adTimeoutLoad,timeoutPlay:g.adTimeoutPlay,data:{event:"error",code:r,adId:i,slotId:a,slot:n,adBlockIndex:l,adIsRtb:d,timeout:g.adTimeout,timeoutPreload:g.adTimeoutPreload,timeoutLoad:g.adTimeoutLoad,timeoutPlay:g.adTimeoutPlay}})}_googleEvents(e,t,r){"payed"===e&&(e="play3");let i=t.getOption("gaEvents")||{},s=t.getOption("gaEvent");if(i.hasOwnProperty(e)&&s&&"no"!==s)for(let t=0;t<i[e].length;t++)(0,a.default)(i[e][t],"event",{category:s,action:e,label:r})}};r.default=h},{"../../../../../ad/js/plugins/advert/media-container":173,"../../../../../player/core/base-object":277,"../../../../../player/utils/google":331,"../../../../../player/utils/pixels":333,"../embed-api":250,"core-js/modules/es6.object.assign":95}],254:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractLayout=void 0;r.AbstractLayout=class{constructor(e){this._ns=e}_toString(e){return""}toString(){return this._toString(this._ns)}}},{}],255:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es6.array.find");var i=l(e("./../core/component")),s=l(e("./controls"));e("./items/play"),e("./items/progress"),e("./items/logo"),e("./items/volume"),e("./items/mute"),e("./items/time"),e("./items/screenplay"),e("./items/poster"),e("./items/mosaic"),e("./items/title"),e("./items/menu"),e("./items/share"),e("./items/wantplay"),e("./items/wantunmute"),e("./items/fullscreen"),e("./items/quality");var o=l(e("./layout")),a=l(e("./../utils/dom")),n=l(e("../core/console"));function l(e){return e&&e.__esModule?e:{default:e}}class d extends i.default{constructor(e,t){super(e.getPlayer(),t);let r=this.getOption("items");t.rewrite&&t.items&&(r=t.items),this._controls={},this._mediaContainer=e;const i=void 0!==r.hideToolBar&&r.hideToolBar;if(delete r.hideToolBar,r){for(let t in r){if(!r.hasOwnProperty(t))continue;const i=s.default.find(t);i&&(this._controls[t]=new i(e.getProvider(),r[t],this.getEl()))}const t=this.getEl(),o=this.getNs();let l=t.find(`.${o}-control:not(.${o}-attached)`);if(l&&l.length>0){for(let e=0;e<l.length;e++){let t=l[e];n.default.log("$$control-layer remove not attached control with css class: ",t.className)}l.remove()}let d=t.find(`.${o}-remove-when-empty`);for(let e=0;e<d.length;e++){let t=(0,a.default)(d[e]);t[0].querySelectorAll(".mv-control").length||t.hide()}for(let e=t.length-1;e>=0;e--){let r=(0,a.default)(t[e]);r.nsHasClass("control")&&!r.nsHasClass("attached")&&t.splice(e,1)}i&&this.hideToolBar()}}getControl(e){return this._controls[e]}destroy(){for(let e in this._controls)this._controls.hasOwnProperty(e)&&this._controls[e].destroy()}getNs(){return this.getPlayer().ns}createEl(e,t,r){const i=this.getOption("layout"),s=new i(this.getNs()).toString();n.default.info("$$control-layer | LayoutCls = ",i._class_name),super.createEl(s,{},{})}hideToolBar(){const e=this.getEl(),t=this.getNs();e.find(`.${t}-toolbar`).hide()}showToolBar(){const e=this.getEl(),t=this.getNs();e.find(`.${t}-toolbar`).show()}}d.prototype._options={layout:o.default,items:{play:{},volume:{},mute:{},time:{},screenplay:{},fullscreen:{},logo:{},title:{},progress:{},poster:{},mosaic:{},menu:{},share:{},wantplay:{text:"Для начала воспроизведения нажмите"}}};var u=d;r.default=u},{"../core/console":280,"./../core/component":279,"./../utils/dom":328,"./controls":256,"./items/fullscreen":260,"./items/logo":261,"./items/menu":262,"./items/mosaic":263,"./items/mute":264,"./items/play":265,"./items/poster":266,"./items/progress":267,"./items/quality":268,"./items/screenplay":269,"./items/share":270,"./items/time":271,"./items/title":272,"./items/volume":273,"./items/wantplay":274,"./items/wantunmute":275,"./layout":276,"core-js/modules/es6.array.find":91,"core-js/modules/es6.regexp.to-string":105}],256:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../core/console"))&&i.__esModule?i:{default:i};var o=new class{constructor(){this._controls=[]}register(e){let t=e.getName();if(t){if(!this._controls.hasOwnProperty(t))return this._controls[t]=e,!0;s.default.error("Control with name "+t+" already registered")}else s.default.error("Can't get controls name");return!1}find(e){return this._controls[e]}};r.default=o},{"../core/console":280}],257:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.find"),e("core-js/modules/es6.regexp.replace");var i=a(e("./../core/component")),s=a(e("./../utils/dom")),o=a(e("../core/console"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{static getName(){return!1}constructor(e,t,r){!0!==t&&!1!==t||(t={enabled:t}),t.createEl=!1,super(e.getPlayer(),t),this._hidden=!1,this.createEl(r),this._provider=e,this._mediaContainer=e.getMediaContainer()}getProvider(){return this._provider}getMediaContainer(){return this._mediaContainer}get disabled(){return!1===this.getOption("enabled")}createEl(e){let t=this.getNs(),r="."+this.buildCSSClass(t).replace(/\s+/g," ").replace(/(^ | $)/g,"").replace(/\s/g,".");this._el=(0,s.default)(e).find(r),this.disabled&&this.hide(),0===this._el.length?o.default.info("Can't attach control \""+this.constructor.getName()+'" to DOM!'):this._el.nsAddClass("attached")}show(){if(!1===this.disabled&&this._hidden)return this._hidden=!1,super.show()}hide(){if(!1===this._hidden)return this._hidden=!0,super.hide()}};r.default=n},{"../core/console":280,"./../core/component":279,"./../utils/dom":328,"core-js/modules/es6.array.find":91,"core-js/modules/es6.regexp.replace":102}],258:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./../env/index"))&&i.__esModule?i:{default:i};let o={};o.prototype={initDrag(e){this.listenTo(e,"mousedown touchstart",e=>{(1===(e=e.originalEvent).which||s.default.hasTouch)&&(this.downHandler(),this._seeking=!0,this.listenTo(document,"mouseup touchend mouseleave",()=>{this.upHandler(this._lastX,this._lastY),this.stopListening(document),this._seeking=!1}),this.listenTo(document,"mousemove touchmove",e=>{let t=void 0!==(e=e.originalEvent).pageX?e.pageX:e.touches[0].pageX,r=void 0!==e.pageY?e.pageY:e.touches[0].pageY;this._lastX=t,this._lastY=r,this.moveHandler(t,r)}),this._lastX=void 0!==e.pageX?e.pageX:e.touches[0].pageX,this._lastY=void 0!==e.pageY?e.pageY:e.touches[0].pageY,this.moveHandler(this._lastX,this._lastY),e.preventDefault())})}};var a=o;r.default=a},{"./../env/index":306}],259:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../utils/dom")),s=o(e("./../core/translate"));function o(e){return e&&e.__esModule?e:{default:e}}let a={};a.prototype={initHint(){this._locked=!1,this._attached=void 0,this._me=this.getEl()[0],this._hint=(0,i.default)("<div/>").nsAddClass("hint").nsAddClass("hidden"),this.getEl().append(this._hint);let e=(0,i.default)("[data-hint]",this.getEl());for(let t=0;t<e.length;t++)this.listenTo(e[t],{mouseenter:e=>{this.attachHint(e.originalEvent.target)},mouseleave:e=>{this.detachHint(e.originalEvent.target)}});e.length>0&&this.listenTo(document,"mousemove touchmove",e=>{if(e=e.originalEvent,this._attached&&this._attached.hasAttribute("data-hint-move")){let t=void 0!==e.pageX?e.pageX:e.touches[0].pageX;this.setHintPos(t,0)}})},lockHint(){this._locked=!0},unlockHint(){this._locked=!1,this._detachAfterUnlock&&(this.detachHint(this._attached),this._detachAfterUnlock=!1)},refreshHint(){this._attached&&this.setHintText(this._attached.getAttribute("data-hint"))},attachHint(e){if(this._attached!==e&&!this._locked){this._attached=e,this._hint.nsRemoveClass("hidden");let t=this._attached.getBoundingClientRect();this.setHintPos(t.left+t.width/2,0),this.setHintText(e.getAttribute("data-hint"))}this._locked&&this._attached===e&&(this._detachAfterUnlock=!1)},detachHint(e){this._attached===e&&(this._locked?this._detachAfterUnlock=!0:(this._attached=void 0,this._hint.nsAddClass("hidden")))},setHintPos(e,t){if(this._attached){let t=this._me.getBoundingClientRect(),r=this._attached.getBoundingClientRect();e=Math.max(r.left,Math.min(e,r.right)),this._hint.css({left:e-t.left+"px",right:"auto",top:r.top-t.top+"px"});let i=this._hint[0].getBoundingClientRect();i.right>t.right&&(e=t.right-r.left-i.width/2,this._hint.css({left:"auto",right:e+"px",top:r.top-t.top+"px"}))}},setHintText(e){e=(0,s.default)(e,this.getPlayer().getOption("lang")),this._hint.html(e)}};var n=a;r.default=n},{"./../core/translate":297,"./../utils/dom":328}],260:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"fullscreen"}constructor(e,t,r){super(e,t,r),this.listenTo(this.getEl(),"click",()=>{this._handleClick()}),this.listenTo(this.getPlayer(),"fullscreenchange",()=>{this.getPlayer().fullScreen?this.getEl().nsAddClass("fullscreen-control","active"):this.getEl().nsRemoveClass("fullscreen-control","active")})}buildCSSClass(){return`${this.getNs()}-fullscreen-control`}_handleClick(){this.getPlayer().fullScreen=!this.getPlayer().fullScreen}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],261:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"logo"}constructor(e,t,r){super(e,t,r),this.getOption("href")&&this.listenTo(this.getEl(),"click",()=>{window.open(this.getOption("href"))})}buildCSSClass(){return`${this.getNs()}-logo-control`}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],262:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.find");var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"menu"}createEl(e="div",t={},r={}){super.createEl(e,t,r),this.setMenu(this.getOption("urls"))}setMenu(e){if(!e)return void this.getEl().nsAddClass("hidden");this.getEl().nsRemoveClass("hidden");let t,r="";for(t=0;t<e.length;t++){let i=e[t];r+='<li><a target="_blank" href="'+i.url+'">'+i.title+"</a></li>"}this.getEl().find("ul").html(r)}buildCSSClass(e){return`${e}-menu-control`}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257,"core-js/modules/es6.array.find":91}],263:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator");var i=n(e("./../default")),s=n(e("./../controls")),o=n(e("./../../utils/dom")),a=n(e("../../utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}class l extends i.default{static getName(){return"mosaic"}constructor(e,t,r){super(e,t,r),this.listenTo(window,"resize",this.resize),this.listenTo(e,"state",this._onShowMosaic),this._news=!1}buildCSSClass(){return`${this.getNs()}-mosaic-control`}createEl(e,t,r){super.createEl(e,t,r);let i=this.getNs();this.getEl().append((0,o.default)(`<div class="mosaics-inner ${i}-clearfix"></div>`))}_createMosaicItem(e){let t=this.getNs();return(0,o.default)('<a class="mos-video mvp_video" target="_blank" href="'+e.url+'"><div class=video-image><img src="'+e.preview+`"><div class=video-hover></div></div><div class=${t}-text>`+e.title+"</div></a>")[0]}_createEmpty(){return(0,o.default)('<div class="mos-video video free"></div>')[0]}_onShowMosaic(e){"end"===e.state?!1===this._news?Promise.all([this._loading()]).then(e=>{e[0]?(this._prepareResult(e[0]),this.getEl().nsRemoveClass("hidden"),this.redraw()):this._news=[]}).catch(e=>(0,a.default)(e)):0!==this._news.length?(this.getEl().nsRemoveClass("hidden"),this.redraw()):this.getEl().nsAddClass("hidden"):this.getEl().nsAddClass("hidden")}redraw(){let e=this.getEl(),t=Math.floor(e.width()/170),r=Math.floor(e.height()/170),i=t*r,s=(e.height()-170*r)/2,a=(e.width()-170*t)/2,n=(0,o.default)(".mosaics-inner",e),l=0,d=i-this._news.length,u=[];if(d>0)for(u=this._news,l=0;l<d;l++)u.push(this._createEmpty());else for(l=0;l<i;l++)u.push(this._news[l]);for(l=0;l<u.length;l++)0===l&&(u[l].className+=" left"),l<t?u[l].className+=" top":l>=i-t&&(u[l].className+=" bottom"),(l+1)%t==0&&(u[l].className+=" right",u[l+1]&&(u[l+1].className+=" left"));n.append(u),n[0].style.margin=s+"px "+a+"px"}_loading(){let e=this.getOption("loader");return"function"==typeof e?e(this):e}_prepareResult(e){let t=e||[];return this._news=t.map(e=>this._createMosaicItem({title:e.name,url:e.link,preview:e.image})),this}}s.default.register(l);var d=l;r.default=d},{"../../utils/catchHandler":327,"./../../utils/dom":328,"./../controls":256,"./../default":257,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],264:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("./../default")),s=n(e("./../controls")),o=n(e("./../../env/index")),a=e("../../utils/math");function n(e){return e&&e.__esModule?e:{default:e}}class l extends i.default{static getName(){return"mute"}constructor(e,t,r){super(e,t,r),this.listenTo(this.getEl(),"click",this._handleClick),this.volumeControl=e.getPlayer().volumeControl,this.listenTo(this.volumeControl,{volumeChange:this._stateHandler}),this.getEl().on("wheel",e=>{let t=e.originalEvent;if(!1===this.getPlayer().isUserAction())return;t.preventDefault();let r=.05*(t.deltaY>0?-1:1),i=this.volumeControl.getMuted(null,this);if(!1===i||r>0){let e=i?.1:this.volumeControl.getVolume(null,this);e+=r,e=(0,a.betweenZeroAndOne)(e),this.volumeControl.setVolume(e,null,!0,this),this.volumeControl.setMuted(e<=0,null,!0,this),this._stateHandler()}return!1}),this._stateHandler()}buildCSSClass(){return`${this.getNs()}-mute-control`}_handleClick(){let e=this.volumeControl.getMuted(null,this),t=this.volumeControl.getVolume(null,this),r=!e;!0===e&&!1===r&&t<=0&&this.volumeControl.setVolume(.8,null,!0,this),this.volumeControl.setMuted(r,null,!0,this)}_stateHandler(e=null){let t=this.getEl(),r=e?e.volume:this.volumeControl.getVolume(null,this),i=e?e.muted:this.volumeControl.getMuted(null,this);t.nsRemoveClass("volume-0").nsRemoveClass("volume-33"),r<.33?t.nsAddClass("volume-0"):r<.66&&t.nsAddClass("volume-33"),i?t.nsAddClass("state-muted"):t.nsRemoveClass("state-muted")}}o.default.isVolumeControl&&s.default.register(l);var d=l;r.default=d},{"../../utils/math":332,"./../../env/index":306,"./../controls":256,"./../default":257}],265:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"play"}constructor(e,t,r){super(e,t,r),this.listenTo(this.getEl(),"click",this._handleClick),this.listenTo(e,"state",this._stateHandler)}buildCSSClass(){return`${this.getNs()}-play-control`}_handleClick(){let e=this.getProvider(),t=e.state;"pause"===t||"end"===t||"idle"===t||"loading"===t?e.play():e.pause()}_stateHandler(e){let t=e.state;"pause"!==t&&"end"!==t&&"play"!==t||this.getEl().nsRemoveClass("state-play").nsRemoveClass("state-end").nsRemoveClass("state-pause").nsAddClass("state-"+t)}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],266:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"poster"}constructor(e,t,r){super(e,t,r);let i=this.getEl();this.getOption("image")?i.css("backgroundImage","url('"+this.getOption("image")+"')"):this.hide(),this.listenTo(i,"click",()=>{this.getProvider().play()}),this.listenTo(e,"state",()=>{this.destroy()})}buildCSSClass(){return`${this.getNs()}-poster-control ${super.buildCSSClass()}`}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],267:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.regexp.to-string");var i=n(e("./../default")),s=n(e("./../controls")),o=n(e("./../../utils/time")),a=n(e("./../draggable"));function n(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class d extends i.default{static getName(){return"progress"}constructor(e,t,r){super(e,t,r);let i=0;this._seeking=!1,this._wrapper=this.getEl().nsFind("progress-wrapper"),this.listenTo(e,{progress:e=>{this.getEl().nsFind("progress-loaded").css("width",100*e.target.buffered+"%")},timeupdate:e=>{if(!this._seeking){let t=this.getEl();e.target.duration&&i+e.target.currentTime!==0?(this.show(),t.nsFind("progress").css("width",e.target.currentTime/e.target.duration*100+"%")):this.hide(),i=e.target.currentTime}}}),this.getEl().on("mousemove",e=>{this._refreshHint(this._calcTime(e.originalEvent.pageX))}),this.getOption("drag")?this.initDrag(this.getEl()):this.getEl().nsFind("progress-drag").nsAddClass("hidden")}_calcTime(e){let t=this._wrapper[0].getBoundingClientRect(),r=e-t.left;return Math.min(1,Math.max(0,r/t.width))}downHandler(){this.getMediaContainer().lockHint()}upHandler(e){this.getProvider().currentTime=this._calcTime(e)*this.getProvider().duration,this.getMediaContainer().unlockHint()}_refreshHint(e){this.getEl().attr("data-hint",o.default.toString(parseInt(e*this.getProvider().duration))),this.getMediaContainer().refreshHint()}moveHandler(e){let t=this._calcTime(e);this.getEl().nsFind("progress").css("width",100*t+"%"),this._refreshHint(t)}buildCSSClass(){return`${this.getNs()}-progress-control`}}d.prototype._options={drag:!0},l(d.prototype,a.default.prototype),s.default.register(d);var u=d;r.default=u},{"./../../utils/time":335,"./../controls":256,"./../default":257,"./../draggable":258,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.regexp.to-string":105}],268:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("./../default")),s=a(e("./../controls")),o=a(e("./../../utils/dom"));function a(e){return e&&e.__esModule?e:{default:e}}class n extends i.default{static getName(){return"quality"}constructor(e,t,r){super(e,t,r),e.qualityChangeSupported||this.destroy();let i=this.getPlayer(),s=this.getEl(),o=this.getNs();this.CLASS_MENU_VISIBLE=`${o}-quality-control__menuVisible`,this.CLASS_EMPTY=`${o}-quality-control__empty`,s.attr("tabindex",1e3),this._$switcher=s.nsFind("quality-control-switcher"),this._$menu=s.nsFind("quality-control-menu"),this._menuVisible=!0,this._itemsCount=0,this._items={},this._updateMenu(e.qualityList),this.listenTo(e,"qualityListChange",this._onQualityListChanged),this.listenTo(e,"qualityChange",this._onQualityChanged),this.listenTo(this._$switcher,"click",this._onClick),this.listenTo(i,{idle:()=>{this._hideMenu()}}),this.listenTo(s,{blur:()=>{this._hideMenu()}}),this._hideMenu(),this._onQualityChanged()}_updateMenu(e){let t=this._$menu,r=this._provider,i={},s=this.getNs(),a=0,n=0,l=!1;t.empty();for(let n=0;n<e.length;n++)(e=>{let n=(0,o.default)(`<div class="${s}-quality-control-menu-item"></div>`);n.text(e.title),n.on("click",()=>{r.quality=e.value,this._onClick()}),t.append(n),i[e.value]=n,a++,e.isAuto&&(l=!0)})(e[n]);this._itemsCount=a,this._items=i,(n=l?a-1:a)>1?this.getEl().removeClass(this.CLASS_EMPTY):this.getEl().addClass(this.CLASS_EMPTY)}_onClick(e){this._menuVisible?this._hideMenu():this._showMenu()}_hideMenu(){this._menuVisible&&(this._menuVisible=!1,this.getEl().removeClass(this.CLASS_MENU_VISIBLE),this._$menu.hide(),this.getEl().blur())}_showMenu(){this._menuVisible||(this._menuVisible=!0,this.getEl().addClass(this.CLASS_MENU_VISIBLE),this._$menu.show(),this.getEl().focus())}_onQualityChanged(){0!==this._itemsCount?(this.getEl().show(),this._$menu.nsFind("quality-control-menu-item").nsRemoveClass("quality-control-menu-item","selected"),this._items[this._provider.quality].nsAddClass("quality-control-menu-item","selected"),this._$switcher.text(this._items[this._provider.quality].text())):this.getEl().hide()}_onQualityListChanged(e){this._updateMenu(this._provider.qualityList)}buildCSSClass(){return`${this.getNs()}-quality-control`}}s.default.register(n);var l=n;r.default=l},{"./../../utils/dom":328,"./../controls":256,"./../default":257}],269:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("./../default")),s=a(e("./../controls")),o=e("../../providers/default");function a(e){return e&&e.__esModule?e:{default:e}}const n="state-pause",l="hidden";class d extends i.default{static getName(){return"screenplay"}constructor(e,t,r){super(e,t,r);const i=this.getEl();this.listenTo(i,"click",()=>{this.getProvider().play()}),this.listenTo(e,"state",this._stateHandler),i.nsAddClass(n),(this.getOption("hideOnCreate",!1)||e.state===o.PROVIDER_STATE.PLAY)&&this._hide()}buildCSSClass(){return`${this.getNs()}-screenplay-control`}_stateHandler(e){const t=e.state;"pause"===t||"idle"===t?(this._show(),this.getEl().nsRemoveClass("state-end").nsRemoveClass(n).nsAddClass("state-"+t)):this._hide()}_show(){return this.getEl().nsRemoveClass(l),this}_hide(){return this.getEl().nsAddClass(l),this}}s.default.register(d);var u=d;r.default=u},{"../../providers/default":317,"./../controls":256,"./../default":257}],270:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("./../default")),s=a(e("./../controls")),o=a(e("./../../utils/dom"));function a(e){return e&&e.__esModule?e:{default:e}}let n={vk:{name:"vkontakte",url:"https://vk.com/share.php?url="},ok:{name:"odnoklassniki",url:"http://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st._surl="},fb:{name:"facebook",url:"https://www.facebook.com/sharer/sharer.php?u="},gp:{name:"googleplus",url:"https://plus.google.com/share?url="},tw:{name:"twitter",url:"https://twitter.com/intent/tweet?url="}};class l extends i.default{static getName(){return"share"}createEl(e){super.createEl(e),this.setSocials(this.getOption("items")||["vk","ok","tw","fb","gp"])}setSocials(e){let t;for(let r=0;r<e.length;r++){let i=(0,o.default)("<div/>").nsAddClass("share-items "+n[e[r]].name);i.append((0,o.default)('<a target="_blank" href="'+n[e[r]].url+window.location+'"></a>')),t&&i.append(t),t=i}this.getEl().append(t)}buildCSSClass(){return`${this.getNs()}-share-control`}}s.default.register(l);var d=l;r.default=d},{"./../../utils/dom":328,"./../controls":256,"./../default":257}],271:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.to-string");var i=a(e("./../default")),s=a(e("./../controls")),o=a(e("./../../utils/time"));function a(e){return e&&e.__esModule?e:{default:e}}class n extends i.default{static getName(){return"time"}constructor(e,t,r){super(e,t,r),this.listenTo(e,"timeupdate durationchange",this._timeUpdate)}buildCSSClass(){return`${this.getNs()}-time-control`}_timeUpdate(e){const t=o.default.toString(e.target.currentTime,e.target.duration>3600)+" / "+o.default.toString(e.target.duration);this.getEl().html(t)}}s.default.register(n);var l=n;r.default=l},{"./../../utils/time":335,"./../controls":256,"./../default":257,"core-js/modules/es6.regexp.to-string":105}],272:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"title"}constructor(e,t,r){super(e,t,r);let i=this.getOption("text");i?this.getEl().html(i):this.getEl().nsAddClass("hidden")}buildCSSClass(){return`${this.getNs()}-title-control`}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],273:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign");var i=l(e("./../default")),s=l(e("./../controls")),o=l(e("./../../env/index")),a=l(e("./../draggable")),n=e("../../utils/math");function l(e){return e&&e.__esModule?e:{default:e}}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class u extends i.default{static getName(){return"volume"}constructor(e,t,r){super(e,t,r),this.volumeControl=e.getPlayer().volumeControl,this.listenTo(this.volumeControl,{volumeChange:e=>{this._moveDrag(e.muted?0:e.volume)}}),this._wrapper=this.getEl().nsFind("volume-wrapper"),this.getEl().on("mousemove",e=>{this._refreshHint(this._calcVolVertical(e.originalEvent.pageY))}),this.getEl().on("wheel",e=>{let t=e.originalEvent;if(!1===this.getPlayer().isUserAction())return;t.preventDefault();let r=.05*(t.deltaY>0?-1:1),i=this.volumeControl.getMuted(null,this);if(!1===i||r>0){let e=i?.1:this.volumeControl.getVolume(null,this);e+=r,e=(0,n.betweenZeroAndOne)(e),this.volumeControl.setVolume(e,null,!0,this),this.volumeControl.setMuted(e<=0,null,!0,this),this._moveDrag(e),this._refreshHint(e)}return!1}),this._moveDrag(this.volumeControl.getVolume(null,this)),this.initDrag(this.getEl())}_refreshHint(e){this.getEl().attr("data-hint",parseInt(100*e)+"%"),this.getMediaContainer().refreshHint()}_moveDrag(e){e=Math.min(1,Math.max(0,e)),this.getEl().nsFind("volume").css("height",parseInt(100*e)+"%")}_calcVol(e){let t=this._wrapper[0].getBoundingClientRect(),r=(e-t.left)/t.width;return r=Math.min(1,Math.max(0,r))}_calcVolVertical(e){let t=this._wrapper[0].getBoundingClientRect(),r=(t.bottom-e)/t.height;return r=Math.min(1,Math.max(0,r))}upHandler(){this.getMediaContainer().unlockHint()}downHandler(){this.getMediaContainer().lockHint()}moveHandler(e,t){let r=this._calcVolVertical(t);this.volumeControl.setVolume(r,null,!0,this),this.volumeControl.setMuted(r<=0,null,!0,this),this._moveDrag(r),this._refreshHint(r)}buildCSSClass(){return`${this.getNs()}-volume-control`}}o.default.isVolumeControl&&(s.default.register(u),d(u.prototype,a.default.prototype));var c=u;r.default=c},{"../../utils/math":332,"./../../env/index":306,"./../controls":256,"./../default":257,"./../draggable":258,"core-js/modules/es6.object.assign":95}],274:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"wantplay"}constructor(e,t,r){super(e,t,r),this.getEl().nsFind("wantplay-control-text").html(this.translate(this.getOption("text"))),this.listenTo(e,"state",this._stateHandler),this.listenTo(e.getMediaContainer(),"wantplay",this._onWantPlay)}buildCSSClass(){return`${this.getNs()}-wantplay-control`}_stateHandler(e){"play"===e.state&&this.hide()}_onWantPlay(){this.show()}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],275:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../default")),s=o(e("./../controls"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.default{static getName(){return"wantunmute"}constructor(e,t,r){super(e,t,r),this._mc=e.getMediaContainer(),this.listenTo(this._mc,{wantunmute:this._onWantUnmute,unmuteSuccess:this._onUnmuteSuccess}),this.listenTo(this.getEl(),"click",this._onClick);let i=this.getNs();this.CLASS_WANTUNMUTE=`${i}-media-container__wantunmute`,this.hide()}buildCSSClass(e){return`${e}-wantunmute-control`}_onWantUnmute(){this._mc.getEl().addClass(this.CLASS_WANTUNMUTE),this.show()}_onUnmuteSuccess(){this._mc.getEl().removeClass(this.CLASS_WANTUNMUTE),this.hide()}_onClick(){this.getPlayer().volumeControl.setMuted(!1,null,!0,this)}}s.default.register(a);var n=a;r.default=n},{"./../controls":256,"./../default":257}],276:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("./AbstractLayout");class s extends i.AbstractLayout{_toString(e){return`\n<div class="${e}-controls-region-bottom ${e}-idleable" data-layout-name="control-layout">\n    <div class="${e}-fullscreen-control ${e}-btn ${e}-control"></div>\n    <div class="${e}-play-control ${e}-btn ${e}-state-pause ${e}-control"></div>\n    <div class="${e}-sound-wrapper">\n        <div class="${e}-mute-control ${e}-btn ${e}-control"></div>\n        <div class="${e}-volume-control ${e}-control" data-hint="" data-hint-move="">\n            <div class="${e}-volume-wrapper">\n                <div class="${e}-volume">\n                    <div class="${e}-volume-drag"></div>\n                </div>\n                <div class="${e}-volume-back"></div>\n            </div>\n        </div>\n    </div>\n    <div class="${e}-quality-wrapper">\n        <div class="${e}-quality-control ${e}-btn ${e}-control">\n            <div class="${e}-quality-control-switcher">Качество</div>\n            <div class="${e}-quality-control-menu">\n\n            </div>\n        </div>\n    </div>\n    <div class="${e}-time-control ${e}-control"></div>\n    <div class="${e}-progress-control ${e}-control" data-hint="" data-hint-move="">\n        <div class="${e}-progress-wrapper">\n            <div class="${e}-progress">\n                <div class="${e}-progress-drag"></div>\n            </div>\n            <div class="${e}-progress-loaded"></div>\n            <div class="${e}-progress-back"></div>\n        </div>\n    </div>\n</div>\n<div class="${e}-poster-control ${e}-control"></div>\n<div class="${e}-mosaic-control ${e}-hidden ${e}-control"></div>\n<div class="${e}-wantplay-control ${e}-hidden ${e}-control">\n    <div class="${e}-wantplay-control-text"></div>\n</div>\n<div class="${e}-screenplay-control ${e}-btn ${e}-control ${e}-state-pause"></div>\n<div class="${e}-controls-region-top ${e}-idleable">\n    <div class="${e}-logo-control ${e}-btn ${e}-control"></div>\n    <div class="${e}-title-control ${e}-control"></div>\n    <div class="${e}-menu-control ${e}-control">\n        <div class="${e}-menu-btn"></div>\n        <ul class="${e}-menu-content"></ul>\n    </div>\n    <div class="${e}-share-control ${e}-btn ${e}-control">\n        <div class="${e}-share-btn ${e}-btn"></div>\n        <span></span>\n    </div>\n</div>`}}s._class_name="ControlLayout";var o=s;r.default=o},{"./AbstractLayout":254}],277:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign");var i=n(e("./events")),s=n(e("./error")),o=n(e("./../utils/unique")),a=n(e("./../utils/extend"));function n(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class d{constructor(e,t={}){this._destroyed=!1,!e&&this.play&&(e=this),this.id=(0,o.default)("mv"),this._player=e,this._events={},this.setOptions(t),e&&e.trigger("create",{item:this})}setOptions(e){this._options=(0,a.default)({},this._options,e)}triggerError(e,t="",r={}){this.trigger(new s.default(this,e,t,r))}destroy(){this._destroyed||(this.trigger("destroy"),setTimeout(()=>{this.stopListening().off()},0),this._destroyed=!0)}get destroyed(){return this._destroyed}getOptions(){return this._options}getOption(e,t){return this._options.hasOwnProperty(e)?this._options[e]:t}setOption(e,t){return this._options[e]=t}getPlayer(){return this._player}}d.prototype._options={},l(d.prototype,i.default);var u=d;r.default=u},{"./../utils/extend":330,"./../utils/unique":337,"./error":281,"./events":283,"core-js/modules/es6.object.assign":95}],278:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.behavior=function(e,...t){!1===Array.isArray(e)&&(e=[e]);t&&t.length>0&&(e=e.concat(t));2===e.length&&"function"==typeof e[0]&&"object"==typeof e[1]&&!1===Array.isArray(e[1])&&(e=[[e[0],e[1]]]);return function(t){return class extends t{constructor(...t){super(...t);for(const t of e)if(Array.isArray(t)){const e=o(t,2),r=e[0],i=e[1];r.attach(this,void 0===i.name?null:i.name,i)}else t.attach(this)}}}},r.detachAllBehaviors=function(e,t,r){const i=r.value;return r.value=function(...e){const t=i.call.apply(i,[this].concat(e));return d.detachAll(this),t},r},r.default=void 0,e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.reflect.delete-property"),e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes");var i=e("../../common/js/utils/string"),s=e("../../common/js/utils/object");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],i=!0,s=!1,o=void 0;try{for(var a,n=e[Symbol.iterator]();!(i=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const a=function(e,...t){let r=null,i=null,s=null,o=null;if(void 0===this.__behaviors)throw new Error("behaviors is not attached");if(Array.isArray(e))if(e.length>1)e[0]instanceof d?i=e[0]:s=e[0],r=e[1];else{if(1!==e.length)throw new Error("parameter 'method' is empty");r=e[0]}else r=e;if(s||i)o=this.getBehavior(s||i);else for(const e in this.__behaviors)this.__behaviors.hasOwnProperty(e)&&!1!==this.__behaviors[e].exports.includes(r)&&(o=this.__behaviors[e]);if(null!==o){if(o.exports.includes(r)){const e=o[r];let i=r;var a;if("object"==typeof e&&void 0!==e.name&&(i=e.name),"function"==typeof o[i])return(a=o)[i].apply(a,t);if(t&&t.length>1)throw new Error(`behavior '${o.behaviorName}' - field '${i}' is not a function, but arguments were passed`);return t&&1===t.length?void(o[i]=t[0]):o[i]}throw new Error(`field '${r}' not found in behavior '${o.behaviorName}'`)}},n=function(e){if(void 0===this.__behaviors)return null;if("string"==typeof e){if(void 0!==this.__behaviors[e])return this.__behaviors[e];for(const t in this.__behaviors)if(this.__behaviors.hasOwnProperty(t)&&this.__behaviors[t].behaviorAlias&&this.__behaviors[t].behaviorAlias===e)return this.__behaviors[t]}else for(const t in this.__behaviors)if(this.__behaviors.hasOwnProperty(t)&&this.__behaviors[t]instanceof e)return this.__behaviors[t];return null},l=function(e){return null!==this.getBehavior(e)};class d{get _base(){return this.__base}set _base(e){this.__base,this.__base=e}get name(){return"behavior-base"}get behaviorName(){return this._customName?this._customName:this.name}get alias(){return null}get behaviorAlias(){return this._customAlias?this._customAlias:this.alias}get addFieldsOnlyWithAlias(){return!1}get alwaysAddFieldsWithAlias(){return!1}get renameBaseFields(){return!1}get renameBaseFieldsPrefix(){return"origin"}constructor(e,t=null,r={}){this.__base=void 0,this._options={},this._optionsLast={},this._customName="",this._customAlias="",this.__additional_fields=[],this.__renamed_fields=[],this.exports=[],this._exportsInitialized=[],this._initialized=!1,Array.isArray(t)?2===t.length?(this._customName=t[0],this._customAlias=t[1]):this._customName=t[0]:this._customName=t,this._base=e,this.setOptions(r)}setOptions(e={}){for(let t in e)e.hasOwnProperty(t)&&this.setOption(t,e[t])}setOption(e,t){this._options[e]!==t&&(this._optionsLast[e]=this._options[e],this._options[e]=t,this._initialized&&this._onChangeOption(e,this._optionsLast[e],this._options[e]))}getOption(e,t){return void 0===this._options[e]?t:this._options[e]}getOptionLastValue(e,t){return void 0===this._optionsLast[e]?t:this._optionsLast[e]}_onChangeOption(e,t,r){}_destroy(){let e=[];for(let r of this.__renamed_fields){var t=o(r,2);let i=t[0],a=t[1];e.push(i);const n=(0,s.getPropertyDescriptor)(this._base,a);Object.defineProperty(this._base,i,n),Reflect.deleteProperty(this._base,a)}this.__renamed_fields=[];for(let t of this.__additional_fields)!1===e.includes(t)&&Reflect.deleteProperty(this._base,t);this.__additional_fields=[],e=null}_init(){if(void 0===this._base.__behaviors&&(this._base.__behaviors={}),void 0!==this._base.__behaviors[this.behaviorName])throw new Error(`behavior with name '${this.behaviorName}' already exist in object`);this._base.__behaviors[this.behaviorName]=this,void 0===this._base.behaviorRun&&(this._base.behaviorRun=a),void 0===this._base.hasBehavior&&(this._base.hasBehavior=l),void 0===this._base.getBehavior&&(this._base.getBehavior=n);for(let e in this.exports)this.exports.hasOwnProperty(e)&&(this._exportsInitialized[e]=this._initSingleExport(e));this._initialized=!0}_getExportConfig(e){let t="number"==typeof e||!1===isNaN(parseInt(e))?parseInt(e):null,r=null===t&&"string"==typeof e?e:null;if(null===t&&null===r)return!1;if(null!==t&&void 0!==this.exports[t])return[t,this.exports[t]];if(r){let e=0;for(let t of this.exports){if("object"==typeof t){if(void 0!==t.name&&t.name===r)return[e,t];if("function"==typeof t.name&&t.name.call(this)===r)return[e,t]}else if(t===r)return[e,t];e++}}return[null,null]}_initSingleExport(e){let t,r,a=this.renameBaseFields,n=this.addFieldsOnlyWithAlias,l=this.alwaysAddFieldsWithAlias,d=null;const u=o(this._getExportConfig(e),2),c=(u[0],u[1]);if(!c)return!1;if("object"==typeof c?(void 0!==c.name&&(t="function"==typeof c.name?c.name.call(this):c.name),void 0!==c.baseName&&(r="function"==typeof c.baseName?c.baseName.call(this):c.baseName),"function"==typeof c.enabled&&(d=c.enabled.call(this)),void 0!==c.renameBaseFields&&(a="function"==typeof c.renameBaseFields?c.renameBaseFields.call(this):c.renameBaseFields)):r=t=c,!1===d||!r)return!1;const h=t,p=(0,i.camelCase)((this.behaviorAlias?this.behaviorAlias:this.behaviorName)+"_"+h),_=[],g=void 0!==this._base[r];g&&a?(_.push(r),l&&_.push(p)):n?_.push(p):(!1===g&&_.push(h),(g||l)&&_.push(p));const f=this;for(let e of _){const r=typeof this._base[e],i=typeof this[t];if("undefined"===r||a){const o="undefined"!==r&&a?this.renameBaseFieldsPrefix+""+(e[0].toUpperCase()+e.substr(1)):e;if("function"===i)"undefined"!==r&&(this._base[o]=this._base[e],this.__renamed_fields.push([e,o])),Object.defineProperty(this._base,e,{enumerable:!1,configurable:!0,value:(...e)=>f[t].apply(f,e)});else{if("undefined"!==r){const t=(0,s.getPropertyDescriptor)(this._base,e);Object.defineProperty(this._base,o,t),this.__renamed_fields.push([e,o])}Object.defineProperty(this._base,e,{enumerable:!0,configurable:!0,get:()=>f[t],set(e){f[t]=e}})}this.__additional_fields.push(e)}}return!0}_destroySingleExport(e){const t=o(this._getExportConfig(e),2),r=t[0],i=t[1];if(!i)return!1;let a,n;"object"==typeof i?(void 0!==i.name&&(a="function"==typeof i.name?i.name.call(this):i.name),void 0!==i.baseName&&(n="function"==typeof i.baseName?i.baseName.call(this,!0):i.baseName),n||(n=a)):n=a=i;let l=[],d=0;for(let e of this.__renamed_fields){var u=o(e,2);let t=u[0],r=u[1];if(t===n){l.push(t);const e=(0,s.getPropertyDescriptor)(this._base,r);Object.defineProperty(this._base,t,e),Reflect.deleteProperty(this._base,r),this.__renamed_fields[d]=void 0}d++}this.__renamed_fields=this.__renamed_fields.filter(e=>e),d=0;for(let e of this.__additional_fields)e===n&&(!1===l.includes(e)&&Reflect.deleteProperty(this._base,e),this.__additional_fields[d]=void 0),d++;return this.__additional_fields=this.__additional_fields.filter(e=>e),l=null,this._exportsInitialized[r]=!1,!0}_refreshSingleExport(e){return!!this._destroySingleExport(e)&&this._initSingleExport(e)}static attach(e,t=null,r){if("function"==typeof e.getBehavior){const t=e.getBehavior(this);if(t)return!!r&&(t.setOptions(r),!0)}const i=new this(e,t,r);return i._base=e,i._init(),!0}static detach(e){let t=e.getBehavior(this);if(!t)return!1;const r=t.behaviorName;return t._destroy(),(t.__additional_fields.length>0||t.__renamed_fields.length>0)&&d.prototype._destroy.call(t),e.__behaviors[r]=null,delete e.__behaviors[r],!0}static detachAll(e){if(void 0===e.__behaviors)return!1;for(const t in e.__behaviors)if(e.__behaviors.hasOwnProperty(t)){const r=e.__behaviors[t],i=r.behaviorName;r._destroy(),(r.__additional_fields.length>0||r.__renamed_fields.length>0)&&d.prototype._destroy.call(r),e.__behaviors[i]=null,delete e.__behaviors[i]}return e.__behaviors=null,delete e.__behaviors,e.__behaviors={},!0}a(){this._destroy(),this.__base=null}static deleteAll(e){return!!this.detachAll(e)&&(Reflect.deleteProperty(e,"__behaviors"),Reflect.deleteProperty(e,"getBehavior"),Reflect.deleteProperty(e,"behaviorRun"),Reflect.deleteProperty(e,"hasBehavior"),!0)}}var u=d;r.default=u},{"../../common/js/utils/object":232,"../../common/js/utils/string":234,"core-js/modules/es6.reflect.delete-property":98,"core-js/modules/es6.string.includes":107,"core-js/modules/es6.symbol":109,"core-js/modules/es7.array.includes":111,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],279:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.array.find"),e("core-js/modules/es6.regexp.to-string");var i=n(e("./../utils/dom")),s=n(e("./translate")),o=n(e("./base-object")),a=e("../controls/AbstractLayout");function n(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}var d=class extends o.default{constructor(e,t){super(e,t),!1!==t.createEl&&this.createEl()}destroy(){super.destroy(),setTimeout(()=>{this._el&&(this._el.remove(),this._el=null)},0)}show(){this._el&&this._el.nsRemoveClass("hidden")}hide(){this._el&&this._el.nsAddClass("hidden")}createEl(e="div",t={},r={}){let s=this.getNs();e.prototype instanceof a.AbstractLayout&&(e=new e(s).toString()),e=e.trim(),this._el=(0,i.default)("<"===e[0]?e:"<"+e+">"),1===this._el.length&&((t=l({},t)).className=this.buildCSSClass(s),this._el.attr(r).prop(t))}getEl(){return this._el}addChild(e){this._el.append(e.getEl()),e.trigger("insertedToDom")}buildCSSClass(e){return""}translate(e){return(0,s.default)(e,this.getPlayer().getOption("lang"))}get width(){return this.getEl()?this.getEl().width():0}get height(){return this.getEl()?this.getEl().height():0}getNs(){return this.getPlayer().ns}$$(e){return this.getEl().find(`.${this.getNs()}-${e}`)}};r.default=d},{"../controls/AbstractLayout":254,"./../utils/dom":328,"./base-object":277,"./translate":297,"core-js/modules/es6.array.find":91,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.regexp.to-string":105}],280:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.from"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/web.dom.iterable");var i,s=(i=e("../../common/js/utils/getTime"))&&i.__esModule?i:{default:i};function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}const a=(0,s.default)();class n{constructor(){this._enabled=void 0,this._waitStack=[],this._lastTime=(0,s.default)(),this._mode=n.MODE_NORMAL}enable(){if(void 0===this._enabled){this._enabled=!0;let e=this._waitStack;for(let t=0;t<e.length;t++)this._call.apply(this,e[t]);this._waitStack=[]}else this._enabled=!0}set mode(e){this._mode=e===n.MODE_NORMAL?n.MODE_NORMAL:n.MODE_STACKTRACE}get mode(){return this._mode}disable(){this._enabled=!1,this._waitStack=[]}_waitCall(e,t){this._waitStack.push(arguments)}_call(e,t){if(void 0===this._enabled)return this._waitCall(e,t);if(!this._enabled)return;let r=Array.prototype.slice.apply(t),i=(0,s.default)(),l=(i-a)/1e3,d=(i-this._lastTime)/1e3;if(this._mode===n.MODE_STACKTRACE){const t="---- ["+l.toFixed(5)+" | +"+d.toFixed(5)+"]";var u;if(this._lastTime=i,["log","info"].indexOf(e)>=0)(u=console).groupCollapsed.apply(u,[t].concat(o(r))),console.trace(),console.groupEnd();else console[e].apply(console,r)}else r.unshift("---- ["+l.toFixed(5)+" | +"+d.toFixed(5)+"]"),this._lastTime=i,console[e].apply(console,r)}log(){this._call("log",arguments)}dir(){this._call("dir",arguments)}info(){this._call("info",arguments)}error(){this._call("error",arguments)}warn(){this._call("warn",arguments)}trace(){this._call("trace",arguments)}}n.MODE_NORMAL=0,n.MODE_STACKTRACE=1;var l=new n;r.default=l},{"../../common/js/utils/getTime":231,"core-js/modules/es6.array.from":92,"core-js/modules/es6.regexp.to-string":105,"core-js/modules/es6.symbol":109,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],281:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./event"))&&i.__esModule?i:{default:i};var o=class extends s.default{constructor(e,t,r="",i={}){i.code=t,i.message=r,super(e,"error",i)}};r.default=o},{"./event":282}],282:[function(e,t,r){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign");var s=class{constructor(e,t,r){this.target=e,this.player=e.getPlayer?e.getPlayer():void 0,this.type=t,"string"==typeof r?this.strData=r:(this.strData=null,i(this,r))}};r.default=s},{"core-js/modules/es6.object.assign":95}],283:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.regexp.split");var i=o(e("./../utils/unique")),s=o(e("./event"));function o(e){return e&&e.__esModule?e:{default:e}}const a=function(e,t,r,i){if(!r)return!0;if("object"==typeof r){for(let s in r)r.hasOwnProperty(s)&&e[t].apply(e,[s,r[s]].concat(i));return!1}if(/\s+/.test(r)){const s=r.split(/\s+/);for(let r of s)e[t].apply(e,[r].concat(i));return!1}return!0},n={on(e,t,r){if(Array.isArray(t)){for(let i of t)this.on(e,i,r);return}if(!a(this,"on",e,[t,r])||!t)return this;this._events||(this._events={});const i=this._events[e]||(this._events[e]=[]);if(this.addEventListener){const i=t;t=(t=>{i.call(r||this,new s.default(r||this,e,{originalEvent:t}))}),this.addEventListener(e,t)}return i.push({callback:t,context:r,ctx:r||this}),this},once(e,t,r){if(!a(this,"once",e,[t,r])||!t)return this;let i=this;const s=function r(){return i.off(e,r),t.apply(this,arguments)};return s._callback=t,this.on(e,s,r)},off(e,t,r){if(!this._events||!a(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;let i=e?Array.isArray(e)?e:[e]:Object.keys(this._events);for(let e of i){let i=this._events[e];if(i){let s=[];if(this._events[e]=s,t||r)for(let o of i)t&&t!==o.callback&&t&&t!==o.callback._callback||r&&r!==o.context?s.push(o):this.removeEventListener&&this.removeEventListener(e,o.callback);s.length||delete this._events[e]}}return this},trigger(e,t){if(!this._events)return this;if("object"==typeof e&&(e=(t=e).type),!a(this,"trigger",e,t))return this;if(this.eventIsMuted(e))return!1;const r=this._events[e];return!r||(t instanceof s.default||(t=new s.default(this,e,t)),t.currentTarget=this,function(e,t){let r=!0;for(let i of e)try{!1===i.callback.call(i.ctx,t)&&(r=!1)}catch(e){setTimeout(function(){throw e},0)}return r}(r,t))},triggerOnce(e,t){return void 0===this._triggeredOnce&&(this._triggeredOnce=[]),!this._triggeredOnce.includes(e)&&(this._triggeredOnce.push(e),this.trigger(e,t))},resetTriggeredOnce(e=null){this._triggeredOnce=e?this._triggeredOnce.filter(t=>t===e):[]},muteEvents(...e){if(void 0===this._mutedEvents&&(this._mutedEvents=[]),void 0===this._mutedAllEvents&&(this._mutedAllEvents=!1),e)for(let t of e)!1===this.eventIsMuted(t)&&"string"==typeof t&&this._mutedEvents.push(t);else this._mutedAllEvents=!0,this._mutedEvents=[]},unMuteEvents(...e){if(void 0===this._mutedEvents&&(this._mutedEvents=[]),void 0===this._mutedAllEvents&&(this._mutedAllEvents=!1),e){this._mutedAllEvents&&(this._mutedAllEvents=!1,this._mutedEvents=this._events?Object.keys(this._events):[]);for(let t of e)!0===this.eventIsMuted(t)&&"string"==typeof t&&(this._mutedEvents=this._mutedEvents.filter(e=>e!==t))}else this._mutedAllEvents=!0,this._mutedEvents=[]},eventIsMuted(e){return void 0===this._mutedEvents&&(this._mutedEvents=[]),void 0===this._mutedAllEvents&&(this._mutedAllEvents=!1),this._mutedAllEvents||this._mutedEvents.includes(e)},stopListening(e,t,r){let i=this._listeningTo;if(!i)return this;const s=!t&&!r;r||"object"!=typeof t||(r=this),e&&(i={[e._listenId]:e});for(let o in i)i.hasOwnProperty(o)&&(void 0!==(e=i[o]).off&&e.off(t,r,this),(s||0===e._events.length)&&delete this._listeningTo[o]);return this}},l={listenTo:"on",listenToOnce:"once"};for(let e in l)l.hasOwnProperty(e)&&function(e,t){n[t]=function(t,r,s){return(this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=(0,i.default)())]=t,s||"object"!=typeof r||(s=this),t[e](r,s,this),this}}(l[e],e);var d=n;r.default=d},{"./../utils/unique":337,"./event":282,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.regexp.split":104,"core-js/modules/es6.string.includes":107,"core-js/modules/es7.array.includes":111,"core-js/modules/web.dom.iterable":115}],284:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=a(e("./base-object")),s=e("../providers/default"),o=a(e("../utils/catchHandler"));function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{constructor(e,t={}){super(e,t),this._init()}_init(){const e=this.getPlayer(),t=e.getStorage();let r=()=>{e.state===s.PROVIDER_STATE.PLAY?t.setItem("__MV_PLAYING",1,{expire:2e3}).then(()=>{setTimeout(r,1e3)}).catch(e=>(0,o.default)(e)):setTimeout(r,1e3)};r()}playingNow(){return this.getPlayer().getStorage().hasItem("__MV_PLAYING").then(e=>e?Promise.resolve():Promise.reject())}};r.default=n},{"../providers/default":317,"../utils/catchHandler":327,"./base-object":277,"core-js/modules/es6.promise":97}],285:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./../core/component"))&&i.__esModule?i:{default:i};var o=class extends s.default{get src(){return this.getOption("src")}createEl(e="iframe",t,r){(r=this.getOption("attributes")||{}).src=this.src,super.createEl(e,t,r)}};r.default=o},{"./../core/component":279}],286:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./base-object")),s=o(e("./console"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends i.default{constructor(e,t={}){super(e,t),this._loadings={},this.CLASS_LOADING="loading"}_update(e,t){let r=this._loadings,i=!1,o=this.getPlayer().getEl(),a=this.CLASS_LOADING;for(let e in r)r.hasOwnProperty(e)&&r[e]>0&&(i=!0);i?o.nsHasClass(a)||(s.default.log("LOADING",e,t),o.nsAddClass(a)):o.nsHasClass(a)&&(s.default.log("LOADING",e,t),o.nsRemoveClass(a))}start(e="default"){this._loadings.hasOwnProperty(e)||(this._loadings[e]=0),this._loadings[e]++,this._update(e,"start")}end(e="default",t=!1){this._loadings.hasOwnProperty(e)||(this._loadings[e]=0),this._loadings[e]--,(this._loadings[e]<0||t)&&(this._loadings[e]=0),this._update(e,"end")}};r.default=a},{"./base-object":277,"./console":280}],287:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.promise");var i=_(e("./component")),s=_(e("./event")),o=_(e("./error")),a=_(e("./../controls/control-layer")),n=_(e("./../controls/hintable")),l=_(e("./../providers/providers")),d=_(e("./../providers/metaprovider")),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./../utils/extend")),c=_(e("../utils/error")),h=_(e("../utils/catchHandler")),p=e("../providers/default");function _(e){return e&&e.__esModule?e:{default:e}}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class f extends i.default{_selectProvider(e){return l.default.select(e)}constructor(e,t){super(e,t),this.getEl().nsAddClass("media-container","state-idle"),this._viewMode="",this.viewMode=this.getPlayer().fullScreen?"fullscreen":"normal",this._state="idle",this._loadState="no",this._loadJob=!1,this._preLoadJob=!1,this._controls=!1,this._provider=!1;let r=this.getOption("video");if(r){let e=this._selectProvider(r);if(e){let t=e.getName(),i=(this.getOption("providers")||{})[t]||{};(0,u.default)(r,i),this.setProvider(new e(this,r))}}this.once("start wantplay",()=>{this.needShow()})}setProvider(e){this._provider=e,this.listenTo(e,{state:this._onProviderState,"skip close error start beforeStart stall timeupdate finish volumechange wantunmute unmuteSuccess":this.trigger}),this.listenTo(this.getPlayer(),{fullscreenchange:()=>{let e=this.getPlayer();e.fullScreen&&"normal"===this.viewMode&&(this.viewMode="fullscreen"),e.fullScreen||"fullscreen"!==this.viewMode||(this.viewMode="normal")}}),this._initModificatorCls()}volumeChangeSupport(){return!this._provider||this._provider.volumeChangeSupport()}doNotRemoveAfterDestroy(){return!1}destroy(){this._loadState="destroy";let e=this.doNotRemoveAfterDestroy();this._destroyProvider().then(()=>{this._provider=!1}).catch(e=>(0,h.default)(e)),this._controls&&(this._controls.destroy(),this._controls=!1),e?(this.getEl().css({visibility:"hidden",position:"absolute",top:0,left:0,width:"10px",height:"10px",zIndex:-1e3}),this.trigger("destroy"),setTimeout(()=>{this.stopListening().off()},0)):super.destroy()}_destroyProvider(){let e=this._provider;return e?this._destroyProviderJob?this._destroyProviderJob:(this._destroyProviderJob=new Promise(t=>{e.once("destroy",t)}),e.destroy(),this._destroyProviderJob):Promise.resolve()}buildCSSClass(){return`${this.getNs()}-media-container ${super.buildCSSClass()}`}_initModificatorCls(){let e=this._provider,t=this.getEl();e&&(t.nsAddClass("media-container",e.getName()),e instanceof d.default&&e.once("providerSelected",e=>{let r=e.provider;r&&t.nsAddClass("media-container",`meta_${r.getName()}`)}))}getProvider(){return this._provider}_onProviderState(e){"idle"!==e.state&&this.getEl().nsAddClass("started"),this.getEl().nsRemoveClass("media-container","state-"+this._state).nsAddClass("media-container","state-"+e.state),this._state=e.state,this.trigger(e)}get state(){return this._timeoutError?"error":this._state}needShow(){this.trigger("needShow")}preLoad(e=5e3){if(!this._preLoadJob)if(this._provider){this._loadState="process";const t=this._provider;t.loadingTimeout&&(e=t.loadingTimeout);const r=this.getOption("timeout");r&&r>e&&(e=r),t.preLoadType===p.PROVIDER_PRELOAD_TYPE.DOM&&this.addChild(t),this._preLoadJob=new Promise((r,i)=>{if(t.preLoad(e).then(e=>{this._loadState="done",r(e)}).catch(e=>{this._loadState="error",i(e)}),e){(()=>{setTimeout(()=>{i(new o.default(this,402,`Таймаут предзагрузки провайдера - ${e} мс`))},e)})()}this.once("_forceTimeout",()=>{i(new o.default(this,402,"Таймаут предзагрузки провайдера (force)"))})}).catch(e=>{throw this._loadState="error",e instanceof s.default?this.trigger(e):this.trigger("error",{message:e}),e})}else{this._loadState="error";let e=new o.default(this,400,"Не удалось подобрать провайдер для проигрывания рекламы",{media:this.getOption("video")});this.trigger(e),this._preLoadJob=Promise.reject(e)}return this._preLoadJob}forceTimeout(e=0){setTimeout(()=>{this._timeoutError=!0,this.trigger("_forceTimeout")},e)}load(e=5e3){if(!this._loadJob)if(this._provider){this._loadState="process";const t=this._provider;t.loadingTimeout&&(e=t.loadingTimeout);const r=this.getOption("timeout");r&&r>e&&(e=r),t.preLoadType!==p.PROVIDER_PRELOAD_TYPE.DOM&&this.addChild(t),this._loadJob=new Promise((r,i)=>{let a=this.getPlayer();if(t.load(e).then(()=>{try{this._loadState="done",this._initControls().then(()=>{r()}).catch(e=>(0,h.default)(e))}catch(e){i(new o.default(this,300,`Ошибка загрузки провайдера [1] (${e.message}, ${e.stack})`))}}).catch(e=>{e instanceof s.default?i(e):e instanceof Error?(i(new o.default(this,300,`Ошибка загрузки провайдера [2] (${e.message}, ${e.stack})`)),c.default.rethrow(e)):i(new o.default(this,300,"Ошибка загрузки провайдера"))}),e){let t=()=>{setTimeout(()=>{i(new o.default(this,402,`Таймаут загрузки провайдера - ${e} мс`))},e)};a.visible?t():a.once("visible",t)}this.once("_forceTimeout",()=>{i(new o.default(this,402,"Таймаут загрузки провайдера (force)"))})}).catch(e=>{throw this._loadState="error",e instanceof s.default?this.trigger(e):this.trigger("error",{message:e}),e})}else{this._loadState="error";let e=new o.default(this,403,"Do not found provider",{media:this.getOption("video")});this.trigger(e),this._loadJob=Promise.reject(e)}return this._loadJob}get loadState(){return this._loadState}_initControls(){return new Promise((e,t)=>{let r=this.getProvider(),i=r.getControls(),s=!1===i?i:(0,u.clone)(r.getControls()),o=(0,u.clone)(this.getOption("controls"));r.getOption("nativeControls")?e():s&&o?s.onlyProviderControls?(delete s.onlyProviderControls,o.items=s,this._createControls(o),e()):(o.items||(o.items={}),g(o.items,s),r.qualityChangeSupported&&(o.items.quality={}),o.items.wantplay={text:this._getWantPlayText()},r.getOption("poster")?r.signUrl(r.getOption("poster")).then(t=>{g(o.items,{poster:{image:t}}),this._createControls(o),e()}).catch(e=>(0,h.default)(e)):(this._createControls(o),e())):(r.supportWantPlay&&this._createControls({rewrite:!0,items:{wantplay:{text:this._getWantPlayText()}}}),e())})}_getWantPlayText(){return"Для начала воспроизведения нажмите"}_createControls(e){this._controls=new a.default(this,e),this.getPlayer().isReady()?this._appendControls():this.getPlayer().on("ready",()=>{this._appendControls()})}_appendControls(){this.addChild(this._controls);let e=this.getEl().nsFind("idleable"),t=this.getPlayer();e.on("touchstart mouseenter",()=>{t.changeIdleCounter(-25e3)}),e.on("touchfinish mouseleave",()=>{t.changeIdleCounter(0)}),this.initHint(),this.trigger("controlsAppended")}play(){this._provider&&(this._provider.autoPlaySupported||this.getPlayer().isUserAction()?("idle"===this._provider.state&&this.getOption("timeout")&&(this._timeout=setTimeout(()=>{this._timeout=!1,this._timeoutError=!0,this.trigger("timeout")},this.getOption("timeout")),this.once("start wantplay",()=>{this._timeout&&clearTimeout(this._timeout)})),this._provider.play()):this.trigger("wantplay"))}pause(){this._provider&&this._provider.pause()}get timeout(){return this.getOption("timeout")||5e3}get viewMode(){return this._viewMode}set viewMode(e){let t=this,r=t._viewMode;if(r!==e&&["normal","fullscreen","thumb"].indexOf(e)>=0){let i=t.getEl();i&&(i.nsRemoveClass("media-container-vm",r).nsAddClass("media-container-vm",e),t._viewMode=e,t.trigger("viewmodechange"))}}get duration(){return this._provider?this._provider.duration:0}get currentTime(){return this._provider?this._provider.currentTime:0}get controls(){return this._controls}}f.prototype._options={controls:{}},g(f.prototype,n.default.prototype);var m=f;r.default=m},{"../providers/default":317,"../utils/catchHandler":327,"../utils/error":329,"./../controls/control-layer":255,"./../controls/hintable":259,"./../providers/metaprovider":321,"./../providers/providers":322,"./../utils/extend":330,"./component":279,"./error":281,"./event":282,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97}],288:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.from"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es7.symbol.async-iterator"),e("core-js/modules/es6.symbol"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.array.find"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.promise"),e("core-js/modules/es7.promise.finally"),e("core-js/modules/es7.array.includes"),e("core-js/modules/es6.string.includes");var i=A(e("./plugin")),s=A(e("./media-container")),o=A(e("./component")),a=A(e("./loading")),n=A(e("./error")),l=A(e("./../utils/dom")),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./../env/index")),u=A(e("./storage/storage")),c=A(e("./visibility")),h=e("../providers/default"),p=A(e("./console")),_=A(e("./global-info")),g=e("../../common/js/utils/RafTimer"),f=A(e("./volume-controller")),m=A(e("../utils/catchHandler"));function A(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}class y extends o.default{addPromo(e){this._el.addClass("__has-promo"),this._$elPromo.append(e.getEl()),this._promoCmp=e}addToTopContainer(e){this._el.addClass("__has-top-container"),this._$elTop.append(e.getEl()),this._topCmp=e}addToRoot(e){this._el.appendReal(e.getEl()),e.trigger("insertedToDom")}removeFromTopContainer(e){this._topCmp===e&&(e.getEl().detach(),this._el.removeClass("__has-top-container"),this._topCmp=null)}addToBottomContainer(e){this._el.addClass("__has-bottom-container"),this._$elBottom.append(e.getEl()),this._bottomCmp=e}removeFromBottomContainer(e){this._bottomCmp===e&&(e.getEl().detach(),this._el.removeClass("__has-bottom-container"),this._bottomCmp=null)}seteEventStatus(){this.eventStatus=this.firstStart&&!this.isCriticalError()}firstSendEvent(){return this.eventStatus}isFirstEvents(e){return this.adListContentRoll.includes(this.adIdVideo)||(this.countAdContentRoll+=1,this.adListContentRoll.push(this.adIdVideo)),!this._getNumberDuplicateEvents(e).includes(this.countAdContentRoll)}constructor(e,t){super(null,t),this.PREFIX_MV_PLAY="MV, MOEVIDEOBIZ",this.adListContentRoll=[],this.countAdContentRoll=0,this._$elPromo=(0,l.default)("<div>").nsAddClass("player-promo"),this._$elTop=(0,l.default)("<div>").nsAddClass("player-top-container"),this._$elContent=(0,l.default)("<div>").nsAddClass("player-content"),this._$elBottom=(0,l.default)("<div>").nsAddClass("player-bottom-container"),this._el.append(this._$elPromo),this._el.append(this._$elTop),this._el.append(this._$elContent),this._el.append(this._$elBottom),this._el.appendReal=this._el.append,this._el.append=(e=>{this._$elContent.append(e)}),this.firstStart=!0,(0,l.default)(e).append(this._el),t.transparentMode&&(0,l.default)(e).nsAddClass("player-transparent"),666===parseInt(t.version)&&this.setOption("console",!0),this.getOption("console",!1)?p.default.enable():p.default.disable(),this.seteEventStatus(),(0,d.setDeviceInfo)(this.getOption("deviceInfo")),this._testMode=Math.random()>.5,this._loading=new a.default(this),this.path=t.path,this.version=t.version,this._debug=this.getOption("debug"),this._ready=!1,this._userAction=!1,this._userActionGlobal=!1,this._actionTime=0,p.default.log("Player version: "+this.version),this.volumeControl=new f.default({volume:this.getOption("volume"),muted:!!this.getOption("muted")}),this._plugins={},this._pluginsLoadingState={},this._idleState=!1,this._idleCounter=0,this._fullScreen=!1,this._mediaWrapper=(0,l.default)("<div/>").nsAddClass("media-wrapper").nsAddClass("layout"),this.getEl().append(this._mediaWrapper),this._storage=new u.default(this,{}),this.getEl().on("click",()=>{this.trigger("userClick")}),this._visibility=new c.default(this),this._initPlugin("log",!0),this._initPlugin("backend",!0),this.getOption("autoPause",!1)&&this._control20minutes(),this._testUrl(),this.loading.start("player"),this.init().finally(()=>this.ready()).then(()=>{this.loading.end("player")}).catch(e=>(0,m.default)(e))}get loading(){return this._loading}get ns(){return l.default.getNs()}_testUrl(){if(window.top!==window)try{this.trigger("topUrlDetected",{url:window.top.location.href})}catch(e){}}get testMode(){return this._testMode}get srvTestMode(){return this.getOption("testMode",!1)}_control20minutes(){let e,t=0;function r(){t&&(clearTimeout(t),t=0)}this.on({state:i=>{let s=i.state;switch(s){case h.PROVIDER_STATE.PLAY:e===h.PROVIDER_STATE.WAITING&&t||(t=setTimeout(()=>{let e=this._mediaContainer;1e3*(e.duration-e.currentTime)>3e5&&this.pause()},9e5));break;case h.PROVIDER_STATE.PAUSE:case h.PROVIDER_STATE.END:case h.PROVIDER_STATE.CLOSE:r()}e=s},error:r})}isReady(){return this._ready}ready(){let e=this._doReady();return this.ready=function(){return e},e}_doReady(){return this.log("Детект окружения..."),d.default.ready.then(()=>(d.default.allowEmptyPlayerSize=!!this.getOption("allowEmptyPlayerSize"),this.log("Окружение определено."+(d.default.allowEmptyPlayerSize?"":" Ожидание ненулевого размера плеера...")),this.env=d.default,new Promise((e,t)=>{p.default.log("player marker 1"),this.trigger("playerOptions");let r=()=>{this.log("Готов к работе"),p.default.log("player marker 3"),this.trigger("ready"),this._startIdleTimer(),this._ready=!0,e()};if(!0===d.default.allowEmptyPlayerSize)r();else{let e=(0,g.rafSetInterval)(()=>{if(!1!==d.default.allowEmptyPlayerSize||0!=this.width&&0!=this.height)return p.default.log("player marker 2"),e.stop(),r(),!1},50)}})))}_currentErrorRate(){return Math.floor(101*Math.random())}init(){this.log("Подбор метода определения видимости...");let e=this._visibility.init().then(()=>{this.log("Определение видимости работает")},()=>{this.log("Сбой определения видимости",!0)});this.log("Инициализируем хранилище данных");let t=this._storage.init().then(()=>{this.log("Хранилище данных запущено.")},()=>{this.log("Сбой хранилища данных",!0)}),r=this._initVideo(),i=Promise.all([e,t,r]).then(()=>(this.log("Запуск плагинов"),this._initPlugins())).then(()=>{this.log("Плагины запущены.")},()=>{this.log("Сбой запуска плагинов",!0)}).then(()=>{this._initEvents(),this._globalInfo=new _.default(this)});return this.init=function(){return i},i}get toolUid(){return this.getOption("id",!1)}get globalInfo(){return this._globalInfo}_initVideo(){let e=this.getOption("video");return e?(this.log("Подготавливаем видео."),this.load(e).then(()=>{this.log("Видео подготовлено")}).catch(e=>(this.log("Сбой подготовки видео",!0),e instanceof n.default?this.trigger(e):(e?e.filename||(e.filename=this.getPlayer().path+"/name.js"):e=new Error("Warning! Unknown error!!!"),this.trigger("error",{originalEvent:e})),Promise.resolve()))):(this.log("Видео не обнаружено"),Promise.resolve())}destroy(){super.destroy(),this._stopIdleTimer(),this.fullScreen=!1}getMediaWrapper(){return this._mediaWrapper}getStorage(){return this._storage}getPlugin(e){return this._plugins[e]}_initPlugins(){let e=[],t=this.getOption("plugins");for(let r in t)t.hasOwnProperty(r)&&e.push(this._initPlugin(r));return Promise.all(e)}_initPlugin(e,t=!1){let r=this._pluginsLoadingState;if(r.hasOwnProperty(e))return r[e];let s=i.default.find(e),o=this.getOption("plugins"),a=function(e,r=!1){t||(r?p.default.warn(e):p.default.info(e))};if(s)if(o.hasOwnProperty(e)){a(`Инициализация плагина: ${e}`);try{this._plugins[e]=new s(this,o[e]),r[e]=this._plugins[e].load()}catch(t){a(`Ошибка при загрузке плагина ${e}: ${t.message}`,!0)}}else a(`Плагин ${e} найден, но не указан в конфиге`,!0);else a(`Плагин ${e} не найден, но указан в конфиге`,!0);return r.hasOwnProperty(e)||(r[e]=Promise.resolve()),r[e]}log(e,t=!1){p.default.log("player",e,t),this.trigger("log",{message:e,isError:t})}load(e,t,r,i,o){let a,n;a="string"==typeof e?{src:e,poster:t,provider:r,nativeControls:i}:e,this._mediaContainer&&this._mediaContainer.destroy(),"https:"===window.location.protocol&&(a.src&&(a.src=a.src.replace(/^http:\/\//,"https://")),a.poster&&(a.poster=a.poster.replace(/^http:\/\//,"https://")));let l=this.getOption("controls")||{items:{}};return o&&(l.items.title={text:o}),n=new s.default(this,{video:a,controls:l}),this._mediaWrapper.append(n.getEl()),this._mediaContainer=n,this.listenTo(n,{"start state error timeupdate finish":this.trigger,state:this._onState}),this.loading.start("video_load"),n.load().then(()=>{this.loading.end("video_load"),this.trigger("change",{mc:n})},()=>{this.loading.end("video_load")})}_onState(e){let t=this._state;t!==e.state&&(this._state=e.state,"waiting"===this._state?this.loading.start("video_waiting"):"waiting"===t&&this.loading.end("video_waiting"))}_startIdleTimer(){if(!this._idleTimer){let e=this.getEl();e[0].addEventListener("click",e=>{(!0===this._idleState||Date.now()-this._actionTime<100)&&(e.stopPropagation(),e.preventDefault())},!0),e.on("click mouseenter mousemove keydown DOMMouseScroll mousewheel touchmove",()=>{!0===this._idleState?this._actionTime=Date.now():this._actionTime=0,this.changeIdleCounter(0)}),e.on("mouseleave",()=>{this._mediaContainer&&"play"===this._mediaContainer.state&&(this.changeIdleCounter(3e3),this._idle(!0))}),this._idleTimer=setInterval(()=>{if(this._mediaContainer)switch(this._mediaContainer.state){case"play":this._idleCounter+=100;break;case"pause":this.changeIdleCounter(0)}this._idleCounter>=3e3&&!this._idleState&&this._idle(!0)},100)}}isCriticalError(){var e;const t=this.getNameInstrument(null===(e=this._options.plugins.advert)||void 0===e?void 0:e.slots);if("vast"===t){return 6>=this._currentErrorRate()}return!1}getNameInstrument(e=""){const t=Object.keys(e);return t.includes("vast")?"vast":t.includes("content")?"content":"otherwise"}changeIdleCounter(e){e<=0&&this._idle(!1),this._idleCounter=e}_stopIdleTimer(){!1!==this._idleTimer&&(clearInterval(this._idleTimer),this._idleTimer=!1)}_idle(e){this._idleState!==e&&(this._idleState=e,e?(this.getEl().nsAddClass("idle"),this.trigger("idle")):(this.getEl().nsRemoveClass("idle"),this.trigger("unIdle")))}_initEvents(){let e=()=>{this._userAction=!1},t=(0,l.default)("body");this.listenTo(window,"resize orientationchange",()=>{this.trigger("resize")});t[0].addEventListener("click",()=>{this._userAction=!0,this._userActionGlobal=!0,this.trigger("userAction"),setTimeout(e,0)},!0),this.listenTo(t,"click",e),this.listenTo(window,"unload",()=>{this.fullScreen=!1}),this.listenTo(document,"fullscreenchange",e=>{null!==document.fullscreenElement&&document.fullscreenElement===this.getEl()[0]&&(this._fullScreen=!0,this.trigger("fullscreenchange")),null===document.fullscreenElement&&!0===this._fullScreen&&(this._fullScreen=!1,this.trigger("fullscreenchange"))})}isUserAction(){return this._userActionGlobal}buildCSSClass(){return`${this.ns}-player ${super.buildCSSClass()}`}getMediaContainer(){return this._mediaContainer}play(){this.trigger("tryToPlayVideo"),this._mediaContainer&&this._mediaContainer.play()}pause(){this._mediaContainer&&this._mediaContainer.pause()}get state(){return this._state}get fullScreen(){return this._fullScreen}set fullScreen(e){this.fullScreen!==e&&(e?this.getEl()[0].requestFullscreen():document.exitFullscreen())}get debug(){return this._debug}get visibility(){return this._visibility}get visible(){return this._visibility.visible}set visible(e){this._visibility.documentHidden=!e,this._visibility.frameVisible=e}set refInfo(e){this._refInfo=e}get refInfo(){return this._refInfo}get isDevVersion(){return 666===this.version}_getNumberDuplicateEvents(e){return e.reduce((e,t)=>v(e).concat([t.length]),[])}waitVisible(e){return new Promise(t=>{this.visible?t(e):this.on("visible",()=>{t(e)})})}}y.prototype._options={plugins:[],volume:.8,muted:!1};var b=y;r.default=b},{"../../common/js/utils/RafTimer":229,"../providers/default":317,"../utils/catchHandler":327,"./../env/index":306,"./../utils/dom":328,"./component":279,"./console":280,"./error":281,"./global-info":284,"./loading":286,"./media-container":287,"./plugin":289,"./storage/storage":295,"./visibility":298,"./volume-controller":299,"core-js/modules/es6.array.find":91,"core-js/modules/es6.array.from":92,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.to-string":105,"core-js/modules/es6.string.includes":107,"core-js/modules/es6.symbol":109,"core-js/modules/es7.array.includes":111,"core-js/modules/es7.promise.finally":113,"core-js/modules/es7.symbol.async-iterator":114,"core-js/modules/web.dom.iterable":115}],289:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i,s=(i=e("./base-object"))&&i.__esModule?i:{default:i};let o=[];var a=class extends s.default{static register(e,t){if(o.hasOwnProperty(e))throw new Error("Plugin "+e+" already registered");return o[e]=t,!0}static find(e){return o[e]}constructor(e,t={}){super(e,t),this._externalMethods={}}load(){return Promise.resolve()}_allowExternalCall(e){for(let t=0;t<e.length;t++)this._externalMethods[e[t]]=!0}externalCall(e,t){this._externalMethods.hasOwnProperty(e)&&this[e].call(this,t)}};r.default=a},{"./base-object":277,"core-js/modules/es6.promise":97}],290:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MockLocalStorage=function(){return function(){let e={};return Object.defineProperty(e,"key",{value(t){let r=Object.keys(e)[t];return void 0===r?null:unescape(r)},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(e,"getItem",{value(t){let r=escape(t+"");return e.hasOwnProperty(r)?null===e[r]?"null":e[r]:null},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(e,"setItem",{value(t,r){e[escape(t)]="object"!=typeof r?r+"":r},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(e,"removeItem",{value(t){t&&delete e[escape(t)]},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(e,"length",{get:()=>Object.keys(e).length,configurable:!1,enumerable:!1}),Object.defineProperty(e,"clear",{value(){Object.keys(e).forEach(function(t){delete e[t]})},writable:!1,configurable:!1,enumerable:!1}),e}()},e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys")},{"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/web.dom.iterable":115}],291:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=o(e("../../base-object")),s=o(e("../../console"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){let t=`Не реализован абстрактный метод ${e}`;return s.default.error(t),Promise.reject(t)}var n=class extends i.default{constructor(e,t={}){super(e,t),this._init()}_init(){}ready(){let e=this._doReady();return this.ready=function(){return e},e}_doReady(){return a("_doReady")}setItem(e,t){return a("setItem")}getItem(e){return a("getItem")}hasItem(e){return a("hasItem")}removeItem(e){return a("removeItem")}lockItem(e){return a("lockItem")}unlockItem(e){return a("unlockItem")}};r.default=n},{"../../base-object":277,"../../console":280,"core-js/modules/es6.promise":97}],292:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=n(e("../../../utils/dom")),s=n(e("./storage-abstract")),o=n(e("../../../../tools/storage/magic-storage")),a=n(e("../../../utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}const l=o.default.VERSION,d="https://moe.video/storage.html",u="__api_ready",c="__api_error";var h=class extends s.default{_init(){this._requestCount=0,this._requestCallbacks={},(0,i.default)(window).on("message",this._onMessage.bind(this)),this.ready().catch(()=>{this.getPlayer().trigger("pluginStorageDoNotWork")})}_doReady(){return new Promise((e,t)=>{let r,s=this.getPlayer().getOption("storageFrameSrc")||d;s+=`?v=${l}`;let o=(...e)=>{t.apply(void 0,e)};this.once(u,(...t)=>{e.apply(void 0,t)}),this.once(c,o),(r=(0,i.default)("<iframe>")).attr("src",s).css({width:"1px",height:"1px",position:"absolute",visibility:"hidden"}),document.body.appendChild(r[0]),this._$iframe=r,r.on("load",()=>{setTimeout(o,500)}),setTimeout(o,5e3)})}setItem(e){return this._sendRequest("set",e)}getItem(e){return this._sendRequest("get",e)}hasItem(e){return this._sendRequest("has",e)}removeItem(e){return this._sendRequest("remove",e)}lockItem(e){return this._sendRequest("lock",e)}unlockItem(e){return this._sendRequest("unlock",e)}clear(){return this._sendRequest("clear")}_send(e,t){this.ready().then(()=>{t={MoeVideoStorage:!0,type:e,data:t},this._$iframe[0].contentWindow.postMessage(JSON.stringify(t),"*")}).catch(e=>(0,a.default)(e))}_sendRequest(e,t){let r=this._requestCount++;return this._send("request",{reqId:r,action:e,data:t}),new Promise((e,t)=>{this._requestCallbacks[r]=e,setTimeout(()=>{this._requestCallbacks[r]&&t()},5e3)})}_onMessage(e){if(e=e.originalEvent,this._$iframe[0].contentWindow!==e.source)return;let t,r,i,s;try{t=JSON.parse(e.data)}catch(e){t={}}if(s=t.event,t.MoeVideoStorage&&s)switch(r=s.data,s.type){case"response":i=r.reqId,this._requestCallbacks[i]&&(this._requestCallbacks[i](r.data),delete this._requestCallbacks[i]);break;case"ready":r===l?this.trigger(u):this.trigger(c);break;case"init_error":this.trigger(c);break;case"update":this._onUpdate(r);break;case"remove":this._onRemove(r)}}_onRemove(e){this.trigger("remove",e)}_onUpdate(e){this.trigger("update",e)}};r.default=h},{"../../../../tools/storage/magic-storage":342,"../../../utils/catchHandler":327,"../../../utils/dom":328,"./storage-abstract":291,"core-js/modules/es6.promise":97}],293:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=o(e("../../../../tools/storage/magic-storage")),s=o(e("./storage-abstract"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends s.default{_doReady(){return new Promise((e,t)=>{this._storage=new i.default({listeners:{init_error:t,ready:e}})})}setItem(e,t){let r=e;return 2===arguments.length&&(r=[{key:e,value:t}]),Promise.resolve(this._storage.setValue(r))}getItem(e){return Promise.resolve(this._storage.getValue(e))}hasItem(e){return Promise.resolve(null!==this._storage.getValue(e))}removeItem(e){return Promise.resolve(this._storage.removeValue(e))}lockItem(e){return Promise.resolve(this._storage.lock(e))}unlockItem(e){return Promise.resolve(this._storage.unlock(e))}clear(){return Promise.resolve(this._storage.clear())}};r.default=a},{"../../../../tools/storage/magic-storage":342,"./storage-abstract":291,"core-js/modules/es6.promise":97}],294:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=a(e("./storage-local")),s=a(e("../../../../tools/storage/magic-storage")),o=e("./mock/LocalStorage");function a(e){return e&&e.__esModule?e:{default:e}}var n=class extends i.default{_doReady(){return new Promise((e,t)=>{this._storage=new s.default({storage:new o.MockLocalStorage,listeners:{init_error:t,ready:e}})})}};r.default=n},{"../../../../tools/storage/magic-storage":342,"./mock/LocalStorage":290,"./storage-local":293,"core-js/modules/es6.promise":97}],295:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=d(e("../base-object")),s=d(e("../console")),o=d(e("./proxy/storage-local")),a=d(e("./proxy/storage-global")),n=d(e("./proxy/storage-mock")),l=d(e("../../utils/catchHandler"));function d(e){return e&&e.__esModule?e:{default:e}}let u={GLOBAL:"global",LOCAL:"local",MOCK:"unavailable",UNKNOWN:void 0};var c=class extends i.default{constructor(e,t){super(e,t),this._type=u.UNKNOWN,this._lockStack=[],this.ready()}ready(){let e=new Promise(e=>{const t=this.getPlayer();this.once("changeType",()=>{e(this)}),this._storage=new a.default(t),this._storage.ready().then(()=>{this.type=u.GLOBAL}).catch(()=>(this._storage=new o.default(t),this._storage.ready())).then(()=>{this.type===u.UNKNOWN&&(this.type=u.LOCAL)}).catch(()=>(this._storage=new n.default(t),this._storage.ready())).then(()=>{this.type===u.UNKNOWN&&(this.type=u.MOCK),this._storage.on("update",this._onUpdate,this)}).catch(e=>(0,l.default)(e))});return this.ready=function(){return e},e}init(){return this.ready()}set type(e){s.default.log(`Выбран тип хранилища: ${e}`),this._type=e,this.trigger("changeType",{storageType:e})}get type(){return this._type}get isMock(){return this.type===u.MOCK}get available(){switch(this.type){case u.GLOBAL:case u.LOCAL:return!0;default:return!1}}getItem(e){return this._storage.getItem(e)}setItem(e,t,r={}){return 1===arguments.length?this._storage.setItem(e):this._storage.setItem({key:e,value:t,ifNotExists:r.ifNotExists,expire:r.expire})}hasItem(e){return this._storage.hasItem(e)}removeItem(e){return this._storage.removeItem(e)}clear(){return this._storage.clear()}lockItem(e,t=500){return new Promise((r,i)=>{this._lockStack.push(()=>{this._locked=!0;let s=new Date,o=()=>{this._storage.lockItem(e).then(e=>{e?r():new Date-s>t?(this._locked=!1,i(),this._tryLock()):setTimeout(o,50)}).catch(e=>(0,l.default)(e))};o()}),this._tryLock()})}_tryLock(){this._locked||this._lockStack.length&&this._lockStack.shift()()}unlockItem(e){return this._storage.unlockItem(e).then(e=>(this._locked=!1,this._tryLock(),e))}_onUpdate(e){let t=e.key,r=e.prevValue,i=e.value,s=e.isExternal;switch(t){case"volume":case"muted":case"advert_start":this.trigger(`${t}_change`,{value:i,prevValue:r,isExternal:s})}this.trigger("change",{key:t,value:i,prevValue:r,isExternal:s})}_onRemove(e){let t=e.prevValue;"string"==typeof t&&(t=JSON.parse(t)),this.trigger("remove",{key:e.key,prevValue:t,isExternal:e.isExternal})}};r.default=c},{"../../utils/catchHandler":327,"../base-object":277,"../console":280,"./proxy/storage-global":292,"./proxy/storage-local":293,"./proxy/storage-mock":294,"core-js/modules/es6.promise":97}],296:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=o(e("./../utils/unique")),s=o(e("./../core/component"));function o(e){return e&&e.__esModule?e:{default:e}}var a=class extends s.default{constructor(e,t){super(e,t)}destroy(){delete window[this._callbackName],super.destroy()}createEl(e,t,r){let s=this.getOption("src")+"?v="+this.getPlayer().version,o=this.getOption("quality","high"),a=this.getOption("bgcolor","#000000"),n=this.getOption("wmode","opaque"),l=this.getOption("flashvars",""),d="";if(d+="<object>",d+=`<param name="quality" value="${o}">`,d+=`<param name="bgcolor" value="${a}">`,d+='<param name="allowscriptaccess" value="always">',d+=`<param name="allowfullscreen" value="${this.getOption("allowfullscreen","true")}">`,d+=`<param name="wmode" value="${n}">`,d+='<param name="hasPriority" value="true">',this._options.listener){let e=(0,i.default)("mvflveventlistener");window[e]=this._options.listener,l+=(l?"&":"")+`${this._options.loadMethod}=${e}`,this._callbackName=e}return l&&(d+=`<param name="flashvars" value="${l}">`),d+="</object>",super.createEl(d,{},{type:"application/x-shockwave-flash",data:s,style:this._createCSSStylesString()}),d}_createCSSStylesString(){let e=[];return this.getOption("visible")?(e.push("display:block !important"),e.push("width:100%"),e.push("height:100%")):e.push("height:0","width:0"),e.join(";")}};r.default=a},{"./../core/component":279,"./../utils/unique":337}],297:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.regexp.replace");var i,s=(i=e("../locales/en"))&&i.__esModule?i:{default:i};function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let a={ru:{}},n=function(e,t){return t||(t=function(){let e,t=window.navigator;try{let r=t.languages;for(let t=0;t<r.length;t++)if(e=r[t].replace(/(.*)-.*/,"$1"),r.hasOwnProperty(e))return e}catch(e){}return e=(e=t.userLanguage||t.language).replace(/(.*)-.*/,"$1"),a.hasOwnProperty(e)?e:"en"}()),t&&void 0!==a[t]&&a[t][e]?a[t][e]:e};n.addLang=function(e,t){a[e]=o(a[e]||{},t)},n.addLang("en",s.default);var l=n;r.default=l},{"../locales/en":308,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.regexp.replace":102}],298:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=l(e("../core/base-object")),s=l(e("./swf")),o=l(e("../env/index")),a=l(e("../utils/dom")),n=l(e("../core/console"));function l(e){return e&&e.__esModule?e:{default:e}}const d=1,u=0,c=-1,h=.7;var p=class extends i.default{constructor(e,t={}){super(e,t),this._player=e,this._frameVisible=c,this._documentHidden=!1,this._visible=!0,this._fullDetectionSupport=!1,this._fullDetectionMethod="",this.THRESHOLD=this.getOption("threshold",h),this.THRESHOLD_PERCENT=`${100*this.THRESHOLD}%`}init(){return(0,a.default)(document).on("visibilitychange",this._onVisibilityChange,this),this._onVisibilityChange(),this._initIntersectionObserver().catch(()=>this._initMozilla_mozInnerScreenY()).catch(()=>this._initIE()).catch(()=>this._initFlash()).then(e=>(this._fullDetectionSupport=!0,this._fullDetectionMethod=e,n.default.info(`Visibility detect success [${e}]`),!0)).catch(()=>(n.default.warn("Visibility detect fail"),!0))}_onVisibilityChange(){this.documentHidden=document.hidden}_testIE(){if(!document.elementFromPoint)return Promise.reject();let e=(0,a.default)("<iframe>"),t=e[0],r=(0,a.default)(document.body);e.css({width:"10px",height:"10px",border:0,position:"absolute",top:"-30px",left:"-30px"}),t.src="javascript:false",r.append(e);let i=t.contentWindow,s=i.document;return s.open().write('<body style="width: 10px; height: 10px;margin: 0; padding: 0;">\n<script>\nfunction test() {\n    \n    if (!document.body) {\n        throw new Error();\n    }\n    \n    return document.elementFromPoint(1, 1) === null;\n}\n<\/script>\n</body>'),s.close(),new Promise((t,r)=>{let s=0,o=()=>{try{i.test()?t():r(),e.remove()}catch(e){s++<5?setTimeout(o,100):r()}};setTimeout(o,100)})}_initIE(){return this._testIE().then(()=>{let e;function t(e,t){return null!==document.elementFromPoint(e,t)}return(e=(()=>{let r=window.innerHeight,i=window.innerWidth,s=this.THRESHOLD,o=r*(1-s),a=i*(1-s),n=t(i*s,r*s),l=t(a,o),c=s<h?n||l:n&&l;this.frameVisible=c?d:u,setTimeout(e,500)}))(),"IE"})}_createMozFrame(){let e=document.createElement("iframe"),t=(0,a.default)(e);return e.width=1,e.height=1,e.frameBorder=0,t.css({position:"absolute",zIndex:-99999}),e.src='javascript: window.isInViewArea = undefined; window.wasInViewArea = false; window.isInView = undefined; window.wasViewed = false; window.started = false; window.isVisible = function() { return window.isInView; }; window.setVisibilityCallback = function(cb) { window.visibilityCallback = cb;}; window.setVisibility = function(value) { window.isInView = value;if (window.visibilityCallback) {window.visibilityCallback(value);}}; var cnt = 0; setTimeout(function() {var span = document.createElement("span");document.body.insertBefore(span, document.body.firstChild);function updateVisibility() { span.innerHTML = window.mozPaintCount > cnt ? "In View" : "Out of View";var paintCount = window.mozPaintCount; window.setVisibility(paintCount>cnt); cnt = paintCount; if (window.started === false) {window.started = true;}}setInterval(updateVisibility, 50);updateVisibility();},0)',document.body.insertBefore(e,document.body.firstChild),t}_createTestAnimationFrame(e,t,r=!0){let i=(0,a.default)("<iframe>");return i.css({width:"10px",height:"10px",border:0,position:"absolute",zIndex:-1e4}),r?i.css({left:e,top:t}):i.css({right:e,bottom:t}),i[0].src="javascript:\n        \n        var request = window.requestAnimationFrame \n                || window.mozRequestAnimationFrame \n                || window.webkitRequestAnimationFrame \n                || window.msRequestAnimationFrame\n                || window.setTimeout,\n            cancel = window.cancelAnimationFrame\n                || window.mozCancelAnimationFrame \n                || window.webkitCancelAnimationFrame \n                || window.msCancelAnimationFrame\n                || window.clearTimeout,\n            visible = false,\n            count = 0,\n            lastValues = [],\n            sum = 0;\n\n        function test() { \n        \n            var start = new Date(),\n                done = false;\n                t = setTimeout(function() {\n                    if (done) {\n                        return;\n                    }\n                    cancel(rt);\n                    next(false);\n                }, 150),\n                rt = request(function() { \n                    if (done) {\n                        return;\n                    }\n                    clearTimeout(t);\n                    next(true);\n                }); \n                \n            function next(val) {\n                sum += new Date() - start;\n                lastValues.push(new Date() - start);\n                if (lastValues.length === 4) {\n                    visible = (sum / 4) < 100;\n                    lastValues = [];\n                    sum = 0;\n                }\n                done = true;\n                setTimeout(test, 50);\n            }\n        }\n        \n        function isVisible() {\n            return visible;\n        }\n        \n        test();",(0,a.default)(document.body).append(i),i}_testAnimationFrame(){if(!window.requestAnimationFrame)return Promise.reject();let e=this._createTestAnimationFrame("-300px","-300px"),t=e[0].contentWindow;return new Promise((r,i)=>{setTimeout(function(){t.isVisible()?(i(),e.remove()):r(e)},1e3)})}_initAnimationFrame(){return this._testAnimationFrame().then(e=>{let t=this.THRESHOLD_PERCENT,r=this.THRESHOLD;e.css({left:t,top:t});let i=this._createTestAnimationFrame(t,t,!1)[0].contentWindow,s=e[0].contentWindow;return setInterval(()=>{try{let e=s.isVisible(),t=i.isVisible(),o=r<h?e||t:e&&t;this.frameVisible=o?d:u}catch(e){this.frameVisible=c}},100),"AnimationFrame"})}_initMozilla_mozPaintCount(){if(!window.hasOwnProperty("mozPaintCount"))return Promise.reject();let e=this._createMozFrame(),t=this._createMozFrame(),r=this.THRESHOLD,i=this.THRESHOLD_PERCENT;return e.css({left:i,top:i}),t.css({right:i,bottom:i}),new Promise((i,s)=>{setTimeout(()=>{let s,o=e[0].contentWindow,a=t[0].contentWindow,n=!1,l=!1;s=(()=>{let e=r<h?n||l:n&&l;this.frameVisible=e?d:u}),o.setVisibilityCallback(e=>{n=e,s()}),a.setVisibilityCallback(e=>{l=e,s()}),s(),i("Mozilla mozPaintCount")},0)})}_initMozilla_mozInnerScreenY(){let e;return window.hasOwnProperty("mozInnerScreenY")?((e=(()=>{let t=window.innerHeight*this.THRESHOLD,r=window.screen.height,i=window.mozInnerScreenY;this.frameVisible=i<r-t&&i>-t?d:u,setTimeout(e,100)}))(),Promise.resolve("Mozilla mozInnerScreenY")):Promise.reject()}_initIntersectionObserver(){if(!window.IntersectionObserver)return Promise.reject();this.frameVisible=u;let e=this.THRESHOLD;return new IntersectionObserver(t=>{t[0].intersectionRatio>=e?this.frameVisible=d:this.frameVisible=u},{threshold:[e]}).observe(this.getPlayer().getEl()[0]),Promise.resolve("IntersectionObserver")}_createFlashBeacon(){let e=this.getPlayer(),t=new s.default(e,{src:e.path+"/swf/beacon.swf",bgcolor:"#ff0000",wmode:"transparent",allowFullScreen:"false",quality:"low",visible:!0}),r=t.getEl();return r.css({position:"absolute",width:"1px",height:"1px",zIndex:-99999}),e.addChild(t),r}_initFlash(){if(!o.default.hasFlash)return Promise.reject();let e,t=this._createFlashBeacon(),r=this._createFlashBeacon(),i=this.THRESHOLD_PERCENT,s=this.THRESHOLD,a=t[0],n=r[0];t.css({top:"-100px",left:i}),r.css({bottom:"-100px",right:i});let l=()=>{try{let e=a.isViewable(),t=n.isViewable(),r=s<h?e||t:e&&t;this.frameVisible=r?d:u}catch(e){this.frameVisible=c}};return e=(()=>{l(),setTimeout(e,500)}),new Promise((s,o)=>{let l,d,u=0;l=(()=>{try{a.isViewable(),n.isViewable(),d()}catch(e){u++<20?setTimeout(l,50):o()}}),d=(()=>{a.isViewable()||n.isViewable()?o():(t.css({top:i}),r.css({bottom:i}),e(),setTimeout(function(){s("Flash")},1e3))}),l()})}_updateVisibility(){let e=!this._documentHidden;if(e)switch(this._frameVisible){case u:e=!1;break;case d:e=!0;break;case c:e=this.getPlayer().getOption("visibleIfUnknown",!0)}let t=this._visible!==e;if(this._visible=e,t){n.default.log("Visibility: ",e);let t=this.getPlayer();t.trigger("visibilityChange",{visible:e}),t.trigger(e?"visible":"invisible")}}set documentHidden(e){this._documentHidden=e,this._updateVisibility()}set frameVisible(e){this._frameVisible=e,this._updateVisibility()}get visible(){return this._visible}get fullDetectionSupport(){return this._fullDetectionSupport}get fullDetectionMethod(){return this._fullDetectionMethod}};r.default=p},{"../core/base-object":277,"../core/console":280,"../env/index":306,"../utils/dom":328,"./swf":296,"core-js/modules/es6.promise":97}],299:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.VolumeControllerEventData=r.TYPES=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.regexp.split");var i=a(e("./events")),s=a(e("./console")),o=e("../utils/math");function a(e){return e&&e.__esModule?e:{default:e}}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){d(e,t,r[t])})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const u={player:"player"};r.TYPES=u;class c{constructor(e={}){this.type=void 0,this.volume=void 0,this.oldVolume=void 0,this.muted=void 0,this.oldMuted=void 0,this.setAttributes(e)}setAttributes(e={}){e&&("type"in e&&null!==e.type&&(this.type=e.type),"volume"in e&&void 0!==e.volume&&null!==e.volume&&(this.volume=e.volume),"oldVolume"in e&&void 0!==e.oldVolume&&null!==e.oldVolume&&(this.oldVolume=e.oldVolume),"muted"in e&&void 0!==e.muted&&null!==e.muted&&(this.muted=e.muted),"oldMuted"in e&&void 0!==e.oldMuted&&null!==e.oldMuted&&(this.oldMuted=e.oldMuted))}}r.VolumeControllerEventData=c;const h="VolumeController:";function p(e,t){const r=e.indexOf(t);e.splice(r,1)}class _{constructor(e={}){this._volume={},this._muted={},this._type=void 0,this._detectTypeRules=[],this.debug=!0,this.loggableMethods=["setVolume","setMuted","setCurrentType"],this._triggerQueue=[],this._triggerTimer=null,this._volume[u.player]=this._fixVolumeValue("volume"in e?e.volume:.8),this._muted[u.player]="muted"in e?!!e.muted:this._volume[u.player]<=0,this._type=[u.player],this._triggerFromQueue=this._triggerFromQueue.bind(this)}addType(e,t,r){e in u||(u[e]=e,this._volume[e]=t||this._volume[u.player],this._muted[e]=r||this._muted[u.player])}addDetectTypeRule(e){this._detectTypeRules.push(e)}_detectTypeByTarget(e=null){if("string"==typeof e&&e in u)return e;let t=null;for(let r of this._detectTypeRules)r&&"function"==typeof r&&(t=r(e));return t=this._fixType(t)}_checkType(e){return!!e&&(!!(e&&"string"==typeof e&&e in u)||this._getRealType(e)in u)}_getRealType(e=this.currentType){let t=e.split(":");return t&&t.length>1?t[0]:e}_getVolume(e=this.currentType){if(void 0===this._volume[e])throw new Error("VolumeController incorrect volume type");return this._volume[e]}_setVolume(e,t=this.currentType){return this._volume[t]!==e&&(this._volume[t]=e,!0)}_getMuted(e=this.currentType){if(void 0===this._muted[e])throw new Error("VolumeController incorrect volume type");return this._muted[e]}_setMuted(e,t=this.currentType){return this._muted[t]!==e&&(this._muted[t]=e,!0)}_fixVolumeValue(e){const t=(0,o.betweenZeroAndOne)((e=>parseFloat(e.toFixed(2)))(e));return isNaN(t)?0:t}_fixType(e=null,t=null){return t||(t=e),this._checkType(e)?e:t?this._detectTypeByTarget(t):this.currentType}_setCurrentType(e,t=!0){let r=this.currentType;if(r!==e){let i=this.getVolume(r),s=this.getMuted(r);if(e===u.player?this._type=[e]:this._type.push(e),this.currentTypeIsCustom){let t=this._getRealType();t in u&&(this._volume[e]=this._volume[t],this._muted[e]=this._muted[t])}this.trigger("typeChange",{newType:e,oldType:r}),t&&this._triggerVolumeChangeEvent({oldVolume:i,oldMuted:s})}}_cancelCurrentType(e,t=!0){let r=this.currentType,i=this._getRealType(this.currentType),s=this._getRealType(e);if(i===s){this._type.pop();let e=this.getVolume(r),o=this.getMuted(r);for(let e in this._type){this._getRealType(e)===s&&(p(this._type,e),delete this._volume[e],delete this._muted[e])}this.trigger("typeChange",{newType:this.currentType,oldType:i}),t&&this._triggerVolumeChangeEvent({oldMuted:o,oldVolume:e})}}_triggerVolumeChangeEvent(e={}){let t=new c(e);t.type=this.currentType,t.volume=this._getVolume(),t.muted=this._getMuted(),this._log("_triggerVolumeChangeEvent",t),this._triggerQueue.push(["volumeChange",t]),this._triggerTimer&&clearTimeout(this._triggerTimer),this._triggerTimer=setTimeout(this._triggerFromQueue,50)}_triggerFromQueue(){if(this._triggerTimer&&clearTimeout(this._triggerTimer),this._triggerTimer=null,0===this._triggerQueue.length)return;let e=new c;for(let t of this._triggerQueue){let r=t[0],i=t[1];"volumeChange"===r?e.setAttributes(i):this.trigger(r,i)}delete this._triggerQueue,this._triggerQueue=[],e&&(this._log("_triggerFromQueue",e),this.trigger("volumeChange",e)),e=null}get queueLength(){return this._triggerQueue.length}clearEventsQueue(){this._triggerTimer&&clearTimeout(this._triggerTimer),this._triggerTimer=null,this._triggerQueue=[]}flushEventsQueue(){this._triggerTimer&&clearTimeout(this._triggerTimer),this._triggerTimer=null,this._triggerFromQueue()}getVolume(e=this.currentType,t=null){const r=this._getVolume(this._fixType(e,t));return this._log("getVolume",l({},arguments),r),r}setVolume(e,t=null,r=!0,i=null){this._log("setVolume",l({},arguments));let s=!1;t=this._fixType(t,i);let o=this.currentType,a=this._fixVolumeValue(e),n=this._getVolume(t);if(a!==n){this._setVolume(a,t)&&(s=!0)}o!==t&&r&&(this._setCurrentType(t,!1),s=!0),s&&this._triggerVolumeChangeEvent({oldVolume:n})}getMuted(e=null,t=null){const r=this._getMuted(this._fixType(e,t));return this._log("getMuted",l({},arguments),r),r}setMuted(e,t=null,r=!0,i=null){this._log("setMuted",l({},arguments));let s=!1;t=this._fixType(t,i);let o=this.currentType,a=!!e,n=this._getMuted(t);if(a!==n){this._setMuted(a,t)&&(s=!0)}o!==t&&r&&(this._setCurrentType(t,!1),s=!0),s&&this._triggerVolumeChangeEvent({oldMuted:n})}get currentType(){return this._type.length<=0&&this._type.push(u.player),this._type[this._type.length-1]}setCurrentType(e,t=null){e=this._fixType(e,t),this._log("setCurrentType",l({},arguments),e),this._setCurrentType(e)}cancelCurrentType(e,t=null){this._log("cancelCurrentType",l({},arguments)),e=this._fixType(e,t),this._cancelCurrentType(e)}get currentTypeIsCustom(){return this.currentType.indexOf(":")>=0}_log(e,...t){this.debug&&(!1===this.loggableMethods||this.loggableMethods.indexOf(e)>=0)&&s.default.log.apply(s.default,[h,e].concat(t,[{volume:this._volume,muted:this._muted,type:this._type}]))}}n(_.prototype,i.default);var g=_;r.default=g},{"../utils/math":332,"./console":280,"./events":283,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.regexp.split":104,"core-js/modules/web.dom.iterable":115}],300:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.silentAutoplay=r.default=void 0,e("core-js/modules/es6.promise");var i=s(e("../core/console"));e("./autoplay/webm-beacon"),e("./autoplay/mp4-beacon"),s(e("./browser")),s(e("./mobile-detect"));function s(e){return e&&e.__esModule?e:{default:e}}function o(e){let t=new Date-0;function r(...r){let s=new Date-t;e=e?"-muted":"";const o=Array.isArray(r)?r.shift():"";i.default.log.apply(i.default,[`Env[Autoplay${e}] (${s} ms): ${o}`].concat(r))}return r("пробуем распознать поддержку..."),new Promise((t,i)=>e?(r("поддерживается (DEV-672)"),void t()):(r("не поддерживается (DEV-585)"),void i()))}var a=o();r.default=a;const n=o(!0);r.silentAutoplay=n},{"../core/console":280,"./autoplay/mp4-beacon":301,"./autoplay/webm-beacon":302,"./browser":303,"./mobile-detect":307,"core-js/modules/es6.promise":97}],301:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.beaconMp4=void 0;r.beaconMp4="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAABMRtZGF03gQAAGxpYmZhYWMgMS4yOAAAQgCTIAQyAEcAAAKABgX//3zcRem95tlIt5Ys2CDZI+7veDI2NCAtIGNvcmUgMTQyIHIyNDMxIGE1ODMxYWEgLSBILjI2NC9NUEVHLTQgQVZDIGNvZGVjIC0gQ29weWxlZnQgMjAwMy0yMDE0IC0gaHR0cDovL3d3dy52aWRlb2xhbi5vcmcveDI2NC5odG1sIC0gb3B0aW9uczogY2FiYWM9MCByZWY9MyBkZWJsb2NrPTE6MDowIGFuYWx5c2U9MHgxOjB4MTExIG1lPWhleCBzdWJtZT03IHBzeT0xIHBzeV9yZD0xLjAwOjAuMDAgbWl4ZWRfcmVmPTEgbWVfcmFuZ2U9MTYgY2hyb21hX21lPTEgdHJlbGxpcz0xIDh4OGRjdD0wIGNxbT0wIGRlYWR6b25lPTIxLDExIGZhc3RfcHNraXA9MSBjaHJvbWFfcXBfb2Zmc2V0PS0yIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTAgd2VpZ2h0cD0wIGtleWludD0yNTAga2V5aW50X21pbj0xNSBzY2VuZWN1dD00MCBpbnRyYV9yZWZyZXNoPTAgcmNfbG9va2FoZWFkPTQwIHJjPWFiciBtYnRyZWU9MSBiaXRyYXRlPTEwMCByYXRldG9sPTEuMCBxY29tcD0wLjYwIHFwbWluPTAgcXBtYXg9NjkgcXBzdGVwPTQgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAA5liIQGv///D0UAAVa/gCEASZACGQAjgCEASZACGQAjgCEASZACGQAjgAAAAAZBmjgNeoAhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpUA16gIQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGaYBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGagBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGaoBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGawBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGa4Br1IQBJkAIZACOAIQBJkAIZACOAAAAABUGbABr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGbIBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGbQBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGbYBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGbgBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGboBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAABUGbwBr1IQBJkAIZACOAIQBJkAIZACOAIQBJkAIZACOAAAAGhm1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAQAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAKwdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAPoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAccccAEAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAD6AAAAAAAAQAAAAACKG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAPAAAADwAFccAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAdNtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAGTc3RibAAAAKdzdHNkAAAAAAAAAAEAAACXYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAQABAASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAULAHv/hABpnQsAe2R7/wAQAAkQAAAMABAAAAwB4PFi5IAEABGjLjLIAAAAQcGFzcAAAABAAAAAJAAAAGHN0dHMAAAAAAAAAAQAAAA8AAAQAAAAAFHN0c3MAAAAAAAAAAQAAAAEAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAUHN0c3oAAAAAAAAAAAAAAA8AAAKWAAAACgAAAAoAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAABMc3RjbwAAAAAAAAAPAAAASgAAAvsAAAMgAAADRQAAA2kAAAONAAADsQAAA9UAAAPwAAAEFAAABDgAAARcAAAEgAAABKQAAATIAAADAHRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAEAAAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAA+gAAAQAAAEAAAAAAnhtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAACwRBXHAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAIjbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAHnc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAD6AAAAM4wWAgIACEhAGgICAAQIAAAAgc3R0cwAAAAAAAAACAAAALAAABAAAAAABAAAARAAAAEBzdHNjAAAAAAAAAAQAAAABAAAAAQAAAAEAAAACAAAAAwAAAAEAAAAJAAAAAgAAAAEAAAAKAAAAAwAAAAEAAADIc3RzegAAAAAAAAAAAAAALQAAABoAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAFBzdGNvAAAAAAAAABAAAAAwAAAC4AAAAwUAAAMqAAADTgAAA3IAAAOWAAADugAAA94AAAP5AAAEHQAABEEAAARlAAAEiQAABK0AAATRAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni4yNi4xMDE="},{}],302:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.beaconWebm=void 0;r.beaconWebm="data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAUDxFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghPy7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU3LjQxLjEwMFdBjUxhdmY1Ny40MS4xMDBzpJDorVMHpVpzk4I7dLd/+XxSRImIQJAEAAAAAAAWVK5rAQAAAAAAD/6uAQAAAAAAADrXgQFzxYEBnIEAIrWcg2VuZ4aFVl9WUDiDgQEj44OEA/lAquABAAAAAAAADrCBELqBEFSwgRxUuoEQrgEAAAAAAA+y14ECc8WBApyBACK1nINlbmeGiEFfVk9SQklTg4EC4QEAAAAAAAARn4ECtYhA5YiAAAAAAGJkgSBjok92Ah5dAXZvcmJpcwAAAAACRKwAAAAAAACAtQEAAAAAALgBA3ZvcmJpczQAAABBTzsgYW9UdVYgWzIwMTEwNDI0XSAoYmFzZWQgb24gWGlwaC5PcmcncyBsaWJWb3JiaXMpAQAAABUAAABlbmNvZGVyPUxhdmM1Ny40OC4xMDEBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADQDwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABkAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAACrOeBAKOFggAAgACjo4EAA4AQAgCdASoQABAAAEcIhYWIhYSIAgIADA1gAP7/qiWAo4WCAAOACqOFggAQgA6jhYIAJ4AOo4WCAD+ADqOVgQBGALEBAAEQEAAYABhYL/QACAAAo4WCAFaADqOFggBtgA6jhYIAhIAOo5WBAIgAsQEAARAQABgAGFgv9AAIAACjhYIAm4AOo4WCALOADqOFggDKgA6jlYEAywCxAQABEBAAGAAYWC/0AAgAAKOFggDhgA6jhYIA+IAOo5WBAQ4AsQEAARAQABgAGFgv9AAIAACjhYIBD4AOo4WCASeADqOFggE+gA6jlYEBUACxAQABEBAAGAAYWC/0AAgAAKOFggFVgA6jhYIBbIAOo4WCAYSADqOVgQGTALEBAAEQEAAYABhYL/QACAAAo4WCAZuADqOFggGygA6jhYIByYAOo5WBAdYAsQEAARAQFGAAYWC/0AAgAACjhYIB4IAOo4WCAfiADqOFggIPgA6jlYECGACxAQABEBAAGAAYWC/0AAgAAKOFggImgA6jhYICPYAOo4WCAlWADqOVgQJbALEBAAEQEAAYABhYL/QACAAAo4WCAmyADqOFggKDgA6jhYICmoAOo5WBAp4AsQEAARAQABgAGFgv9AAIAACjhYICsYAOo4WCAsmADqOVgQLgALEBAAEQEAAYABhYL/QACAAAo4WCAuCADqOFggL3gA6jhYIDDoAOo5WBAyMAsQEAARAQABgAGFgv9AAIAACjhYIDJoAOo4WCAz2ADqOFggNUgA6jlYEDZgCxAQABEBAAGAAYWC/0AAgAAKOFggNrgA6jhYIDgoAOo4WCA5qADqOVgQOoALEBAAEQEAAYABhYL/QACAAAo4WCA7GADqOFggPIgA6jhYID34AOo4WCA/eADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghE68IEK"},{}],303:[function(e,t,r){(function(t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.split");var i=new class{constructor(e={}){this.name=e&&void 0!==e.name?e.name:null,this.version=e&&void 0!==e.version?e.version:null,this.versionNumber=e&&void 0!==e.versionNumber?e.versionNumber:null,this.os=e&&void 0!==e.os?e.os:null,this.major=e&&void 0!==e.major?e.major:null,this.minor=e&&void 0!==e.minor?e.minor:null,this.patch=e&&void 0!==e.patch?e.patch:null,this.isOld=e&&void 0!==e.isOld?e.isOld:null,this.isBot=e&&void 0!==e.isBot?e.isBot:null}}(function(){let r=function(){return"undefined"==typeof navigator&&void 0!==t?{name:"node",version:t.version.slice(1),os:e("os").type().toLowerCase()}:null},i=function(e){let t=s();if(!e)return null;let r=t.map(function(t){const r=t.rule.exec(e);let i=r&&r[1].split(/[._]/).slice(0,3);return i&&i.length<3&&(i=i.concat(1===i.length?[0,0]:[0])),r&&{name:t.name,version:i.join("."),versionNumber:parseFloat(i),major:i&&i.length>0&&parseInt(i[0],10),minor:i&&i.length>1&&parseInt(i[1],10),patch:i&&i.length>2&&parseInt(i[2],10)}}).filter(Boolean)[0]||null;return r.os=r?function(e){let t=o().filter(function(t){return t.rule&&t.rule.test(e)})[0];return t?t.name:null}(e):"unknown",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/i.test(e)?(r=r||{}).isBot=!0:r.isBot=!1,"ie"===r.name&&r.versionNumber<10||"chrome"===r.name&&r.versionNumber<48||"firefox"===r.name&&r.versionNumber<10||"safari"===r.name&&r.versionNumber<7||"opera"===r.name&&r.versionNumber<11?r.isOld=!0:r.isOld=!1,r},s=function(){return a([["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\ ([0-9\.]+)/]])},o=function(){return a([["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]])},a=function(e){return e.map(function(e){return{name:e[0],rule:e[1]}})};return function(){let e=r();return e||("undefined"!=typeof navigator?i(navigator.userAgent):null)}()}());r.default=i}).call(this,e("_process"))},{_process:120,"core-js/modules/es6.regexp.split":104,os:119}],304:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mimeTypeSupport=r.supportMimeTypes=void 0;var i=e("../utils/video"),s=e("./flash-detect");const o={"application/javascript":!0};r.supportMimeTypes=o,s.hasFlash&&(o["video/x-flv"]=!0,o["application/x-shockwave-flash"]=!0);let a=["video/webm","video/mp4"];for(let e=0;e<a.length;e++){let t=a[e];o[t]=(0,i.canPlayType)(t)}r.mimeTypeSupport=function(e){return o.hasOwnProperty(e)}},{"../utils/video":339,"./flash-detect":305}],305:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.hasFlash=void 0,e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.regexp.replace");let i,s=navigator,o=window,a=[0,0,0];if(void 0!==s.plugins&&"object"==typeof s.plugins["Shockwave Flash"])(i=s.plugins["Shockwave Flash"].description)&&void 0!==s.mimeTypes&&s.mimeTypes["application/x-shockwave-flash"]&&s.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(i.replace(/^(.*)\..*$/,"$1")),a[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(void 0!==o.ActiveXObject)try{let e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");e&&(i=e.GetVariable("$version"))&&(i=i.split(" ")[1].split(","),a=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2])])}catch(e){}const n=a[0]>0;r.hasFlash=n;var l=a;r.default=l},{"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104}],306:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setDeviceInfo=function(e){if(!e)return;let t=e.os,r={type:e.browser.type,name:e.browser.type.toLowerCase(),version:e.browser.version.split(".").shift(),fullVersion:e.browser.version};r.fullName=`${r.type} ${r.version}`,h.browser=r,h.os=t,o.default.log(`Browser: ${r.fullName}`),o.default.log(`OS: ${t.name}`)},r.default=void 0,e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.promise"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.regexp.match");var i=a(e("./flash-detect")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./autoplay")),o=a(e("../core/console"));function a(e){return e&&e.__esModule?e:{default:e}}let n=/hp-tablet/gi.test(navigator.appVersion),l="ontouchstart"in window&&!n,d=screen.width,u=screen.height,c="pc";u>d&&(d=[u,u=d][0]),l&&(d<768?c="mobile":d<1600&&(c="tablet"));const h={adBlock:!1,hasTouch:l,hasFlash:i.default[0]>0,flashVersion:i.default,isVolumeControl:!/(iPad|iPhone|iPod)/g.test(navigator.userAgent),isBot:/(phantomjs)|(bot)|(slurp)|(ia_archiver)|(spider)|(zeus \d+)/.test(navigator.userAgent.toLowerCase()),type:c,platform:"",width:d,height:u,autoPlay:!1,silentAutoplay:!1,adSilentAutoplayAlways:!0,inlineVideo:!navigator.userAgent.match(/(iPhone|iPod)/g)||"playsInline"in document.createElement("video"),pointerEvents:"pointer-events"in document.head.style,browser:{type:"unknown",name:"unknown",version:"unknown",fullVersion:"unknown",fullName:"unknown"},os:{type:"unknown",name:"unknown",version:"unknown"}};h.ready=Promise.all([s.default.then(()=>{h.autoPlay=!0},()=>Promise.resolve()),s.silentAutoplay.then(()=>{h.silentAutoplay=!0},()=>Promise.resolve())]);let p=navigator.userAgent.match(/(iPad|iPhone|iPod|Android|Windows Phone)/);h.platform=p?p[0]:l?"mobile":"pc";var _=h;r.default=_},{"../core/console":280,"./autoplay":300,"./flash-detect":305,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.split":104,"core-js/modules/web.dom.iterable":115}],307:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(i.substr(0,4)));r.default=s},{}],308:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i={"с":"s","Пропустить через":"Skip in","Пропустить рекламу":"Skip this ads","Поделиться":"Share","Нажмите для продолжения просмотра":"Tap to continue watching","Выключить звук":"Turn off","Включить звук":"Turn on"};r.default=i},{}],309:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./../core/plugin"))&&i.__esModule?i:{default:i};class o extends s.default{constructor(e,t){super(e,t),this.getOption("id")&&this.listenToOnce(e,"start",this._setCounter)}_setCounter(){let e=document.createElement("img");e.width=31,e.height=31,e.alt="",e.title="LiveInternet",e.border=0,e.style.display="none";let t="//counter.yadro.ru/hit;"+this.getOption("id")+"?t44.6";t=t+";r"+encodeURIComponent(document.referrer)+("undefined"==typeof screen?"":";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?screen.colorDepth:screen.pixelDepth))+";u"+encodeURIComponent(document.URL)+";"+Math.random();let r=document.createElement("a");r.href="http://www.liveinternet.ru/click;"+this.getOption("id"),r.target="_blank",r.appendChild(e),document.body.appendChild(r),e.src=t}}s.default.register("li",o);var a=o;r.default=a},{"./../core/plugin":289}],310:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LogPluginDefault=void 0;var i=c(e("../../core/plugin")),s=c(e("../../core/media-container")),o=c(e("../../utils/dom")),a=c(e("./log-panel")),n=c(e("../../utils/url")),l=c(e("../../env/index")),d=c(e("../../core/console")),u=c(e("../../utils/catchHandler"));function c(e){return e&&e.__esModule?e:{default:e}}r.LogPluginDefault=class extends i.default{get availableForUser(){return this.getOption("availableForUser")}constructor(e,t){super(e,t);let r=this.getOption("showLastLog"),i=this.getPlayer().ns,s=this._logPanel=new a.default(e,{autoInit:!r,createEl:!0,domain:this.getOption("domain"),video:this.getOption("video"),env:this.getOption("env")});e.addToRoot(this._logPanel),this._$button=(0,o.default)(`<button class="${i}-log-showButton">Показать лог</button>`),l.default.hasTouch&&this.availableForUser&&(e.getEl().append(this._$button),this._$button.on("click",this._tooglePanel,this));let n=s.getEl()[0],d=e.getStorage();if(r){let t=this.getOption("logContent");if(t)n.innerHTML=t,s.init();else{let t=()=>{this._setPanelVisibility(!0),d.ready().then(()=>{d.getItem("__MV_PLUGIN_LOG_DATA").then(e=>{n.innerHTML=e,s.init()}).catch(e=>(0,u.default)(e))}).catch(e=>(0,u.default)(e))};e.isReady()?t():e.on("ready",t)}return}s.init(),this.listenTo(e,{create:this._onCreate,error:this._onError,inventoryLog:this._onInventoryLog,adStatSend:this._onAdStatSend,log:this._onLog,adLog:this._onAdLog,adWrapperLoading:this._onAdWrapperLoading,adSlotLog:this._onAdSlotLog,adPositionCount:this._onAdPositionCount,AdStartGlobalTimeout:this._onAdGlobalTimeout}),this.getOption("saveToStorage",!0)&&this.listenTo(e,{"create error inventoryLog adStatSend log adLog adWrapperLoading adSlotLog adPositionCount":()=>{d.ready().then(()=>{d.setItem("__MV_PLUGIN_LOG_DATA",n.innerHTML).catch(e=>(0,u.default)(e))}).catch(e=>(0,u.default)(e))}});let c=["_onCreate","_onError","_onInventoryLog","_onAdStatSend","_onLog","_onAdLog","_onAdWrapperLoading","_onAdSlotLog","_onAdPositionCount"];for(let e=0;e<c.length;e++)(t=>{this[c[e]]=(()=>{let e=arguments;setTimeout(()=>{t.apply(this,e)},0)})})(c[e]);this._setPanelVisibility(!1),this.availableForUser&&((0,o.default)(window).on("keyup",e=>{17===(e=e.originalEvent).keyCode&&this._tooglePanel()}),e.debug&&this._setPanelVisibility(!0))}save(){return this._log("Сохранение лога"),post("log/save",{log:this._logPanel.getEl()[0].innerHTML})}_tooglePanel(){this._setPanelVisibility(!this._panelVisible)}_setPanelVisibility(e){e?(this._logPanel.show(),this._$button.text("Скрыть лог")):(this._logPanel.hide(),this._$button.text("Показать лог")),this._panelVisible=e}_onCreate(e){let t=e.item;t instanceof s.default&&t.getOption("adId")&&this._listenMediaContainer(t)}get _logEnabled(){return!this.getOption("showLastLog")}_log(e,t=!1,r=!1){(this._logEnabled||r)&&this._logPanel.log(e,t)}_listenMediaContainer(e){let t=e.getAdId(),r=e.getAdSlot(),i=e.getAdSlotId(),s=(e,s)=>{this._logAd({id:t,slotId:i,slot:r,type:"Общее",time:new Date,action:e,isError:s})};this.listenTo(e,{start:()=>{s("Начало воспроизведения")},finish:()=>{s("Окончание воспроизведения")},skip:()=>{s("Пропуск видео")},error:e=>{s(this._generateMessageFromError(e,"item"),!0)}})}_generateMessageFromError(e,t=""){d.default.error(e);let r="Ошибка";return e?("object"==typeof e.message&&"code"in e.message&&"message"in e.message&&(e=e.message),e.code&&(r+=` ${e.code}`),e.message&&(r+=` (${"object"==typeof e.message?JSON.stringify(e.message):e.message})`)):r+=" Empty",t&&(r+=` [${t}]`),r}_onLog(e){this._log(e.message,e.isError)}_onError(e){this._log(this._generateMessageFromError(e.message,"player"),!0)}_onInventoryLog(e){this._logEnabled&&this._logPanel.logInventory(e)}_onAdStatSend(e){this._logAd({id:e.adId,slotId:e.slotId,slot:e.slot,type:"Общее",time:new Date,action:`Отправка статистики: ${e.event}`})}_onAdLog(e){this._logAd({id:e.adId,slotId:e.slotId,slot:e.slot,type:e.type||"Общее",time:new Date,action:e.action,isError:e.isError})}_onAdSlotLog(e){this._logEnabled&&this._logPanel.logAdSlot(e)}_onAdGlobalTimeout(e){this._logEnabled&&this._logPanel.logAdSlot({slot:e.slot,action:"Глобальный таймаут",isError:!0})}_onAdPositionCount(e){this._logEnabled&&this._logPanel.setPositionCount(e.position,e.count,e.blocks)}_onAdWrapperLoading(e){let t=e.info,r=(t.end-t.start)/1e3,i=t.action,s=t.url,a=n.default.getHostname(s),l=`<span title="${o.default.escape(s)}">${o.default.escape(a)}</span>`,d=t.code,u=t.message||"",c=t.adId,h=t.slotId,p=t.slot;this._logAd({id:c,slotId:h,slot:p,type:"Wrapper",domain:l,code:d,message:u,action:{requestStart:"Начало загрузки",requestSuccess:"Успешно загружен",requestFail:"Не удалось загрузить",parseSuccess:"Контент успешно получен",parseFail:"Не удалось извлечь контент"}[i],time:r,isError:d||u})}_logAd(e){this._logEnabled&&this._logPanel.logAd(e)}}},{"../../core/console":280,"../../core/media-container":287,"../../core/plugin":289,"../../env/index":306,"../../utils/catchHandler":327,"../../utils/dom":328,"../../utils/url":338,"./log-panel":311}],311:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es7.object.values"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/web.dom.iterable");var i=d(e("../../utils/dom")),s=d(e("../../core/component")),o=e("./log-panel.row.tpl"),a=e("./log-panel.tpl"),n=d(e("../../utils/url")),l=d(e("../../utils/catchHandler"));function d(e){return e&&e.__esModule?e:{default:e}}const u=0,c=1,h=2;var p=class extends s.default{constructor(e,t){if(super(e,t||{}),this._adDivs={},this._positions={},!this.getOption("autoInit"))return;let r=this.getEl();this._$envInfo=r.nsFind("log-info","env"),this._$playerInfo=r.nsFind("log-info","player"),this._$domainInfo=r.nsFind("log-info","domain"),this._$videoInfo=r.nsFind("log-info","video"),this._$adInfo=r.nsFind("log-info","ad"),this._$log=r.nsFind("log-info","log"),this._initAdInfo(),this._initEnvInfo(),this._initPlayerInfo(),this._initDomainInfo(),this._initVideoInfo()}init(){let e=this.getEl();this._$clearStorage=e.nsFind("log-info","clearStorage"),this._$clearStorage.on("click",()=>{this.getPlayer().getStorage().clear()}),this._$saveUrl=e.nsFind("log-info","url"),this._$saveBtn=e.nsFind("log-info","save"),this._$saveBtn.on("click",()=>{this.trigger("needSave")}),setTimeout(()=>{e.on("mousedown",t=>{if(t.originalEvent&&t.originalEvent.target){if(t.originalEvent.target.dataset.adid){const r=t.originalEvent.target,i=r.dataset.adid,s=r.classList.contains("__sel"),o=r.classList.contains("__sel_1")||r.classList.contains("__sel_2")||r.classList.contains("__sel_3"),a=e[0].querySelectorAll(`[data-adid="${i}"]`),n=t.originalEvent.ctrlKey,l=t.originalEvent.shiftKey,d=n&&l?3:n?1:l?2:0;return a.forEach(e=>{s?(e.classList.remove("__sel","__sel_1","__sel_2","__sel_3"),d&&o&&(e.classList.add("__sel"),d&&e.classList.add("__sel_"+d))):(e.classList.add("__sel"),d&&e.classList.add("__sel_"+d))}),l&&window.getSelection().removeAllRanges(),t.originalEvent.stopPropagation(),t.originalEvent.preventDefault(),!1}let r=t.originalEvent.target.closest(".mv-log-ad-common-row")||t.originalEvent.target.closest(".mv-log-ad-wrapper-row");if(r)return r.classList.toggle("__hover"),!1}})},500)}setUrl(e){this._$saveUrl.text(e)}_initEnvInfo(){let e=this.getOption("env");this._setInfo(this._$envInfo,[{label:"IP",value:void 0!==e.ip?e.ip:""},{label:"Страна",value:e.country},{label:"Устройство",value:e.device}])}_initPlayerInfo(){let e=this._setInfo(this._$playerInfo,[{label:"Размер",value:""},{label:"Домен",value:n.default.getHostname(this.getPlayer().path)},{label:"Версия",value:this.getPlayer().version},{label:"Хранилище",value:""}]),t=this.getPlayer(),r=e[0].nsFind("log-value"),i=e[3].nsFind("log-value");this.getPlayer().getStorage().ready().then(e=>{i.text(e.type)}).catch(e=>(0,l.default)(e)),function e(){let i=t.width,s=t.height,o="green";i<320||s<240?o="red":(i<640||s<480)&&(o="orange"),r.text(`${i}x${s}`),r.css("color",o),setTimeout(e,1e3)}()}_initAdInfo(){let e=this._setInfo(this._$adInfo,[{label:"Позиции",value:""}]);this._$positionsInfo=e[0].nsFind("log-value")}_initDomainInfo(){let e=this.getOption("domain")||{},t=e.pins,r=e.assort instanceof Array?e.assort.join(", "):"";this._setInfo(this._$domainInfo,[{label:"Домен",value:e.ref},{label:"Тип",value:e.type,type:"UNKNOWN"===e.type?"error":""},{label:"Ассортимент",value:r||"Не указан",type:r?"":"error"},{label:"PIN (video)",value:t[u]},{label:"PIN (traffic)",value:t[c]},{label:"PIN (domain)",value:t[h]}])}_initVideoInfo(){let e=this.getOption("video"),t={0:"Не модерирован",1:"Нормальный",2:"Порно",3:"18+",97:"CP",98:"Zoo",99:"Закосячен",100:"Подозрение на некондицию"},r=e.type;t.hasOwnProperty(r)&&(r=t[r]),this._setInfo(this._$videoInfo,[{label:"ID",value:e.id},{label:"Модерация",value:r},{label:"Сервер",value:e.srv}])}log(e,t=!1){this._createPlace("ad","main","Общее").append(this._logAdCommon({action:e,isError:t}))}logAd(e){let t,r=this._createAdPart(e.id,e.slot,e.type);switch(e.type){case"Wrapper":t=this._logAdWrapper(e);break;case"Общее":default:t=this._logAdCommon(e)}t&&r.append(t)}logInventory(e){this._createPlace("inventory","","Отправка инвентаря").append(this._logAdCommon({action:e.slot}))}logAdSlot(e){this._createPlace("slot",e.slot,e.slot?`Рекламная позиция, slot=${e.slot}`:"Первичная фильтрация рекламы").append(this._logAdCommon({action:e.action,isError:e.isError}))}_logAdCommon(e){let t="",r=e.time,s=this.getNs();e.isError&&(t=`${s}-log-ad-common-row__error`),r||(r=new Date);let o=e.action;return o=o.replace(/(\d{3,8})/g,'<span data-adid="$1">$1</span>'),(0,i.default)(`<div class="${s}-log-ad-common-row ${t}">\n                <div class="${s}-log-ad-common-row-left">${this._formatTime(r)}</div>\n                <div class="${s}-log-ad-common-row-right">${o}</div>\n            </div>`)}_logAdWrapper(e){let t="",r="",s=this.getNs();return e.isError&&(t=`(${e.message} [${e.code}])`,r=`${s}-log-ad-wrapper-row__error`),(0,i.default)([`<div class="${s}-log-ad-wrapper-row ${r}">`,`<div class="${s}-log-ad-wrapper-row-left">${e.domain}</div>`,`<div class="${s}-log-ad-wrapper-row-center">${e.time}c.</div>`,`<div class="${s}-log-ad-wrapper-row-right">${e.action} ${t}</div>`,"</div>"].join(""))}_formatTime(e){return`<time>${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}:${("0"+e.getSeconds()).slice(-2)}<s>.${("00"+e.getMilliseconds()).slice(-3)}</s></time>`}_createPlace(e,t,r){let s=JSON.stringify([e,t]),o="l-";for(let e=0;e<s.length;e++)o+=s.charCodeAt(e).toString(16);if(this._adDivs.hasOwnProperty(s))return this._adDivs[s];let a=(0,i.default)(`#${o}`,document);if(a.length)return a;let n=new Date,l=this.getNs(),d=(0,i.default)(`<div class="${l}-log-ad">\n                <div class="${l}-log-ad-title">${this._formatTime(n)} ${r}</div>\n                <div class="${l}-log-ad-content"></div>\n            </div>`);const u=d.nsFind("log-ad-content");return u.attr("id",o),this._adDivs[s]=u,this._$log.append(d),u}_createAdPart(e,t,r){let s=JSON.stringify(["adPart",e,t,r]),o=this.getNs();if(this._adDivs.hasOwnProperty(s))return this._adDivs[s];let a=(0,i.default)(`<div class="${o}-log-ad-part">\n                    <div class="${o}-log-ad-part-title">${r}</div>\n                    <div class="${o}-log-ad-part-content"></div>\n                </div>`),n=a.nsFind("log-ad-part-content");return this._adDivs[s]=n,this._createPlace("ad",JSON.stringify([e,t]),`Реклама, id=<span data-adid="${e}">${e}</span>, slot=${t}`).append(a),n}createEl(e,t,r){return super.createEl(a.LogLayout,{},{})}_setInfo(e,t){let r=[];for(let i=0;i<t.length;i++){let s=t[i],o=this._createRow(s.label,s.value,s.type);e.append(o),r.push(o)}return r}buildCSSClass(){return`${this.getPlayer().ns}-log`}_createRow(e,t,r){let s=new o.LogRowLayout(this.getPlayer().ns).toString(),a=(0,i.default)(s);return a.nsFind("log-label").text(e),a.nsFind("log-value").html(t),r&&a.nsAddClass("log-row","type"),a}setPositionCount(e,t,r){let i=`<b>${e}</b> (${t}):<br/><ol start="0">`;i+=r.map((e,t)=>"<li>"+e.map(e=>`<span data-adid="${e}">${e}</span>`).join(", ")+"</li>").join(""),i+="</ol>",this._positions[e]=i,this._$positionsInfo.html(Object.values(this._positions).join(", "))}};r.default=p},{"../../core/component":279,"../../utils/catchHandler":327,"../../utils/dom":328,"../../utils/url":338,"./log-panel.row.tpl":312,"./log-panel.tpl":313,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.to-string":105,"core-js/modules/es7.object.values":112,"core-js/modules/web.dom.iterable":115}],312:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LogRowLayout=void 0;var i=e("../../controls/AbstractLayout");r.LogRowLayout=class extends i.AbstractLayout{_toString(e){return""+`<div class="${e}-log-row">\n                <div class="${e}-log-label"></div><div class="${e}-log-value"></div>\n            </div>`}}},{"../../controls/AbstractLayout":254}],313:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LogLayout=void 0;var i=e("../../controls/AbstractLayout");r.LogLayout=class extends i.AbstractLayout{_toString(e){return""+`<div class="${e}-log">\n    <div class="${e}-log-left">\n        <div class="${e}-log-left-inner">\n            <div class="${e}-log-info ${e}-log-info__env"></div>\n            <div class="${e}-log-info ${e}-log-info__player"></div>\n            <div class="${e}-log-info ${e}-log-info__domain"></div>\n            <div class="${e}-log-info ${e}-log-info__video"></div>\n            <div class="${e}-log-info ${e}-log-info__ad"></div>\n            <div class="${e}-log-info ${e}-log-info__clearStorage">Очистить хранилище</div>\n            <div class="${e}-log-info ${e}-log-info__save">Сохранить лог</div>\n            <div class="${e}-log-info ${e}-log-info__url"></div>\n        </div>\n    </div>\n    <div class="${e}-log-right">\n        <div class="${e}-log-right-inner">\n            <div class="${e}-log-info ${e}-log-info__log"></div>\n        </div>\n    </div>\n</div>`}}},{"../../controls/AbstractLayout":254}],314:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.keys"),e("core-js/modules/es6.promise"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator");var i,s=n(e("../core/plugin")),o=n(e("../../common/js/decorators/autobind")),a=n(e("../utils/catchHandler"));function n(e){return e&&e.__esModule?e:{default:e}}let l=(d=(i=class extends s.default{constructor(e,t){super(e,t),this._dataToStore={volume:null,muted:null},this._player=e,this._storage=e.getStorage(),this.volumeControl=e.volumeControl,this._storage.ready().then(()=>{this._initVolumeSync(),this._initPlayingSync()}).catch(e=>(0,a.default)(e))}_initPlayingSync(){let e=this.getOption("advert")||{},t=this._storage,r="ss.autoplay";e.onlyOnePlaying&&this.listenTo(this.getPlayer(),{adRequestAutoplay:()=>{let e=()=>{let e=this.getPlayer();e.once("adAutoplayStart",e=>{let i=e.position,s=0;this.listenTo(i,"timeupdate",()=>{new Date-s<3e3||(s=new Date,t.setItem(r,!0,{expire:5e3}))})}),e.trigger("adAutoplayAllow"),e.once("adAutoplayFinish",()=>{t.removeItem(r)})};return t.setItem(r,!0,{expire:6e4,ifNotExists:!0}).then(t=>{t[0]&&e()}).catch(e),!1}})}_initVolumeSync(){let e=this.getOption("volume")||{};this._initVolumeState().then(()=>{this.listenTo(this.volumeControl,{volumeChange:this._onVolumeChange}),e.realTimeSync&&this._storage.on("volume_change",this._onStorageVolumeChange,this).on("muted_change",this._onStorageMutedChange,this)}).catch(e=>(0,a.default)(e))}_onVolumeChange(e){"player"===e.type&&(this._timeout&&clearTimeout(this._timeout),this._dataToStore.volume=e.volume,this._dataToStore.muted=e.muted,this._timeout=setTimeout(this._onVolumeChangeTimeout,200))}_onVolumeChangeTimeout(){let e=[{key:"muted",value:this._dataToStore.muted},{key:"volume",value:this._dataToStore.volume}];this._dataToStore.volume=null,this._dataToStore.muted=null,this._storage.setItem(e)}_onStorageVolumeChange(e){e.isExternal&&(this.volumeControl.setVolume(e.value,"player",!1,this),e.value>.25&&this.volumeControl.setVolume(e.value,"ad",!1,this))}_onStorageMutedChange(e){e.isExternal&&this.volumeControl.setMuted(e.value,"player",!1,this)}_initVolumeState(){const e=this._storage;return Promise.all([e.getItem("muted"),e.getItem("volume")]).then(e=>{let t=e[0],r=e[1];return null!==r&&(this.volumeControl.setVolume(r,"player",!1,this),r>.25&&this.volumeControl.setVolume(r,"ad",!1,this)),null!==t&&this.volumeControl.setMuted(t,"player",!1,this),Promise.resolve()})}}).prototype,u="_onVolumeChangeTimeout",c=[o.default],h=Object.getOwnPropertyDescriptor(i.prototype,"_onVolumeChangeTimeout"),p=i.prototype,_={},Object.keys(h).forEach(function(e){_[e]=h[e]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=c.slice().reverse().reduce(function(e,t){return t(d,u,e)||e},_),p&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(p):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(d,u,_),_=null),i);var d,u,c,h,p,_;s.default.register("settings-sync",l);var g=l;r.default=g},{"../../common/js/decorators/autobind":228,"../core/plugin":289,"../utils/catchHandler":327,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],315:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.split");var i=o(e("./../core/plugin")),s=o(e("./../utils/pixels"));function o(e){return e&&e.__esModule?e:{default:e}}let a={load:"playerload",start:"playerstart",finish:"playerend"};class n extends i.default{constructor(e,t){if(super(e,t),this.getOption("id")){let t=window.location.host.split(".");t.pop(),this._domain=this.getOption("domain",t.pop()),this._eventPostfix=this.getOption("eventPostfix",""),this.listenTo(e,"change start finish",this._send)}}_getEvent(e){return a[e]+this._eventPostfix}_send(e){let t=["//www.tns-counter.ru","V13a****"+this.getOption("id"),"ru/CP1251","tmsec="+this._domain+"_"+this._getEvent(e.type),Math.floor(1e10*Math.random())];(0,s.default)(t.join("/"))}}i.default.register("tns",n);var l=n;r.default=l},{"./../core/plugin":289,"./../utils/pixels":333,"core-js/modules/es6.regexp.split":104}],316:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("../../core/behavior")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("../../utils/math")),o=n(e("../../../common/js/utils/getTime")),a=e("../default");function n(e){return e&&e.__esModule?e:{default:e}}var l=class extends i.default{constructor(e,t=null,{checkComplete:r=!0}={}){super(e,t),this.exports=["startAutoTime","stopAutoTime","autoTimeInterval","currentTime","autoTimeCheckComplete"],this._checkComplete=!0,this._autoTimeInterval=250,this._stopped=!0,this._currentTime=0,this._lastTime=0,this._checkComplete=r}get name(){return"auto-time"}get alias(){return"at"}get renameBaseFields(){return!0}get autoTimeCheckComplete(){return this._checkComplete}get autoTimeInterval(){return this._autoTimeInterval}set autoTimeInterval(e){this._autoTimeInterval=s.between(100,1e3,e)}_init(){super._init(),this._doAutoTime=this._doAutoTime.bind(this),this._base.on("start",this._onStart,this),this._base.on("finish",this._onFinish,this),this._base.on("empty close timeout error",this._onEmpty,this),this._base.on("state",this._onState,this)}_destroy(){this.stopAutoTime(),this._base.off("start",this._onStart,this),this._base.off("finish",this._onFinish,this),this._base.off("empty close timeout error",this._onEmpty,this),this._base.off("state",this._onState,this)}_onStart(e){}_onFinish(e){this.stopAutoTime()}_onEmpty(e){this.stopAutoTime()}_onState(e){e.state===a.PROVIDER_STATE.PLAY?this.startAutoTime():this.stopAutoTime()}startAutoTime(){this._stopped?this._lastTime=(0,o.default)()/1e3>>0:this.stopAutoTime(),this._stopped=!1,this._timeout=setTimeout(this._doAutoTime,this._autoTimeInterval)}stopAutoTime(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._stopped=!0}get currentTime(){return this._currentTime}set currentTime(e){(e>>=0)!==this._currentTime&&(this._currentTime=e>>0,this._base.trigger("timeupdate"))}_doAutoTime(){if(this._stopped)return;let e=(0,o.default)()/1e3>>0,t=e-this._lastTime;this._lastTime=e,this._currentTime+=t,t>0&&(this._base.trigger("timeupdate"),this.autoTimeCheckComplete&&this._currentTime>=this._base.duration&&(this._base.state=a.PROVIDER_STATE.END,this.stopAutoTime())),this.startAutoTime()}};r.default=l},{"../../../common/js/utils/getTime":231,"../../core/behavior":278,"../../utils/math":332,"../default":317}],317:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.PROVIDER_PRELOAD_TYPE=r.PROVIDER_STATE=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.promise");var i=l(e("./../core/component")),s=l(e("../env/index")),o=e("../utils/extend"),a=l(e("../core/console")),n=l(e("../controls/control-layer"));function l(e){return e&&e.__esModule?e:{default:e}}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let u={IDLE:"idle",PLAY:"play",END:"end",CLOSE:"close",PAUSE:"pause",WAITING:"waiting",ERROR:"error"};r.PROVIDER_STATE=u;const c={SILENT:"silent",DOM:"dom"};r.PROVIDER_PRELOAD_TYPE=c;let h=0;class p extends i.default{static supports(e){return!1}static load(){return Promise.resolve()}static getName(){return!1}static getPriority(){return 0}getName(){return this.constructor.getName()}serialize(){return this.supportSerializing?this.preLoad().then(e=>({options:(0,o.clone)(this.getOptions()),media:e})):Promise.reject()}get supportSerializing(){return!1}get supportWantPlay(){return!0}get preLoadType(){return c.SILENT}volumeChangeSupport(){return!0}static unserialize(e,t){let r=new this(e,t.options);return r.preLoad=function(){return Promise.resolve(t.media)},r}set qualityList(e){this._qualityList=e,this.trigger("qualityListChange")}get qualityList(){return this._qualityList}get quality(){return this._quality}set quality(e){this._setQuality(e)}_setQuality(e){this._quality=e,this.trigger("qualityChange")}get qualityChangeSupported(){return!1}constructor(e,t){super(e.getPlayer(),t),this.volumeControl=void 0,this.loadingTimeout=5e3,this.parentProvider=null,this._mediaContainer=e,this._N=++h,this._controls=this.getOption("controls"),this._state=u.IDLE,this._started=!1,this.volumeControl=this.getPlayer().volumeControl,this._qualityList=[],this._quality=0,this.listenTo(this.getEl(),"click",e=>{if(this.getPlayer().isReady()){let e=this.state;"pause"===e||"end"===e||"idle"===e?this.play():this.pause()}e.originalEvent.stopPropagation()}),this.listenTo(this,"error",e=>{this.state=u.ERROR}),this.listenTo(e.getPlayer(),"visible",e=>{"pause"===this.state&&this.play()}),this._suspendTimeout=1e3*this.getOption("suspendTimeout"),this._stallTimeout=1e3*this.getOption("stallTimeout"),this._stallI=!1,this._suspend=0,this.getEl().nsAddClass("video-provider",this.getName()),this.listenTo(this.volumeControl,{volumeChange:e=>{this.state!==u.PLAY&&this.state!==u.PAUSE||(a.default.log("$$$ provides/default volumeChange",e),this.updateVolume())}}),this._mediaContainer&&this._mediaContainer.once("controlsAppended",this._onControlsAppended,this);const r=e.getPlayer()._options.plugins.backend.show_mv_controls,i=e._options.video.src;!/videonow/.test(i)&&r||this._hideControls()}destroy(){this._stopStallObserver(),super.destroy()}_startStallObserver(){!this._stallTimeout&&!this._suspendTimeout||this._stallI||(this._suspend=0,this._stallI=setInterval(()=>{this._prevTime!==this.currentTime||this._state!==u.PLAY&&this._state!==u.WAITING?(this.state===u.WAITING&&this._suspend>0&&(this.state=u.PLAY),this._suspend=0):(this._suspend<this._stallTimeout||this._suspend<this._suspendTimeout)&&(this._suspend+=200,this._suspendTimeout&&this._suspend>=this._suspendTimeout&&this._state===u.PLAY&&(this.state=u.WAITING),this._stallTimeout&&this._suspend>=this._stallTimeout&&(this._state===u.PLAY||this._state===u.WAITING)&&this.trigger("stall")),this._prevTime=this.currentTime},200))}_stopStallObserver(){this._stallI&&(clearInterval(this._stallI),this._stallI=!1)}getControls(){return this._controls}setControls(e){!1!==e?(this._controls=this._controls||{},this._controls=d({},this._controls,e)):this._controls=!1}getMediaContainer(){return this._mediaContainer}get state(){return this._state}set state(e){const t=this._state;if(e===t)return;e!==u.PLAY||this._started||(this.volumeControl.setCurrentType("player",this),this._started=!0,this._setupVolume(),!1!==this.trigger("beforeStart")?this.trigger("start"):this.once("afterStateChange",()=>{setTimeout(()=>{this.pause()},300),this._started=!1})),e===u.END&&this.trigger("finish"),e===u.PLAY&&this._startStallObserver(),e===u.PAUSE&&this._stopStallObserver();let r=this.getEl();r&&r.nsRemoveClass("state-"+this._state).nsAddClass("state-"+e),this._state=e,this.trigger("state",{state:e,oldState:t}),this.trigger("afterStateChange")}_setupVolume(){this.volumeControl.setCurrentType(null,this),this.updateVolume()}buildCSSClass(){let e=this.getNs();return`${e}-video-provider ${e}-loader ${super.buildCSSClass()}`}load(e=0){return Promise.reject("This method must be inherited")}preLoad(){return Promise.resolve()}updateVolume(e=null){let t=e?e.volume:this.volumeControl.getVolume(null,this),r=e?e.muted:this.volumeControl.getMuted(null,this);a.default.log("$$$ providers/default updateVolume",t,r),this._updateVolume(t,r)}_updateVolume(e,t){a.default.log("$$$ providers/default _updateVolume",e,t)}_getMainVolume(e=!0){return e&&this._getMainMuted()?0:this.volumeControl.getVolume(null,this)}_getMainMuted(){return this.volumeControl.getMuted(null,this)}get autoPlaySupported(){return this._getAutoPlaySupported()}get autoPlaySilentSupported(){return this.autoPlaySupported||!this.getPlayer().isUserAction()&&s.default.silentAutoplay}_getAutoPlaySupported(){return this.getPlayer().isUserAction()||s.default.autoPlay||"idle"!==this.state}signUrlSupported(){return!1}signUrl(e){return Promise.resolve(e)}play(){this.updateVolume()}pause(){}stop(){}resize(e,t){}fullScreen(){}get duration(){return 0}get currentTime(){return 0}set currentTime(e){}_hideControls(){let e=this._getControlLayer();e?e.hideToolBar():(this._showControlsIdle=!1,this._hideControlsIdle=!0)}_showControls(){let e=this._getControlLayer();e?e.showToolBar():(this._showControlsIdle=!0,this._hideControlsIdle=!1)}_getControlLayer(){let e=this.getMediaContainer().controls;return e&&e instanceof n.default!=!1||(e=this.parentProvider?this.parentProvider.getMediaContainer().controls:null),e&&e instanceof n.default!=!1?e:null}_onControlsAppended(){let e=this._getControlLayer();e&&(this._showControlsIdle?e.showToolBar():this._hideControlsIdle&&e.hideToolBar(),this._showControlsIdle=!1,this._hideControlsIdle=!1)}}p.prototype._options={controls:{},suspendTimeout:.5,stallTimeout:3};var _=p;r.default=_},{"../controls/control-layer":255,"../core/console":280,"../env/index":306,"../utils/extend":330,"./../core/component":279,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97}],318:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./default")),s=u(e("./providers")),o=u(e("./../core/swf")),a=u(e("./../core/error")),n=u(e("./../env/index")),l=u(e("./../utils/dom")),d=u(e("../core/console"));function u(e){return e&&e.__esModule?e:{default:e}}class c extends i.default{static getName(){return"flv"}static getPriority(){return 0}static supports(e){return!!e.type&&(e.type.indexOf("flv")>=0||e.type.indexOf("mp4")>=0)}get autoPlaySupported(){return!0}constructor(e,t){super(e,t),this._duration=0,this._buffered=0}destroy(){this._callVideo("clear"),this._video=!1,this._swf&&(this._swf.destroy(),this._swf=!1),super.destroy()}_callVideo(e,...t){try{return this._video[e].apply(this._video,t)}catch(e){}}_loadSWF(){return new Promise((e,t)=>{let r,i=this.getPlayer(),s=i.ns;r=new o.default(i,{src:i.path+"/swf/flv.swf",loadMethod:"jsFireMethod",visible:!0,listener:(e,t)=>{this._swf.trigger(e,{data:t})}}),this.addChild(r),this.getEl().append((0,l.default)(`<div class="${s}-layer"></div>`)),this._video=r.getEl()[0],this._swf=r,this.listenToOnce(this._swf,"ready",e),setTimeout(t,5e3)})}_attachEvents(){this.listenTo(this._swf,{durationchange:e=>{this._duration=e.data,this.trigger("durationchange")},timeupdate:e=>{this._currentTime=e.data,this.trigger("timeupdate")},progress:e=>{this._buffered=e.data,this.trigger("progress")},ended:e=>{this.state=i.PROVIDER_STATE.END},error:e=>{this.triggerError(405,e.data)}})}load(){return this._loadJob||(this._loadJob=this._loadSWF().then(()=>(this._attachEvents(),new Promise((e,t)=>{this._swf.once("loaded",e),this._swf.once("error",e=>{"NetStream.Play.StreamNotFound"===e&&t(new a.default(this,405,e))}),this._video.load(this.getOption("src"))})))),this._loadJob}play(){super.play(),this._video&&(this._callVideo("play"),this.state=i.PROVIDER_STATE.PLAY)}pause(){this._video&&(this._callVideo("pause"),this.state=i.PROVIDER_STATE.PAUSE)}get currentTime(){return this._currentTime}set currentTime(e){this._callVideo("seek",e)}_updateVolume(e,t){d.default.log("$$$ provides/flv _updateVolume",e,t),this._callVideo("setVolume",t?0:e)}get buffered(){return this._buffered/100}get duration(){return this._duration}}n.default.hasFlash&&s.default.register(c),c.prototype._options={controls:!0};var h=c;r.default=h},{"../core/console":280,"./../core/error":281,"./../core/swf":296,"./../env/index":306,"./../utils/dom":328,"./default":317,"./providers":322,"core-js/modules/es6.promise":97}],319:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./default"));e("./providers");var s=n(e("./../utils/audio")),o=n(e("./../utils/dom")),a=n(e("../core/console"));function n(e){return e&&e.__esModule?e:{default:e}}var l=class extends i.default{static getName(){return"html5-audio"}static getPriority(){return 1}static supports(e){if(!e)return!1;if(!e.type)return!1;switch(e.type){case"video/mp4":case"video/ogg":case"video/webm":return!1}return!!s.default.canPlayType&&!!s.default.canPlayType(e.type)}constructor(e,t){super(e,t),this._realSrc=this.getOption("src"),this._audio=!1,this._prevTime=0,this.getOption("nativeControls")&&this._createTag()}destroy(){this._audio&&(this._audio.pause(),this._audio.src="",this._audio=!1),super.destroy(),this.stopListening().off()}_addListeners(){this.listenTo(this._audio,{"timeupdate durationchange progress":this.trigger,pause:()=>{this.duration-this.currentTime>.1&&(this.state=i.PROVIDER_STATE.PAUSE)},ended:()=>{this.state=i.PROVIDER_STATE.END},waiting:()=>{this.state=i.PROVIDER_STATE.WAITING},playing:()=>{this.state=i.PROVIDER_STATE.PLAY},error:()=>{this.triggerError(405,"playback error",{url:this.getRealSrc(),currentTime:this.currentTime})}})}_createTag(){let e=(0,o.default)("<audio/>"),t=e[0];this.getOption("nativeControls")&&(t.controls=!0),this.getEl().append(e),this._audio=t,this._addListeners();let r=(0,o.default)(document.createElement("source"));this.listenTo(r[0],"error",e=>{2!==t.networkState&&3===t.networkState&&this.triggerError(405,"loading error",{url:this.getRealSrc()})}),r[0].src=this.getRealSrc(),e.append(r)}getRealSrc(){return this._realSrc}setRealSrc(e){this._realSrc=e}load(){return Promise.resolve()}play(){super.play(),this._audio?this.state=i.PROVIDER_STATE.PLAY:(this._createTag(),this.state=i.PROVIDER_STATE.WAITING),this._audio.play()}pause(){this._audio&&(this._audio.pause(),this.state=i.PROVIDER_STATE.PAUSE)}get currentTime(){return this._audio?this._audio.currentTime:0}set currentTime(e){if(this._audio)try{this._audio.currentTime=e}catch(e){}}_updateVolume(e,t){a.default.log("$$$ provides/html5-audio _updateVolume",e,t),this._audio&&(this._audio.volume=t?0:e)}get buffered(){if(!this._audio)return 0;let e=this._audio.buffered,t=this._audio.duration;if(!e||0===e.length||t<=0||t===1/0)return 0;let r=e.end(e.length-1)/t;return Math.min(Math.max(0,r),1)}get duration(){return this._audio?this._audio.duration:0}fullScreen(){return!1}};r.default=l},{"../core/console":280,"./../utils/audio":326,"./../utils/dom":328,"./default":317,"./providers":322,"core-js/modules/es6.promise":97}],320:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./default")),s=d(e("./providers")),o=d(e("./../utils/video")),a=d(e("./../utils/dom")),n=d(e("../env/index")),l=d(e("../core/console"));function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r,i,s,o,a){try{var n=e[o](a),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(i,s)}const c="https:"===window.location.protocol;class h extends i.default{static getName(){return"html5"}static getPriority(){return 1}static supports(e){let t=!1;if(o.default.canPlayType){let r=e.type;!(t=!!o.default.canPlayType(r))&&n.default.hasFlash}return t}constructor(e,t){super(e,t),this._tagCreated=!1,this._preLoadJob=!1,this._realSrc=this.getOption("src"),this._video=!1,this._prevTime=0,this.getOption("nativeControls")&&this._createTag()}destroy(){try{this._video&&(this._video.pause(),this._video.src="")}catch(e){}this._video=!1,super.destroy(),this.stopListening().off()}_addListeners(){this.listenTo(this._video,{"timeupdate durationchange progress":this.trigger,pause:()=>{this.duration-this.currentTime>.1&&(this.state=i.PROVIDER_STATE.PAUSE)},ended:()=>{this.state=i.PROVIDER_STATE.END},waiting:()=>{this.state=i.PROVIDER_STATE.WAITING},playing:()=>{this.state=i.PROVIDER_STATE.PLAY,this._started=!0},error:()=>{this.triggerError(405,"playback error",{url:this.getRealSrc(),currentTime:this.currentTime})}})}_createTag(e=!0){if(this._tagCreated)return;this._tagCreated=!0;const t=(0,a.default)("<video webkit-playsinline playsinline>"),r=t[0];e&&(r.preload="metadata"),this.getOption("nativeControls")&&(r.controls=!0,r.poster=this.getOption("poster")),this.getEl().append(t),this._video=r,this._addListeners(),this._initSource()}_initSource(){const e=(0,a.default)(document.createElement("source")),t=this._video;this.listenTo(e[0],"error",e=>{2!==t.networkState&&3===t.networkState&&this.triggerError(405,"loading error",{url:this.getRealSrc()})}),e[0].src=this.getRealSrc(),(0,a.default)(t).append(e)}getRealSrc(){let e=this._realSrc;return c?e.replace(/^http:\/\//,"https://"):e}setRealSrc(e){this._realSrc=e}preLoad(e=5e3){var t=this;return this.preLoadType===i.PROVIDER_PRELOAD_TYPE.DOM?(this._preLoadJob||(this._preLoadJob=new Promise(function(){var e,r=(e=function*(e,r){t._realSrc=yield t.signUrl(t._realSrc),t._createTag(),t.listenToOnce(t._video,"loadedmetadata",t=>{e()}),t.listenToOnce(t._video,"error",e=>{r()})},function(){var t=this,r=arguments;return new Promise(function(i,s){var o=e.apply(t,r);function a(e){u(o,i,s,a,n,"next",e)}function n(e){u(o,i,s,a,n,"throw",e)}a(void 0)})});return function(e,t){return r.apply(this,arguments)}}())),this._preLoadJob):super.preLoad(5e3)}load(){return this.preLoadType===i.PROVIDER_PRELOAD_TYPE.DOM?this._preLoadJob?this._preLoadJob:Promise.resolve():this.signUrl(this._realSrc).then(e=>{this._realSrc=e})}play(){this._video?this.state=i.PROVIDER_STATE.PLAY:(this._createTag(),this.state=i.PROVIDER_STATE.WAITING),super.play(),this.getPlayer().log(`Попытка воспроизведения видео ${this.getRealSrc()}`),this._playVideo()}_playVideo(e){try{this._video.play()}catch(e){}}_updateVolume(e,t){l.default.log("$$$ provides/html5 _updateVolume",e,t),this._video&&(this._video.volume=e,this._video.muted=t)}pause(){this._video&&(this._video.pause(),this.state=i.PROVIDER_STATE.PAUSE)}get currentTime(){return this._video?this._video.currentTime:0}set currentTime(e){if(this._video)try{this._video.currentTime=e}catch(e){}}get buffered(){if(!this._video)return 0;const e=this._video.buffered,t=this._video.duration;if(!e||0===e.length||t<=0||t===1/0)return 0;const r=e.end(e.length-1)/t;return Math.min(Math.max(0,r),1)}get duration(){return this._video?this._video.duration:0}signUrlSupported(){return!0}}/(Windows NT 6\.1).+(OPR\/)/.test(navigator.userAgent)||s.default.register(h);var p=h;r.default=p},{"../core/console":280,"../env/index":306,"./../utils/dom":328,"./../utils/video":339,"./default":317,"./providers":322,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],321:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.promise");var i=d(e("./default")),s=d(e("./providers")),o=d(e("./../core/error")),a=d(e("../utils/error")),n=e("../utils/extend"),l=d(e("../utils/catchHandler"));function d(e){return e&&e.__esModule?e:{default:e}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}var c=class extends i.default{static getName(){return""}static getPriority(){return-1}static getMediaTypePriority(){return["video/mp4","video/webm","video/x-flv","application/javascript","application/x-javascript"]}get supportWantPlay(){return!this._provider||this._provider.supportWantPlay}static supports(e){return!1}constructor(e,t){super(e,t),this._provider=!1,this._loadJob=!1}destroy(){this._destroyProvider(),super.destroy()}getProvider(){return this._provider}_destroyProvider(){return this._provider?this._destroyProviderJob?this._destroyProviderJob:(this._destroyProviderJob=new Promise(e=>{this._provider.once("destroy",e)}),this._destroyProviderJob.then(()=>{this._provider=!1}).catch(e=>(0,l.default)(e)),this._provider.destroy(),this._destroyProviderJob):Promise.resolve()}get autoPlaySupported(){return!0}preLoad(){return Promise.resolve()}load(){return this._loadJob||(this._loadJob=this.preLoad().then(e=>this._loadProvider(e)).then(()=>this.postLoad()).catch(e=>(e instanceof Error&&a.default.rethrow(e),this.errorLoad(e)))),this._loadJob}postLoad(){return Promise.resolve()}errorLoad(e){return Promise.reject(e)}selectProvider(e){let t,r=!1,i=(e=(0,n.clone)(e)).src;if(i instanceof Array){for(let t=0;t<i.length;t++)if(e.src=i[t],r=this.selectProvider(e))return r;return!1}return(t=s.default.select(e))&&((r=new t(this.getMediaContainer(),u(this.getOptions(),e))).parentProvider=this,this.trigger("providerSelected",{provider:r})),r}_loadProvider(e){let t=this.selectProvider(e);return t?(this._provider=t,this.listenTo(t,"state",e=>{this.state=e.state}),this.listenTo(t,"durationchange timeupdate progress volumechange error skip close qualityListChange qualityChange wantunmute unmuteSuccess",this.trigger),this.addChild(t),t.load()):Promise.reject(new o.default(this,403,"Не удалось подобрать провайдер",{media:e}))}play(){this.trigger("tryPlaying"),this._provider&&(this._provider.autoPlaySupported?this._provider.play():this.getMediaContainer().trigger("wantplay"))}pause(){this._provider&&this._provider.pause()}get duration(){return this._provider?this._provider.duration:0}get currentTime(){return this._provider?this._provider.currentTime:0}set currentTime(e){this._provider&&(this._provider.currentTime=e)}get qualityList(){return this._provider?this._provider.qualityList:[]}get qualityChangeSupported(){return!!this._provider&&this._provider.qualityChangeSupported}get quality(){return this._provider?this._provider.quality:this._quality}set quality(e){if(this._provider)return this._provider.quality=e}_updateVolume(e,t){}};r.default=c},{"../utils/catchHandler":327,"../utils/error":329,"../utils/extend":330,"./../core/error":281,"./default":317,"./providers":322,"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97}],322:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ProvidersClass=r.default=void 0,e("core-js/modules/es6.array.sort");var i,s=(i=e("../core/console"))&&i.__esModule?i:{default:i};let o={mp3:"audio/mpeg",ogg:"audio/ogg",aac:"audio/mp4",mp4:"video/mp4",f4v:"video/mp4",m4v:"video/mp4",mov:"video/mp4",ogv:"video/ogg",oga:"video/ogg",vorbis:"video/ogg",webm:"video/webm",flv:"video/x-flv",m3u8:"application/x-mpegURL",xml:"text/xml",mpd:"application/mpd"};class a{constructor(){this._providers=[],this._names=[]}register(e){let t;try{t=e.getName()}catch(t){return s.default.error("Ошибка при получении имени провайдера",e),!1}try{e.getPriority()}catch(e){return s.default.error(`У провайдера ${t} не определена функция getPriority`),!1}if(t){if(!this._names.hasOwnProperty(t))return this._providers.push(e),this._providers.sort(function(e,t){return t.getPriority()-e.getPriority()}),this._names[t]=e,!0;s.default.error("Provider with name "+t+" already registered")}else s.default.error("Can't get provider name");return!1}getProvider(e){return!!this._names.hasOwnProperty(e)&&this._names[e]}_getType(e){void 0===e.type&&(e.type="");let t=/([^?]+)/.exec(e.src),r=!1;return(t=/\.([^.]+)$/.exec(t))&&void 0!==o[t[1]]&&(r=o[t[1]]),r&&(void 0===e.type&&(e.type=r),e.type!==r&&(e.type=r)),r}select(e){if(this._getType(e),e.provider){if(this._names.hasOwnProperty(e.provider))return this._names[e.provider]}else for(let t=0;t<this._providers.length;t++){let r=this._providers[t];try{if(r.supports(e))return r}catch(e){s.default.error("У провайдера нет функции supports",r)}}return null}}var n=new a;r.default=n;let l=a;r.ProvidersClass=l},{"../core/console":280,"core-js/modules/es6.array.sort":94}],323:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.match"),e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./default")),s=d(e("./providers")),o=d(e("./../utils/ajax")),a=d(e("./../utils/dom")),n=d(e("./../utils/unique")),l=d(e("../core/console"));function d(e){return e&&e.__esModule?e:{default:e}}let u=/https?:\/\/(?:(www|player)\.)?vimeo(?:pro)?\.com\/(?:videos?\/)?([0-9]+)/;function c(){return"function"==typeof $f}function h(){return new Promise((e,t)=>{let r=setInterval(function(){c()&&(clearInterval(r),e())},50);setTimeout(function(){clearInterval(r),t("timeout")},5e3)})}class p extends i.default{static getName(){return"vimeo"}static getPriority(){return 0}static supports(e){if(!e||"string"!=typeof e.src)return!1;let t=e.src.match(u);return t&&t[2]}static load(){return p.apiLoadJob||(c()?p.apiLoadJob=Promise.resolve():p.apiLoadJob=(0,o.default)({url:"https://f.vimeocdn.com/js/froogaloop2.min.js",dataType:"script",timeout:5e3}).then(h)),p.apiLoadJob}constructor(e,t){if(t.src){let e=t.src.match(u);t.videoId=e&&e[2]?e[2]:t.src}super(e,t),this._muted=!1,this._buffered=0,this._duration=0,this._currentTime=0}destroy(){this._video&&(this._video.api("unload"),this._video=!1),super.destroy()}_createPlayer(){return new Promise((e,t)=>{let r=(0,n.default)("vimeo"),i="https://player.vimeo.com/video/"+this.getOption("videoId")+"?api=1&portrait=0&badge=0&title=0&byline=0&playerId="+r,s=(0,a.default)('<iframe id="'+r+'" src="'+i+'" frameborder="0" style="width:100%;height:100%;"/>');this.getEl().append(s);let o=$f(s[0]);o.addEvent("ready",()=>{o.api("getDuration",e=>{this._duration=e,this.trigger("durationchange")}),e(o)}),setTimeout(function(){t("timeout")},2e3)})}_attachEvents(){this._video.addEvent("play",()=>{this.state=i.PROVIDER_STATE.PLAY}),this._video.addEvent("pause",()=>{this.state=i.PROVIDER_STATE.PAUSE}),this._video.addEvent("finish",()=>{this.state=i.PROVIDER_STATE.END}),this._video.addEvent("seek",e=>{this._currentTime=e.seconds}),this._video.addEvent("playProgress",e=>{this._currentTime=e.seconds,this.trigger("timeupdate")}),this._video.addEvent("loadProgress",e=>{this._buffered=e.percent,this.trigger("progress")})}load(){return this.loadJob||(this.loadJob=p.load().then(()=>this._createPlayer()).then(e=>{this._video=e,this._attachEvents()})),this.loadJob}play(){super.play(),this.state=i.PROVIDER_STATE.PLAY,this._video.api("play")}pause(){this.state=i.PROVIDER_STATE.PAUSE,this._video.api("pause")}get duration(){return this._duration}get currentTime(){return this._currentTime}set currentTime(e){this._video.api("seekTo",e)}_updateVolume(e,t){l.default.log.apply(l.default,["$$$ provides/vimeo _updateVolume"].concat(Array.prototype.slice.call(arguments))),this._video&&this._video.api("setVolume",t?0:e)}get buffered(){return this._buffered}}p.apiLoadJob=!1,p.prototype._options={controls:!1},s.default.register(p);var _=p;r.default=_},{"../core/console":280,"./../utils/ajax":325,"./../utils/dom":328,"./../utils/unique":337,"./default":317,"./providers":322,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.match":101}],324:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.search"),e("core-js/modules/es6.regexp.match"),e("core-js/modules/es6.regexp.split"),e("core-js/modules/es6.promise");var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}(e("./default")),s=u(e("./providers")),o=u(e("./../utils/ajax")),a=u(e("./../utils/dom")),n=u(e("./../utils/url")),l=u(e("../core/console")),d=u(e("../utils/catchHandler"));function u(e){return e&&e.__esModule?e:{default:e}}const c=/^(?:https?:)?(?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/watch\?.+&v=))\/?([\w-]{11})(?:.+)?$/,h={"-1":i.PROVIDER_STATE.IDLE,0:i.PROVIDER_STATE.END,1:i.PROVIDER_STATE.PLAY,2:i.PROVIDER_STATE.PAUSE,3:i.PROVIDER_STATE.WAITING,5:i.PROVIDER_STATE.IDLE},p={2:"Запрос содержит недопустимое значение параметра",5:"Ошибка воспроизведения запрошенного содержимого в проигрывателе HTML",100:"Запрошенное видео не найдено",101:"Владелец запрошенного видео запретил его воспроизведение во встроенных проигрывателях",150:"Владелец запрошенного видео запретил его воспроизведение во встроенных проигрывателях"};function _(e){return new Promise((t,r)=>{let i=setInterval(function(){"undefined"!=typeof YT&&void 0!==YT.Player&&(clearInterval(i),t())},50);setTimeout(function(){clearInterval(i),r("timeout")},e||5e3)})}class g extends i.default{constructor(e,t){if(t.src){let e,r=t.src.match(c),i=n.default.parse(t.src),s=i.pathname,o=/^\/embed/.test(s);i&&(e=n.default.parseSearch(i.search),o&&"1"===e.enablejsapi?(t.customMode=!0,e.hasOwnProperty("playlist")&&(t.listId=e.playlist)):(e.hasOwnProperty("list")&&(t.listId=e.list),e.hasOwnProperty("t")&&(t.startSeconds=function(e){let t=0,r=0,i=0;switch((e=e.split(/[hms]/)).length){case 1:i=+e[0];break;case 2:r=+e[0],i=+e[1];break;case 3:t=+e[0],r=+e[1],i=+e[2]}return 60*t*60+60*r+i}(e.t)))),t.videoId=r&&r[1]?r[1]:t.src}super(e,t),this._launchedManual=!1,t.customMode?(this._div=(0,a.default)('<iframe frameborder="0" allowfullscreen type="text/html" />'),this._div.attr("src",t.src).css({width:"100%",height:"100%"})):this._div=(0,a.default)("<div/>"),this.getEl().append(this._div),this._duration=0,this._currentTime=0}static getName(){return"youtube"}static getPriority(){return 0}static supports(e){if(!e||"string"!=typeof e.src)return!1;let t=e.src.match(c);return t&&t[1]||/^[\w-]{11}$/.test(e.src)}static loadYtIframeApi(){(0,o.default)({url:"https://www.youtube.com/iframe_api",dataType:"script"}),this.loadYtIframeApi=function(){}}static load(e){return this.loadYtIframeApi(),_(e)}get launchedManual(){return this._launchedManual}_beforeDestroy(){this.state===i.PROVIDER_STATE.PLAY&&this.pause()}destroy(){this._beforeDestroy(),this._launchedManual=!1,this._observer&&(clearInterval(this._observer),this._observer=!1),setTimeout(()=>{this._video&&(this._video.destroy(),this._video=!1),super.destroy()},500)}_initYoutubeParams(){if(this.getOption("customMode"))return{};let e=this.getOption("nativeControls");return{height:"100%",width:"100%",playerVars:{autoplay:0,enablejsapi:1,playsinline:1,showinfo:0,disablekb:e?0:1,modestbranding:e?0:1,fs:e?1:0,controls:e?1:0,iv_load_policy:3,rel:e?1:0,theme:"light"}}}_startObserve(){this._observer||(this._observer=setInterval(()=>{let e=this._video.getDuration();this._duration!==e&&(this._duration=e,this.trigger("durationchange"));let t=this._video.getVideoLoadedFraction();this._buffered!==t&&(this._buffered=t,this.trigger("progress"));let r=this._video.getCurrentTime();this._currentTime!==r&&(this._currentTime=r,this.trigger("timeupdate")),r>1&&this._updateVolumeController()},100))}_createPoster(){}_destroyPoster(){this._$poster&&(this._$poster.remove(),this._$poster=null)}_createPlayer(){return new Promise((e,t)=>{let r,s=!1,o=0,a=this._initYoutubeParams(),n={ready:!1,idle:!1},l=function(){n.ready&&n.idle&&(e(),l=function(){})};a.events={onReady:()=>{if(n.ready=!0,this.getOption("customMode")&&(n.idle=!0),l(),this.getOption("listId")&&(s=!0),!this.getOption("customMode"))if(this.getOption("listId")){let e={list:this.getOption("listId"),listType:"playlist"};this.getOption("startSeconds")&&(e.startSeconds=this.getOption("startSeconds")),this._video.loadPlaylist(e)}else this._video.cueVideoById(this.getOption("videoId"));this._destroyPoster(),this._startObserve()},onError:e=>{let r=e.data;2===r&&t(),this.triggerError(r,p[r])},onStateChange:e=>{let t=h[e.data];if(s&&t===i.PROVIDER_STATE.END){r.getPlaylist().length===o+1&&(this.state=t)}else this.state=t;s&&t===i.PROVIDER_STATE.PLAY&&(o=r.getPlaylistIndex()),"idle"===t&&(n.idle=!0,l()),this.state===i.PROVIDER_STATE.PLAY&&this._loadQualityList()},onPlaybackQualityChange:this._onPlaybackQualityChange.bind(this)},this._video=r=new YT.Player(this._div[0],a)})}_loadQualityList(){let e=this._video.getAvailableQualityLevels(),t=[],r={tiny:"144p",small:"240p",medium:"360p",large:"480p",hd720:"720p",hd1080:"1080p",hd1440:"1440p",hd2160:"2160p",highres:"Ultra HD"};t.push({title:"Авто",value:"auto",isAuto:!0});for(let i=0;i<e.length;i++){let s=e[i];"auto"!==s&&t.push({title:r[s]||s,value:s})}this.qualityList=t,this.quality=this._ytQuality,this._loadQualityList=function(){}}_onPlaybackQualityChange(e){this._ytQuality=e.data}load(e=0){return this._loadingJob||(this._createPoster(),this._loadingJob=g.load(e).then(()=>this._createPlayer())),this._loadingJob}get currentTime(){return this._currentTime}set currentTime(e){this._video.seekTo(e,!0)}play(){super.play(),this.getPlayer().fullScreen=!1,this._video.playVideo(),this._launchedManual=!0}pause(){this._video.pauseVideo()}_updateVolume(e,t){l.default.log.apply(l.default,["$$$ provides/youtube _updateVolume"].concat(Array.prototype.slice.call(arguments))),this._video&&this._video.setVolume?(e*=100,this._video.setVolume(e),!1===t&&this._video.isMuted()&&this._video.unMute(),!0===t&&!1===this._video.isMuted()&&this._video.mute()):this.load().then(()=>{this._updateVolume(e,t)}).catch(e=>(0,d.default)(e))}_updateVolumeController(){if(this.volumeControl.queueLength>0)return!1;if(!this._video)return clearInterval(this._updateVolumeController),!1;try{this._video.getVolume()}catch(e){return!1}const e=this._video.getVolume()/100,t=this._video.isMuted(),r=this.volumeControl.getVolume(null,this),i=this.volumeControl.getMuted(null,this);e!==r&&this.volumeControl.setVolume(e,null,!1,this),t!==i&&this.volumeControl.setMuted(t,null,!1,this)}get duration(){return this._duration}get buffered(){return this._buffered}get qualityChangeSupported(){return!0}_setQuality(e){this._video.setPlaybackQuality(e),super._setQuality(e)}}g.apiLoadJob=!1,g.prototype._options={controls:1},s.default.register(g);var f=g;r.default=f},{"../core/console":280,"../utils/catchHandler":327,"./../utils/ajax":325,"./../utils/dom":328,"./../utils/url":338,"./default":317,"./providers":322,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.search":103,"core-js/modules/es6.regexp.split":104}],325:[function(e,t,r){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=b,r.get=function(){return b(y.apply(null,arguments))},r.post=function(){let e=y.apply(null,arguments);return e.type="POST",b(e)},r.getJSON=function(){let e=y.apply(null,arguments);return e.dataType="json",b(e)},e("core-js/modules/es6.object.assign"),e("core-js/modules/es6.regexp.constructor"),e("core-js/modules/es6.regexp.to-string"),e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.split");let s,o=document,a=/^(?:text|application)\/javascript/i,n=/^(?:text|application)\/xml/i,l="application/json",d="text/html",u=/^\s*$/,c=()=>{},h=o.createElement("a");h.href=window.location.href;let p={type:"GET",xhr:()=>new window.XMLHttpRequest,accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",html:d,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};function _(e,t,r,i){i([r,t,e])}let g=function(e,t){return new Promise((r,i)=>{let s=document.createElement("script"),o=!!t&&setTimeout(function(){i("timeout")},t);s.async="async",s.addEventListener("load",function(){o&&clearTimeout(o),r()}),s.addEventListener("error",function(){o&&clearTimeout(o),i("error")}),s.src=e,document.head.appendChild(s)})};function f(e,t){return""===t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}let m=encodeURIComponent,A=function(e){e.processData&&e.data&&"string"!=typeof e.data&&(e.data=function(e){let t=[];for(let r in e)t.push(m(r)+"="+m(e[r]));return t.join("&").replace(/%20/g,"+")}(e.data,e.traditional)),!e.data||e.type&&"GET"!==e.type.toUpperCase()||(e.url=f(e.url,e.data),e.data=void 0)};function v(e,t,r){let m,v,y=i({},p,e);if(y.crossDomain||((m=o.createElement("a")).href=y.url,m.href=m.href+"",y.crossDomain=h.protocol+"//"+h.host!=m.protocol+"//"+m.host),y.url||(y.url=window.location.toString()),(v=y.url.indexOf("#"))>-1&&(y.url=y.url.slice(0,v)),A(y),y.crossDomain&&"script"===y.dataType)return g(y.url,y.timeout).then(t).catch(r);let b=y.dataType;!1!==y.cache&&e&&!0===e.cache||(y.url=f(y.url,"_="+Date.now()));let P,T=y.accepts[b],w=y.mimeType,S={},E=function(e,t){S[e.toLowerCase()]=[e,t]},O=/^([\w-]+:)\/\//.test(y.url)?RegExp.$1:window.location.protocol,j=y.xhr(),I=j.setRequestHeader;if(y.crossDomain||E("X-Requested-With","XMLHttpRequest"),E("Accept",T||"*/*"),w&&(w.indexOf(",")>-1&&(w=w.split(",",2)[0]),j.overrideMimeType&&j.overrideMimeType(w)),(y.contentType||!1!==y.contentType&&y.data&&"GET"!==y.type.toUpperCase())&&E("Content-Type",y.contentType||"application/x-www-form-urlencoded"),y.headers)for(s in y.headers)y.headers.hasOwnProperty(s)&&E(s,y.headers[s]);for(s in j.setRequestHeader=E,j.onreadystatechange=function(){if(4===j.readyState){let i;j.onreadystatechange=c,P&&clearTimeout(P);let s=!1;if(j.status>=200&&j.status<300||304===j.status||0===j.status&&"file:"===O){if("xhr"===(b=b||((e=y.mimeType||j.getResponseHeader("content-type"))&&(e=e.split(";",2)[0]),e&&(e===d?"html":e===l?"json":a.test(e)?"script":n.test(e)&&"xml")||"text")))i=j;else if("arraybuffer"===j.responseType||"blob"===j.responseType)i=j.response;else{i=j.responseText;try{if("script"===b)(0,eval)(i);else if("xml"===b){if(!(i=j.responseXML)){if(j.responseText)try{let e=new DOMParser,t=j.responseText.trim();i=e.parseFromString(t,"application/xml")}catch(e){}i||(s=j.responseText?j.responseText:"Empty xml")}}else"json"===b&&(i=u.test(i)?null:JSON.parse(i))}catch(e){s=e}if(s)return _(s,"parsererror",j,r)}t(i)}else _(j.statusText||null,j.status?"error":"abort",j,r)}var e},y.xhrFields&&i(j,y.xhrFields),j.open(y.type,y.url,!0,y.username,y.password),S)I.apply(j,S[s]);return y.timeout>0&&(P=setTimeout(function(){P=!1,j.onreadystatechange=c,_(null,"timeout",j,r),j.abort()},y.timeout)),j.send(y.data?y.data:null),j}function y(e,t,r){return{url:e,data:t,dataType:r}}function b(e){return new Promise(function(t,r){v(e,t,r)})}},{"core-js/modules/es6.object.assign":95,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.constructor":99,"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104,"core-js/modules/es6.regexp.to-string":105}],326:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=document.createElement("audio");r.default=i},{}],327:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return s.default.warn("catch in promise",e)};var i,s=(i=e("../core/console"))&&i.__esModule?i:{default:i}},{"../core/console":280}],328:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.constructor");var i,s=(i=e("./../core/events"))&&i.__esModule?i:{default:i};if(Element.prototype.on=s.default.on,Element.prototype.off=s.default.off,Element.prototype.once=s.default.once,window.HTMLDocument?(HTMLDocument.prototype.on=s.default.on,HTMLDocument.prototype.once=s.default.once,HTMLDocument.prototype.off=s.default.off):(document.on=s.default.on,document.once=s.default.once,document.off=s.default.off),window.Window?(Window.prototype.on=s.default.on,Window.prototype.once=s.default.once,Window.prototype.off=s.default.off):(window.on=s.default.on,window.once=s.default.once,window.off=s.default.off),Element&&!Element.prototype.matches){let e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){let t=document.querySelectorAll(e),r=this;return Array.prototype.some.call(t,function(e){return e===r})}}let o={"&":"&amp;","<":"&lt;",">":"&gt;"},a=function(e){return o[e]||e};const n=function e(t,r){let i,s,o,a;if(!(this instanceof e))return new e(t,r);if(this.length=0,"object"!=typeof t&&"<"===t[0]){let e=document.createElement("div");for(e.innerHTML=""+t,i=0;i<e.childNodes.length;i++)this[this.length++]=e.childNodes[i]}else if("object"==typeof t)this[0]=t,this.length=1;else if("function"==typeof t&&t.nodeName)this[0]=t,this.length=1;else if(r instanceof e){for(i=0;i<r.length;i++)if(r[i].nodeType!==Node.TEXT_NODE)if(r[i].matches&&r[i].matches(t))this[this.length++]=r[i];else for(a=new e(t,r[i]),o=0;o<a.length;o++)this[this.length++]=a[o]}else if((r=r||document).querySelectorAll&&(a=r.querySelectorAll(t))){for(i=0,s=a.length;i<s;i++)this[i]=a[i];this.length=a.length}};n.prototype={html(e){if(0===arguments.length)return this[0].innerHTML;for(let t=0,r=this.length;t<r;t++)this[t].innerHTML=e;return this},empty(){return this.html("")},width(){if(this.length>0){let e=this[0].getBoundingClientRect();return e.right-e.left}return!1},height(){if(this.length>0){let e=this[0].getBoundingClientRect();return e.bottom-e.top}return!1},addClass(e){if(!e)return this;let t=new RegExp("(^|\\s)"+e+"(\\s|$)","g");for(let r=0,i=this.length;r<i;r++){if(t.test(this[r].className))return;this[r].className=(this[r].className+" "+e).replace(/\s+/g," ").replace(/(^ | $)/g,"")}return this},removeClass(e){if(!e)return this;let t=new RegExp("(^|\\s)"+e+"(\\s|$)","g");for(let e=0,r=this.length;e<r;e++)this[e].className=this[e].className.replace(t,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"");return this},hasClass(e){if(!e)return this;e=" "+e+" ";for(let t=0,r=this.length;t<r;t++)if((" "+this[t].className+" ").replace(/\s+/g," ").indexOf(e)>-1)return!0;return!1},prepend(e){for(let t=0,r=e.length;t<r;t++)for(let r=0,i=this.length;r<i;r++)if(e[t].nodeType!==Node.TEXT_NODE){let i=this[r];i.parentNode&&i.parentNode.insertBefore(e[t],i)}return this},append(e){if(!e)return this;for(let t=0,r=e.length;t<r;t++)for(let r=0,i=this.length;r<i;r++)e[t].nodeType!==Node.TEXT_NODE&&this[r].appendChild(e[t]);return this},remove(){this.detach();for(let e=0,t=this.length;e<t;e++)this[e].off&&this[e].off();return this},detach(){for(let e=0,t=this.length;e<t;e++)this[e].parentElement&&this[e].parentElement.removeChild(this[e]);return this},parent(){let e,t,r;for(t=0,r=this.length;t<r;t++)if(this[t].parentElement){e=new n(this[t].parentElement);break}return e},css(e,t){let r;for(r in"string"==typeof e&&((r=[])[e]=t,e=r),e)if(e.hasOwnProperty(r))for(let t=0,i=this.length;t<i;t++)this[t].style[r]=e[r];return this},attr(e,t){if(!t&&"string"==typeof e&&this.length>0)return this[0].getAttribute(e);let r;for(r in"string"==typeof e&&((r=[])[e]=t,e=r),e)if(e.hasOwnProperty(r))for(let t=0,i=this.length;t<i;t++)this[t].setAttribute(r,e[r]);return this},prop(e,t){let r;for(r in"string"==typeof e&&((r=[])[e]=t,e=r),e)if(e.hasOwnProperty(r))for(let t=0,i=this.length;t<i;t++)this[t][r]=e[r];return this},once(e,t,r){for(let i=0,s=this.length;i<s;i++)this[i].once(e,t,r);return this},on(e,t,r){for(let i=0,s=this.length;i<s;i++)this[i].on(e,t,r);return this},off(e,t,r){for(let i=0,s=this.length;i<s;i++)this[i].off(e,t,r);return this},focus(){for(let e=0,t=this.length;e<t;e++)this[e].focus();return this},blur(){for(let e=0,t=this.length;e<t;e++)this[e].blur();return this},find(e){return new n(e,this)},text(e){if(0===arguments.length)return this[0].textContent;this.html(n.escape(e))},show(){this.nsRemoveClass("hidden")},hide(){this.nsAddClass("hidden")},splice(e,t){let r,i=Array.prototype.slice.call(this);for(i.splice(e,t),r=0;r<this.length;r++)delete this[r];for(r=0;r<i.length;r++)this[r]=i[r];return this.length=i.length,this},nsCreateClass(e,t=!1){let r=`${n._ns}-${e}`;return t&&(r+=`__${t}`),r},nsHasClass(e,t=!1){return this.hasClass(this.nsCreateClass(e,t))},nsAddClass(e,t=!1){return this.addClass(this.nsCreateClass(e,t))},nsRemoveClass(e,t=!1){return this.removeClass(this.nsCreateClass(e,t))},nsFind(e,t=!1){return new n("."+this.nsCreateClass(e,t),this)}},n.escape=function(e){return String(e).replace(/[&<>]/g,a)},n.setNs=function(e){n._ns=e},n.getNs=function(){return n._ns};var l=n;r.default=l},{"./../core/events":283,"core-js/modules/es6.regexp.constructor":99,"core-js/modules/es6.regexp.replace":102}],329:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i={rethrow(e){setTimeout(function(){throw e},0)},done(){let e=this;return function(t){throw t instanceof Error&&e.rethrow(t),t}}};r.default=i},{}],330:[function(e,t,r){"use strict";function i(e){return!!(e instanceof Date||e instanceof RegExp)}function s(e){if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("Unexpected situation")}function o(e){let t=[];return e.forEach(function(e,r){"object"==typeof e&&null!==e?Array.isArray(e)?t[r]=o(e):i(e)?t[r]=s(e):t[r]=a({},e):t[r]=e}),t}Object.defineProperty(r,"__esModule",{value:!0}),r.clone=r.default=void 0,e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys"),e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.regexp.constructor");let a=function e(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];let t,r,a=arguments[0];return Array.prototype.slice.call(arguments,1).forEach(function(n){"object"!=typeof n||Array.isArray(n)||Object.keys(n).forEach(function(l){return r=a[l],(t=n[l])===a?void 0:"object"!=typeof t||null===t?void(a[l]=t):Array.isArray(t)?void(a[l]=o(t)):i(t)?void(a[l]=s(t)):"object"!=typeof r||null===r||Array.isArray(r)?void(a[l]=e({},t)):void(a[l]=e(r,t))})}),a};var n=a;r.default=n;r.clone=function(e){return e instanceof Array?a({},{result:e}).result:a({},e)}},{"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/es6.regexp.constructor":99,"core-js/modules/web.dom.iterable":115}],331:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){if(!s)return!1;let o={category:"ec",action:"ea",label:"el",value:"ev",cid:"cid"},a={v:"1",cid:s,tid:e,t:t,z:Math.ceil(1e5*Math.random())};for(let e in r)r.hasOwnProperty(e)&&void 0!==o[e]&&void 0!==r[e]&&(a[o[e]]=r[e]);(0,i.get)("//www.google-analytics.com/collect",a)},e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.constructor"),e("core-js/modules/es6.regexp.match");var i=e("./ajax");let s;try{let e=document.cookie.match(new RegExp("(?:^|; )"+"mvs".replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));s=e?e[1]:Math.ceil(1e5*Math.random())}catch(e){s=Math.ceil(1e5*Math.random())}},{"./ajax":325,"core-js/modules/es6.regexp.constructor":99,"core-js/modules/es6.regexp.match":101,"core-js/modules/es6.regexp.replace":102}],332:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.betweenZeroAndOne=r.between=r.randomFloat=r.randomInt=void 0;r.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};r.randomFloat=function(e,t){return Math.random()*(t-e)+e};const i=function(e,t,r){return r>t?t:r<e?e:r};r.between=i;r.betweenZeroAndOne=(e=>i(0,1,e))},{}],333:[function(e,t,r){"use strict";function i(e){return new Promise((t,r)=>{let i=document.createElement("img");i.onload=function(){t()},i.onerror=function(e){r(e)},i.src=e})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.promise");var s=function(e){if(!e)return Promise.resolve();"string"==typeof e&&(e=[e]);let t=[];if(e)for(let r=0;r<e.length;r++)t.push(i(e[r]));return Promise.all(t).then(function(){return!0},function(){return!0})};r.default=s},{"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.promise":97,"core-js/modules/web.dom.iterable":115}],334:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("./timer"))&&i.__esModule?i:{default:i};let o={};function a(e){return o.hasOwnProperty(e)||(o[e]=new s.default),o[e]}var n={start(e){a(e).start()},stop:e=>a(e).stop(),time:e=>a(e).time};r.default=n},{"./timer":336}],335:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.match");var i={toString(e,t){e=parseFloat(e),!isNaN(e)&&isFinite(e)||(e=0),e<0&&(e=0);let r=[Math.floor(e/3600),Math.floor(e/60)%60,Math.round(e)%60];return 0!==r[0]||!1!==t&&void 0!==t||r.shift(),r.map(function(e){return(e<10?"0":"")+e}).join(":")},fromString(e){if("string"==typeof e){let t=e.trim().match(/(?:(\d{2}):)?(\d{2}):(\d{2})/);if(t)return 60*(t[1]?parseInt(t[1]):0)*60+60*parseInt(t[2])+parseInt(t[3])}return 0}};r.default=i},{"core-js/modules/es6.regexp.match":101}],336:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s=(i=e("../../common/js/utils/getTime"))&&i.__esModule?i:{default:i};const o=0,a=1;var n=class{constructor(){this._startTime=null,this._endTime=null,this._status=o}get status(){return this._status}start(){this._status!==a&&(this._status=a,this._startTime=(0,s.default)())}stop(){return this._status===o?(this._endTime||(this._endTime=(0,s.default)()),this.time):(this._endTime=(0,s.default)(),this._status=o,this.time)}get time(){return this.timeMSec/1e3}get timeMSec(){let e=0;return this._startTime?(this.status===o?(this._endTime||(this._endTime=(0,s.default)()),e=Math.max(0,this._endTime-this._startTime)):e=0,e):0}};r.default=n},{"../../common/js/utils/getTime":231}],337:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e="id"){return e+(++i+"")};let i=0},{}],338:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/es6.regexp.replace"),e("core-js/modules/es6.regexp.split");var i,s=(i=e("http-build-query"))&&i.__esModule?i:{default:i};var o={parse(e){let t=document.createElement("a");return t.href=e,t},parseSearch(e){e=e.replace(/^\?/,"").split("&");let t={};for(let r=0;r<e.length;r++)e[r]=e[r].split("="),1===e[r].length&&e[r].push(""),t[decodeURIComponent(e[r][0])]=decodeURIComponent(e[r][1]);return t},getHostname(e){return this.parse(e).hostname},buildQuery:e=>(0,s.default)(e)};r.default=o},{"core-js/modules/es6.regexp.replace":102,"core-js/modules/es6.regexp.split":104,"http-build-query":118}],339:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.canPlayType=r.default=void 0;const i=document.createElement("video");var s=i;r.default=s;r.canPlayType=function(e){return!!i.canPlayType(e)}},{}],340:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RsPromoPlugin=void 0,e("core-js/modules/es6.promise"),e("core-js/modules/es6.regexp.replace");var i=l(e("../../../../player/core/component")),s=l(e("./../../../../player/core/plugin")),o=l(e("./../../../../player/utils/dom")),a=l(e("./../../../../ad/js/plugins/advert/url/url")),n=l(e("../../../../ad/js/plugins/advert/media-container"));function l(e){return e&&e.__esModule?e:{default:e}}const d="https://[linkTo]?utm_source=[utmSource]&utm_medium=[utmMedium]&utm_campaign=[utmCampaign]",u=[200221,201011,200961,200641,201311,201631];class c extends i.default{constructor(e,t){super(e,t);let r=this._el,i=(0,o.default)('<span class="rs-promo-logo"></span>');const s=this.getOption("title","Ads by RedDigital");let a=(0,o.default)(`<span class="rs-promo-title">${s}</span>`);r.append(i),r.append(a),e.addPromo(this),this.listenTo(e,{create:this._onCreate})}_onCreate(e){let t=e.item;t instanceof n.default&&t.getAdId()&&t.getCampaignId()&&this.listenTo(t,{start:()=>{let e=parseInt(t.getCampaignId());const r=t._options.video.src,i=/videonow/.test(r);u.indexOf(e)>=0||i?this.hide():this.show()},"skip close finish empty timeout error ":()=>{this.show()}})}createEl(e="a",t={}){let r=this.getOption("link",d),i={utmMedium:this.getOption("utmMedium","unknown"),utmCampaign:this.getOption("utmCampaign","reddigital"),utmSource:this.getOption("utmSource","moevideo"),linkTo:this.getOption("linkTo","reddigital.ru")};return super.createEl(e,t,{target:"_blank",href:a.default.replace(r,i,this.getPlayer())})}buildCSSClass(){return"rs-promo"}load(){return Promise.resolve()}}r.RsPromoPlugin=c,s.default.register("promo",c)},{"../../../../ad/js/plugins/advert/media-container":173,"../../../../player/core/component":279,"./../../../../ad/js/plugins/advert/url/url":203,"./../../../../player/core/plugin":289,"./../../../../player/utils/dom":328,"core-js/modules/es6.promise":97,"core-js/modules/es6.regexp.replace":102}],341:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../../../../config/player-version"),s={DEFAULT_PLATFORM:"pc",HIDDEN_SUPPORT:void 0!==document.hidden,START_VIEWPORT_HEIGHT:window.innerHeight,SCRIPT_NAME:"mvpt.min.js",DEFAULT_WIDTH:640,DEFAULT_MAX_WIDTH:800,DEFAULT_MIN_WIDTH:300,DEFAULT_MIN_HEIGHT:240,DEFAULT_MIN_FLOAT_WIDTH:400,DEFAULT_MAX_FLOAT_WIDTH:600,DEFAULT_FLOAT_WIDTH:400,DEFAULT_ORIENTATION:9/16,DEFAULT_ALIGN:"center",DEFAULT_MIN_CHAR_SIZE:300,DEFAULT_URL:"//moevideo.biz/native",DEFAULT_VISIBILITY:.7,FOCUS_VISIBILITY:.001,CONTENT_VISIBILITY:0,STATISTIC_PERCENTAGE:10,INSTANCE_MAX:4,TIMER_WAIT:12500,TIMER_WAIST:1e3,TIMER_WAIST_INVENTORY:1e3,DEFAULT_BETWEEN_AUDIO:0,DEFAULT_MIN_BETWEEN_AUDIO:0,DEFAULT_MAX_BETWEEN_AUDIO:36e5,FIND_RULE:"[^mv]player|moevideo.net|playreplay.[A-Za-z]+|videochart.net|thesame.tv|youtu|vimeo|uppod|up(pod)?.swf|vk[^A-Za-z0-9_]+.*video|censor.[A-Za-z]+|kinopoisk.ru|tsn.ua|twitch.tv|ustream.tv|jwplatform|jwplayer|jwp.*.swf",FIND_RULE2:"player",TRANSITION_DELAY:400,STEP_UPDATE:30,IS_DEBUG:666===i.OMVP_VERSION};r.default=s},{"../../../../config/player-version":1}],342:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("core-js/modules/web.dom.iterable"),e("core-js/modules/es6.array.iterator"),e("core-js/modules/es6.object.keys");var i,s=(i=e("./observable"))&&i.__esModule?i:{default:i};const o="08",a="[07]",n=`${a}___MV_LAST_MODIFY`,l=`${a}___MV_TEST_SAVING___`,d="___mve",u="___mvl";function c(e){return a+e}function h(e){let t=e.slice(4);return e.slice(0,4)===a&&t}class p extends s.default{constructor(e){super(e),e=e||{},this._initStorage(e.storage)&&(this._playerId=Math.random(),this._lastModify=this._storage.getItem(n),this._data={},this._checkStateTimeout=0,this._lastModify||(this._storage.clear(),this._updateLastModify()),this._init())}_testStorage(e){let t=Math.random()+"";if(e.setItem(l,t),e.getItem(l)!==t)throw new Error("LocalStorage не доступен");e.removeItem(l)}_initStorage(e){try{e||(e=window.localStorage),this._testStorage(e)}catch(t){e=void 0}return this._storage=e,!!this._storage||(super.trigger("init_error"),!1)}_init(){let e,t=this._storage,r=[];for(e=0;e<t.length;e++){let i=t.key(e),s=h(i);s?this._data[s]=t.getItem(i):r.push(i)}for(e=0;e<r.length;e++)t.removeItem(r[e]);this._checkState(),this._checkExpire(),super.trigger("ready",o)}_updateLastModify(){this._lastModify=new Date-0+""+Math.random(),this._storage.setItem(n,this._lastModify)}_updateKeys(){this._keys=Object.keys(this._data)}_checkState(e){this._checkStateTimeout&&(clearTimeout(this._checkStateTimeout),this._checkStateTimeout=0);let t=this._storage;if(e||t.getItem(n)!==this._lastModify){this._lastModify=t.getItem(n);for(let e=0;e<t.length;e++){let r=t.key(e),i=h(r);if(r===n)continue;if(!i)continue;let s=t.getItem(r),o=this._data[i];if(s!==o){let e=this.getValueFromRaw(s,!0);this._data[i]=s,this._updateKeys(),this.trigger("update",{key:i,prevValue:this.getValueFromRaw(o),value:e.value,playerId:e.playerId,isExternal:e.playerId!==this._playerId})}}for(let e in this._data)if(this._data.hasOwnProperty(e)){let r=c(e);if(null===t.getItem(r)){let t=this.getValueFromRaw(this._data[e]);delete this._data[e],this._updateKeys(),this.trigger("remove",{key:e,prevValue:t})}}}this._checkStateTimeout=setTimeout(this._checkState.bind(this),0)}_checkExpire(){let e=new Date-0,t=this._storage;for(;;){let r=!1;for(let i=t.length-1;i>=0;i--){let s=h(t.key(i));if(!s)continue;let o=s+d,a=this.getValue(o);if(a&&a<e){this.removeValue(s),this.removeValue(o),r=!0;break}}if(!r)break}setTimeout(this._checkExpire.bind(this),1e3)}getData(){let e={};for(let t in this._data)this._data.hasOwnProperty(t)&&(e[t]=this.getValueFromRaw(this._data[t]));return e}key(e){let t=this._keys[e];return void 0===t?null:t}getLength(){return this._keys.length}lock(e){if(this.locked(e))return!1;let t=e+u;return this.setValue({key:t,value:1,expire:5e3})}locked(e){let t=e+u;return!!this.hasValue(t)&&this.getValue(t,!0).playerId!==this._playerId}unlock(e){if(this.locked(e))return!1;let t=e+u;return this.removeValue(t)}setValue(e){if(e instanceof Array){let t=[];for(let r=0;r<e.length;r++)t.push(this.setValue(e[r]));return t}let t=e.key,r=e.value,i=e.expire,s=this._storage;return void 0!==t&&(!this.locked(t)&&((!e.ifNotExists||null===s.getItem(t))&&(this.getValue(t)!==r&&(s.setItem(c(t),JSON.stringify({value:r,playerId:this._playerId})),this._checkState(!0),this._updateLastModify()),i&&this.setValue({key:t+d,value:JSON.stringify(new Date-0+i)}),!0)))}clear(){return this._storage.clear()}hasValue(e){return null!==this._storage.getItem(c(e))}removeValue(e){if(e instanceof Array){let t=[];for(let r=0;r<e.length;r++)t.push(this.removeValue(e[r]));return t}return!this.locked(e)&&(this._storage.removeItem(c(e)),this._storage.removeItem(c(e+d)),this._checkState(!0),this._updateLastModify(),!0)}getValue(e,t){return this.getValueFromRaw(this._storage.getItem(c(e)),t)}getValueFromRaw(e,t){return e=null===e||void 0===e?{value:null,playerId:null}:JSON.parse(e),t?e:e.value}}p.VERSION=o;var _=p;r.default=_},{"./observable":343,"core-js/modules/es6.array.iterator":93,"core-js/modules/es6.object.keys":96,"core-js/modules/web.dom.iterable":115}],343:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this._listeners={},(e=e||{}).listeners&&this._initListeners(e.listeners)}_initListeners(e){for(let t in e)e.hasOwnProperty(t)&&this.on(t,e[t])}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}trigger(e,t){if(!this._listeners[e])return;let r=this._listeners[e];for(let e=0;e<r.length;e++)r[e](t)}}},{}]},{},[241]);